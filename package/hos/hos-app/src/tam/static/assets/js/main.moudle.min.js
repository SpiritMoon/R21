angular.module("module.wireless.rogueAp",[]).controller("RogueApViewController",["$scope","singleModal","authentifiedRequest","InterService","batchSyncConfig","$translate",function(e,n,t,a,i,l){function s(e){for(var n=new Object,t=a.getCanConfigAps(),i=0;i<t.length;i++)t[i].mac==e[0].hapMac&&(n.key=t[i].apname);n.total=0,n.values=[[l.instant("MonitorInter"),0],[l.instant("MonitorRouge"),0]];for(var i=0;i<e.length;i++)0===e[i].TYPE?n.values[0][1]++:n.values[1][1]++,n.total++;r.push(n)}e.rogueApParams={suppressSwitch:!1,blackSwitch:!1},e.noDataInfo={type:"chart",value:""},e.rogueApData=[],e.toolTipContentFunction=function(){return function(e,n,t,a,i){return"<b>"+e+"</b>"+l.instant("rogueAPHave")+" <b>"+parseInt(t)+"</b> "+n}},e.yAxisTickFormatFunction=function(){return function(e){return parseInt(e)}};var r=[];e.sortRogueApData=function(n){0==n.length?(e.noDataInfo.type="error",e.noDataInfo.value=l.instant("rogueAPnoData")):(n.sort(function(e,n){return n.total-e.total}),e.rogueApData=n.slice(0,5))},e.toggleManager.rogueApInit=function(){e.suppressQuery(),e.query()},e.suppressQuery=function(){var n={};t.get("/rogueApSwitch",n,function(n,t){200==t&&null!=n&&n.success&&(e.rogueApParams=n.result)},function(){})},e.query=function(){var n={},i=!0;r=[];for(var o=a.getCanConfigAps(),c=0;c<o.length&&i;c++){var u=o[c].ip;mac=o[c].mac;var p=a.getProtocol()+"://"+u+":"+a.getPort()+"/rogueAps/"+mac;t.get(p,n,function(n,t){200==t&&null!=n?n.success?(s(n.result),e.noDataInfo.type="chart",e.noDataInfo.value=""):"error1"==n.result?(e.noDataInfo.type="error",e.noDataInfo.value=l.instant("rogueAPErrorInfo_1"),i=!1):"error2"==n.result&&(e.noDataInfo.type="error",e.noDataInfo.value=l.instant("rogueAPErrorInfo_2"),i=!1):(e.noDataInfo.type="error",e.noDataInfo.value=l.instant("rogueAPErrorInfo_3"),i=!1),c==o.length&&i&&e.sortRogueApData(r)},function(){})}},e.modal=null,e.openConfigPage=function(){n.open({templateUrl:"wireless/rogue-ap/rogue-ap-conf.html",controller:"RogueApConfController",size:"lg",backdrop:!0})},e.configSuppressSwitch=function(){var n,t=JSON.stringify(e.rogueApParams);n=e.rogueApParams.suppressSwitch?"rogueAp_edit_suppressSwitch_1":"rogueAp_edit_suppressSwitch_2",i.request("put","/suppressSwitch",null,t,function(){e.suppressQuery()},null,n)},e.configBlackSwitch=function(){var n,t=JSON.stringify(e.rogueApParams);n=e.rogueApParams.blackSwitch?"rogueAp_edit_blackSwitch_1":"rogueAp_edit_blackSwitch_2",i.request("put","/blackSwitch",null,t,function(){e.suppressQuery()},null,n)}}]),angular.module("module.wireless.rogueAp").filter("typeFilter",[function(){var e=function(e){switch(e){case 1:return"Rogue";case 0:return"Interfering"}};return e}]).filter("distanceFilter",[function(){var e=function(e){return 25>e?"farest":e>=25&&50>=e?"far":e>=51&&75>=e?"near":"nearest"};return e}]).filter("authTypeFilter",[function(){var e=function(e){switch(e){case 0:return"open";case 1:return"shared-key";case 2:return"WPA";case 3:return"WPA2/RSNA";case!1:return"WAPI"}};return e}]).filter("alreadyInBlackFilter",[function(){var e=function(e){switch(e){case 1:return"Yes";case 0:return"No"}};return e}]).controller("RogueApConfController",["$scope","$modalInstance","$translate","authentifiedRequest","InterService","batchSyncConfig","toastr",function(e,n,t,a,i,l,s){function r(e){var n=document.createElement("a");return n.href=e,{source:e,protocol:n.protocol.replace(":",""),host:n.hostname,port:n.port,query:n.search,params:function(){for(var e,t={},a=n.search.replace(/^\?/,"").split("&"),i=a.length,l=0;i>l;l++)a[l]&&(e=a[l].split("="),t[e[0]]=e[1]);return t}(),file:(n.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:n.hash.replace("#",""),path:n.pathname.replace(/^([^\/])/,"/$1"),relative:(n.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:n.pathname.replace(/^\//,"").split("/")}}function o(e,n){for(var t=0;t<e.length;t++)if(n==e[t].ip)return e[t]}e.skin=i.skin,e.InterService=i,e.whiteListParams={},e.dynamicBlackListParams=[],Array.prototype.remove=function(e){if(isNaN(e)||e>this.length)return!1;for(var n=0,t=0;n<this.length;n++)this[n]!=this[e]&&(this[t++]=this[n]);this.length-=1},e.removeDuplicates=function(n){for(var t=angular.copy(e.rogueApListParams),a=0;a<n.length;a++)for(var i=n[a].MAC,l=n[a].SSID,s=n[a].RSSI,r=0;r<t.length;r++)if(i==t[r].MAC&&l==t[r].SSID){s>t[r].RSSI?(t.remove(r),r--):(n.remove(a),a--);break}return t.concat(n)},e.rogueApListParams=[],e.query=function(){for(var n={},t=!0,l=i.getCanConfigAps(),s=0;s<l.length;s++){var c=l[s].ip,u=l[s].mac,p=i.getProtocol()+"://"+c+":"+i.getPort()+"/rogueAps/"+u;a.get(p,n,function(n,a,i,s){if(200==a&&null!=n&&n.success){for(var c=0;c<n.result.length;c++){var u=r(s.url).host,p=o(l,u);n.result[c].apInfo=p.apname,n.result[c].apName=p.name}0==e.rogueApListParams.length?e.rogueApListParams=angular.copy(n.result):e.rogueApListParams=e.removeDuplicates(n.result),t&&n.result.length>0&&(0==e.whiteList&&0==e.dynamicBlackList&&(e.rogueApDetail=!0),e.currentRogueAP=e.rogueApListParams[0],t=!1)}},function(){})}},e.query(),e.queryWhiteList=function(){var n={};a.get("/rogueApWhiteList",n,function(n,t){200==t&&null!=n&&n.success&&(e.whiteListParams=n.result)},function(){})},e.cancel=function(){e.rogueApDetail=!1,e.rogueApClientNum=!1,e.whiteList=!1,e.dynamicBlackList=!1,n.close()},e.rogueApDetail=!1,e.rogueApClientNum=!1,e.whiteList=!1,e.dynamicBlackList=!1,e.showDetail=function(n){e.rogueApDetail=!0,e.rogueApClientNum=!1,e.whiteList=!1,e.dynamicBlackList=!1,e.currentRogueAP=n},e.submitPara={},e.showWhiteList=function(){e.rogueApDetail=!1,e.rogueApClientNum=!1,e.whiteList=!0,e.dynamicBlackList=!1,e.submitPara.whitelistValue="",e.queryWhiteList()},e.isWhiteListRepeat=function(e,n){for(var t=0;t<e.length;t++)if(n==e[t].whitelistMac)return!0;return!1},e.addWhitelist=function(){e.parasedSubmitPara={whitelistValue:""};var n=e.submitPara.whitelistValue;if(n){var a=RegExp(":","gi"),i=0,r=n.match(a);switch(i=null==r?0:r.length){case 0:e.parasedSubmitPara.whitelistValue=n.concat(":*:*:*:*:*");break;case 1:e.parasedSubmitPara.whitelistValue=n.concat(":*:*:*:*");break;case 2:e.parasedSubmitPara.whitelistValue=n.concat(":*:*:*");break;case 3:e.parasedSubmitPara.whitelistValue=n.concat(":*:*");break;case 4:e.parasedSubmitPara.whitelistValue=n.concat(":*");break;case 5:e.parasedSubmitPara.whitelistValue=n}var o=JSON.stringify(e.parasedSubmitPara),c=e.parasedSubmitPara.whitelistValue.toLowerCase(),u=e.isWhiteListRepeat(e.whiteListParams.whitelist,c);if(u)s.info(t.instant("whiteListMacRepeat"),"");else if(20==e.whiteListParams.whitelistNum)s.info(t.instant("whiteListMacAlready20"),"");else{var p="rogueAp_add_whiteList",d=e.parasedSubmitPara.whitelistValue;l.request("post","/rogueApWhiteList",null,o,function(){e.queryWhiteList(),e.rogueApListParams=[],e.query()},null,p,null,d)}e.submitPara.whitelistValue=""}},e.trust=function(n){var a={whitelistValue:n},i="rogueAp_add_whiteList",s=n,r=t.instant("trustThisAp")+"("+n+")?";bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:r,callback:function(n){n&&l.request("post","/rogueApWhiteList",null,a,function(){e.queryWhiteList(),e.rogueApListParams=[],e.query()},null,i,null,s)}})},e.deleteWhitelist=function(n){var a="rogueAp_delete_whiteList",i=n,s=t.instant("deleteWhiteListMac")+n+"?";bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:s,callback:function(t){t&&l.request("delete","/rogueApWhiteList/"+n,null,null,function(){e.queryWhiteList(),e.rogueApListParams=[],e.query()},null,a,null,i)}})},e.showDynamicBlackList=function(){e.rogueApDetail=!1,e.rogueApClientNum=!1,e.whiteList=!1,e.dynamicBlackList=!0,e.queryDynamicBlackList()},e.dynamicBlackListByMac=[],e.queryDynamicBlackList=function(){var n={};a.get("/rogueApDynamicBlackList",n,function(n,t){if(200==t&&null!=n&&n.success&&(e.dynamicBlackListByMac=n.result.blacklist),0!=e.dynamicBlackListByMac.length)for(var a=0;a<e.dynamicBlackListByMac.length;a++)for(var i=0;i<e.rogueApListParams.length;i++)e.dynamicBlackListByMac[a].blacklistMac==e.rogueApListParams[i].MAC&&e.dynamicBlackListParams.push(e.rogueApListParams[a])},function(){})},e.deleteDynamicBlackList=function(n){var a="rogueAp_delete_blackList",i=n,s=t.instant("deleteBlackListMac")+n+"?";bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:s,callback:function(t){t&&l.request("delete","/rogueApDynamicBlackList/"+n,null,null,function(){e.queryDynamicBlackList(),e.rogueApListParams=[],e.query()},null,a,null,i)}})}}]),angular.module("module.wireless.rfManagement",[]).controller("RfManagementViewController",["$scope","singleModal","authentifiedRequest","InterService","$translate",function(e,n,t,a,i){function l(n){e.twoChannelData=[],e.fiveChannelData=[];for(var t=0;t<n.length;t++){var a=n[t].channel_2g,i=n[t].channel_5g,l=new Object,s=new Object;if(0==t)l.key=a,l.y=1,e.twoChannelData.push(l),s.key=i,s.y=1,e.fiveChannelData.push(s);else{for(var r=0;r<e.twoChannelData.length;r++){var o=e.twoChannelData[r];if(a==o.key){o.y++;break}}r==e.twoChannelData.length&&(l.key=a,l.y=1,e.twoChannelData.push(l));for(var c=0;c<e.fiveChannelData.length;c++){var u=e.fiveChannelData[c];if(i==u.key){u.y++;break}}c==e.fiveChannelData.length&&(s.key=i,s.y=1,e.fiveChannelData.push(s))}}"2.4G"==e.RF.type&&(0==e.twoChannelData?e.RF.noData=!0:e.RF.noData=!1),"5G"==e.RF.type&&(0==e.fiveChannelData?e.RF.noData=!0:e.RF.noData=!1)}e.RF={type:"2.4G",noData:!1},e.twoChannelData=[],e.fiveChannelData=[],e.xFunction=function(){return function(e){return e.key}},e.yFunction=function(){return function(e){return e.y}},e.toolTipContentFunction=function(){return function(e,n,t,a,l){var s=i.instant("Channel"),r=i.instant("have");return"<p>"+s+"<b> "+e+" </b>"+r+"<b> "+parseInt(n)+"</b> RF</p>"}},e.toggleManager.rfInit=function(){for(var e={},n=[],i=a.getCanConfigAps(),s=0;s<i.length;s++){var r=i[s].ip,o=a.getProtocol()+"://"+r+":"+a.getPort()+"/rf";t.get(o,e,function(e,t){200==t&&null!=e&&e.success&&n.push(e.result),s==i.length&&l(n)},function(){})}},e.modal=null,e.openConfigPage=function(){n.open({templateUrl:"wireless/rf-management/rf-management-conf.html",controller:"RfManagementConfController",size:"lg",backdrop:!0},function(n){e.toggleManager.rfInit()},function(n){e.toggleManager.rfInit()})}}]),angular.module("module.wireless.rfManagement").filter("channelPowerFilter",[function(){var e=function(e){return null===e?"waiting":e};return e}]).controller("RfManagementConfController",["$scope","$modalInstance","authentifiedRequest","InterService","lockScreen","operationLog","toastr","$translate","$timeout",function(e,n,t,a,i,l,s,r,o){function c(e){var n=document.createElement("a");return n.href=e,{source:e,protocol:n.protocol.replace(":",""),host:n.hostname,port:n.port,query:n.search,params:function(){for(var e,t={},a=n.search.replace(/^\?/,"").split("&"),i=a.length,l=0;i>l;l++)a[l]&&(e=a[l].split("="),t[e[0]]=e[1]);return t}(),file:(n.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:n.hash.replace("#",""),path:n.pathname.replace(/^([^\/])/,"/$1"),relative:(n.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:n.pathname.replace(/^\//,"").split("/")}}function u(e,n){for(var t=0;t<e.length;t++)if(n==e[t].ip)return e[t]}e.countryCodeInfo={countryCode:""},e.countryCodeInfo.countryCode=a.getCountryCodeInfo(),e.skin=a.skin,e.InterService=a,e.apListParams={},e.Channel0_US=[1,2,3,4,5,6,7,8,9,10,11],e.Channel0_JP=[1,2,3,4,5,6,7,8,9,10,11,12,13,14],e.Channel0_DE=[1,2,3,4,5,6,7,8,9,10,11,12,13],e.Channel0_CS=[],e.Channel1_US=[36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,149,153,157,161],e.Channel1_CA=[36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140,149,153,157,161,165],e.Channel1_JP=[36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140],e.Channel1_KR=[36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140,149,153,157,161],e.Channel1_CN=[36,40,44,48,52,56,60,64,149,153,157,161,165],e.Channel1_TW=[56,60,64,100,104,108,112,116,120,124,128,132,136,140,149,153,157,161,165],e.Channel1_IL=[36,40,44,48,52,56,60,64],e.Channel1_BO=[52,56,60,64,140,149,153,157,161,165],e.Channel1_ID=[149,153,157,161],e.Channel1_PK=[149,153,157,161,165],e.Channel1_DZ=[36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132],e.Channell_MY=[36,40,44,48,52,56,60,64,149,153,157,161,165],e.Channel1_NG=[52,56,60,64,149,153,157,161,165],e.Channel1_PA=[36,40,44,48,52,56,60,64,149,153,157,161,165],e.Channel1_RU=[36,40,44,48,52,56,60,64,132,136,140,149,153,157,161,165],e.ChannelScope0=[],e.select2gChannelScope=function(n){switch(n){case"JP":e.ChannelScope0=e.Channel0_JP;break;case"DE":e.ChannelScope0=e.Channel0_DE;break;case"NL":e.ChannelScope0=e.Channel0_DE;break;case"IT":e.ChannelScope0=e.Channel0_DE;break;case"PT":e.ChannelScope0=e.Channel0_DE;break;case"LU":e.ChannelScope0=e.Channel0_DE;break;case"NO":e.ChannelScope0=e.Channel0_DE;break;case"FI":e.ChannelScope0=e.Channel0_DE;break;case"DK":e.ChannelScope0=e.Channel0_DE;break;case"CH":e.ChannelScope0=e.Channel0_DE;break;case"CZ":e.ChannelScope0=e.Channel0_DE;break;case"ES":e.ChannelScope0=e.Channel0_DE;break;case"GB":e.ChannelScope0=e.Channel0_DE;break;case"KR":e.ChannelScope0=e.Channel0_DE;break;case"CN":e.ChannelScope0=e.Channel0_DE;break;case"FR":e.ChannelScope0=e.Channel0_DE;break;case"HK":e.ChannelScope0=e.Channel0_DE;break;case"SG":e.ChannelScope0=e.Channel0_DE;break;case"BR":e.ChannelScope0=e.Channel0_DE;break;case"IL":e.ChannelScope0=e.Channel0_DE;break;case"SA":e.ChannelScope0=e.Channel0_DE;break;case"LB":e.ChannelScope0=e.Channel0_DE;break;case"AE":e.ChannelScope0=e.Channel0_DE;break;case"ZA":e.ChannelScope0=e.Channel0_DE;break;case"AR":e.ChannelScope0=e.Channel0_DE;break;case"AU":e.ChannelScope0=e.Channel0_DE;break;case"AT":e.ChannelScope0=e.Channel0_DE;break;case"BO":e.ChannelScope0=e.Channel0_DE;break;case"CL":e.ChannelScope0=e.Channel0_DE;break;case"GR":e.ChannelScope0=e.Channel0_DE;break;case"IS":e.ChannelScope0=e.Channel0_DE;break;case"IN":e.ChannelScope0=e.Channel0_DE;break;case"KW":e.ChannelScope0=e.Channel0_DE;break;case"LI":e.ChannelScope0=e.Channel0_DE;break;case"LT":e.ChannelScope0=e.Channel0_DE;break;case"MX":e.ChannelScope0=e.Channel0_DE;break;case"MA":e.ChannelScope0=e.Channel0_DE;break;case"NZ":e.ChannelScope0=e.Channel0_DE;break;case"PL":e.ChannelScope0=e.Channel0_DE;break;case"SK":e.ChannelScope0=e.Channel0_DE;break;case"EE":e.ChannelScope0=e.Channel0_DE;break;case"MU":e.ChannelScope0=e.Channel0_DE;break;case"RO":e.ChannelScope0=e.Channel0_DE;break;case"ID":e.ChannelScope0=e.Channel0_DE;break;case"PE":e.ChannelScope0=e.Channel0_DE;break;case"VE":e.ChannelScope0=e.Channel0_DE;break;case"JM":e.ChannelScope0=e.Channel0_DE;break;case"BH":e.ChannelScope0=e.Channel0_DE;break;case"OM":e.ChannelScope0=e.Channel0_DE;break;case"JO":e.ChannelScope0=e.Channel0_DE;break;case"CO":e.ChannelScope0=e.Channel0_DE;break;case"GT":e.ChannelScope0=e.Channel0_DE;break;case"PH":e.ChannelScope0=e.Channel0_DE;break;case"LK":e.ChannelScope0=e.Channel0_DE;break;case"SV":e.ChannelScope0=e.Channel0_DE;break;case"TN":e.ChannelScope0=e.Channel0_DE;break;case"PK":e.ChannelScope0=e.Channel0_DE;break;case"QA":e.ChannelScope0=e.Channel0_DE;break;case"CS":e.ChannelScope0=e.Channel0_CS;break;case"DZ":e.ChannelScope0=e.Channel0_DE;break;case"PA":e.ChannelScope0=e.Channel0_US;break;case"BE":e.ChannelScope0=e.Channel0_DE;break;case"EG":e.ChannelScope0=e.Channel0_DE;break;case"GB":e.ChannelScope0=e.Channel0_DE;break;case"GU":e.ChannelScope0=e.Channel0_US;break;case"HU":e.ChannelScope0=e.Channel0_DE;break;case"IE":e.ChannelScope0=e.Channel0_DE;break;case"MC":e.ChannelScope0=e.Channel0_DE;break;case"MK":e.ChannelScope0=e.Channel0_DE;break;case"MT":e.ChannelScope0=e.Channel0_DE;break;case"MY":e.ChannelScope0=e.Channel0_DE;break;case"NG":e.ChannelScope0=e.Channel0_DE;break;case"RU":e.ChannelScope0=e.Channel0_DE;break;case"SE":e.ChannelScope0=e.Channel0_DE;break;case"TH":e.ChannelScope0=e.Channel0_DE;break;case"TR":e.ChannelScope0=e.Channel0_DE;break;case"VN":e.ChannelScope0=e.Channel0_DE;break;case"HR":e.ChannelScope0=e.Channel0_DE;break;case"LV":e.ChannelScope0=e.Channel0_DE;break;default:e.ChannelScope0=e.Channel0_US}},e.ChannelScope1=[],e.select5gChannelScope=function(n){switch(n){case"BE":e.ChannelScope1=e.Channel1_JP;break;case"EG":e.ChannelScope1=e.Channel1_IL;break;case"GB":e.ChannelScope1=e.Channel1_JP;break;case"GU":e.ChannelScope1=e.Channel1_CA;break;case"HU":e.ChannelScope1=e.Channel1_JP;break;case"IE":e.ChannelScope1=e.Channel1_JP;break;case"MC":e.ChannelScope1=e.Channel1_JP;break;case"MK":e.ChannelScope1=e.Channel1_JP;break;case"MT":e.ChannelScope1=e.Channel1_JP;break;case"MY":e.ChannelScope1=e.Channell_MY;break;case"NG":e.ChannelScope1=e.Channel1_NG;break;case"PA":e.ChannelScope1=e.Channel1_PA;break;case"RU":e.ChannelScope1=e.Channel1_RU;break;case"SE":e.ChannelScope1=e.Channel1_JP;break;case"TH":e.ChannelScope1=e.Channel1_CA;break;case"TR":e.ChannelScope1=e.Channel1_JP;break;case"VN":e.ChannelScope1=e.Channel1_CA;break;case"CA":e.ChannelScope1=e.Channel1_CA;break;case"HK":e.ChannelScope1=e.Channel1_CA;break;case"SG":e.ChannelScope1=e.Channel1_CA;break;case"BR":e.ChannelScope1=e.Channel1_CA;break;case"LB":e.ChannelScope1=e.Channel1_CA;break;case"AE":e.ChannelScope1=e.Channel1_CA;break;case"ZA":e.ChannelScope1=e.Channel1_CA;break;case"AR":e.ChannelScope1=e.Channel1_CA;break;case"AU":e.ChannelScope1=e.Channel1_CA;break;case"MX":e.ChannelScope1=e.Channel1_CA;break;case"NZ":e.ChannelScope1=e.Channel1_CA;break;case"PR":e.ChannelScope1=e.Channel1_CA;break;case"MU":e.ChannelScope1=e.Channel1_CA;break;case"CS":e.ChannelScope1=e.Channel1_CA;break;case"PE":e.ChannelScope1=e.Channel1_CA;break;case"JM":e.ChannelScope1=e.Channel1_CA;break;case"BM":e.ChannelScope1=e.Channel1_CA;break;case"CO":e.ChannelScope1=e.Channel1_CA;break;case"PH":e.ChannelScope1=e.Channel1_CA;break;case"LK":e.ChannelScope1=e.Channel1_CA;break;case"JP":e.ChannelScope1=e.Channel1_JP;break;case"DE":e.ChannelScope1=e.Channel1_JP;break;case"NL":e.ChannelScope1=e.Channel1_JP;break;case"IT":e.ChannelScope1=e.Channel1_JP;break;case"PT":e.ChannelScope1=e.Channel1_JP;break;case"LU":e.ChannelScope1=e.Channel1_JP;break;case"NO":e.ChannelScope1=e.Channel1_JP;break;case"FI":e.ChannelScope1=e.Channel1_JP;break;case"DK":e.ChannelScope1=e.Channel1_JP;break;case"CH":e.ChannelScope1=e.Channel1_JP;break;case"CZ":e.ChannelScope1=e.Channel1_JP;break;case"ES":e.ChannelScope1=e.Channel1_JP;break;case"GB":e.ChannelScope1=e.Channel1_JP;break;case"FR":e.ChannelScope1=e.Channel1_JP;break;case"SA":e.ChannelScope1=e.Channel1_JP;break;case"AT":e.ChannelScope1=e.Channel1_JP;break;case"GR":e.ChannelScope1=e.Channel1_JP;break;case"IS":e.ChannelScope1=e.Channel1_JP;break;case"LI":e.ChannelScope1=e.Channel1_JP;break;case"LT":e.ChannelScope1=e.Channel1_JP;break;case"PL":e.ChannelScope1=e.Channel1_JP;break;case"SK":e.ChannelScope1=e.Channel1_JP;break;case"EE":e.ChannelScope1=e.Channel1_JP;break;case"RO":e.ChannelScope1=e.Channel1_JP;break;case"OM":e.ChannelScope1=e.Channel1_JP;break;case"GT":e.ChannelScope1=e.Channel1_JP;break;case"KR":e.ChannelScope1=e.Channel1_KR;break;case"CN":e.ChannelScope1=e.Channel1_CN;break;case"CL":e.ChannelScope1=e.Channel1_CN;break;case"IN":e.ChannelScope1=e.Channel1_CN;break;case"VE":e.ChannelScope1=e.Channel1_CN;break;case"BH":e.ChannelScope1=e.Channel1_CN;break;case"DO":e.ChannelScope1=e.Channel1_CN;break;case"SV":e.ChannelScope1=e.Channel1_CN;break;case"TW":e.ChannelScope1=e.Channel1_TW;break;case"IL":e.ChannelScope1=e.Channel1_IL;break;case"KW":e.ChannelScope1=e.Channel1_IL;break;case"MA":e.ChannelScope1=e.Channel1_IL;break;case"TN":e.ChannelScope1=e.Channel1_IL;break;case"BO":e.ChannelScope1=e.Channel1_BO;break;case"ID":e.ChannelScope1=e.Channel1_ID;break;case"PK":e.ChannelScope1=e.Channel1_PK;break;case"QA":e.ChannelScope1=e.Channel1_PK;break;case"DZ":e.ChannelScope1=e.Channel1_DZ;break;case"HR":e.ChannelScope1=e.Channel1_JP;break;case"LV":e.ChannelScope1=e.Channel1_JP;break;default:e.ChannelScope1=e.Channel1_US}},e.initDivShow=function(){e.rfDetail=!1,e.rfEdit=!1},e.initDivShow(),e.apListParams=[],e.query=function(n){for(var i={},l=!0,s=a.getCanConfigAps(),r=0;r<s.length;r++){var o=s[r].ip,p=a.getProtocol()+"://"+o+":"+a.getPort()+"/rf";t.get(p,i,function(t,a,i,r){if(200==a&&null!=t&&t.success){var o=c(r.url).host,p=u(s,o);t.result.host=p.ip,t.result.apInfo=p.apname,t.result.apName=p.name,t.result.mac=p.mac,e.apListParams.push(t.result),l&&(e.rfDetail=!0,""!=n&&n==mac?e.currentAP=t.result:""==n&&(e.currentAP=e.apListParams[0]),l=!1)}},function(){})}},e.query(""),e.newCurrentAP={},e.save=function(){i.lock();var n=e.currentAP.host,c=a.getProtocol()+"://"+n+":"+a.getPort()+"/rf",u={};e.newCurrentAP.host=e.currentAP.host,e.newCurrentAP.apInfo=e.currentAP.apInfo,e.newCurrentAP.apName=e.currentAP.apName,e.newCurrentAP.mac=e.currentAP.mac,e.newCurrentAP.country=e.currentAP.country,e.oldAP.acsSwitch_2g!=e.currentAP.acsSwitch_2g?"ON"==e.currentAP.acsSwitch_2g?e.newCurrentAP.channel_2g="auto":e.newCurrentAP.channel_2g=e.currentAP.channel_2g:e.oldAP.channel_2g!=e.currentAP.channel_2g&&"OFF"==e.currentAP.acsSwitch_2g&&(e.newCurrentAP.channel_2g=e.currentAP.channel_2g),e.oldAP.acsSwitch_5g!=e.currentAP.acsSwitch_5g?"ON"==e.currentAP.acsSwitch_5g?e.newCurrentAP.channel_5g="auto":e.newCurrentAP.channel_5g=e.currentAP.channel_5g:e.oldAP.channel_5g!=e.currentAP.channel_5g&&"OFF"==e.currentAP.acsSwitch_5g&&(e.newCurrentAP.channel_5g=e.currentAP.channel_5g),e.oldAP.apcSwitch_2g!=e.currentAP.apcSwitch_2g?"ON"==e.currentAP.apcSwitch_2g?e.newCurrentAP.power_2g="auto":e.newCurrentAP.power_2g=e.currentAP.power_2g:e.oldAP.power_2g!=e.currentAP.power_2g&&"OFF"==e.currentAP.apcSwitch_2g&&(e.newCurrentAP.power_2g=e.currentAP.power_2g),e.oldAP.apcSwitch_5g!=e.currentAP.apcSwitch_5g?"ON"==e.currentAP.apcSwitch_5g?e.newCurrentAP.power_5g="auto":e.newCurrentAP.power_5g=e.currentAP.power_5g:e.oldAP.power_5g!=e.currentAP.power_5g&&"OFF"==e.currentAP.apcSwitch_5g&&(e.newCurrentAP.power_5g=e.currentAP.power_5g);var p=JSON.stringify(e.newCurrentAP);t.put(c,u,p,function(t){i.unlock(),e.initDivShow(),e.rfDetail=!0,e.apListParams=[],o(function(){e.query(e.currentAP.mac)},2e3),e.newCurrentAP={};var a="rf_edit",c=e.currentAP.mac,u=[{ip:n,success:"module_operate_failure",msg:""}];null==t||""==t?(u[0].success="module_operate_failure",u[0].msg="log_backendServer_error",s.info(r.instant("log_backendServer_error"))):(t.success?u[0].success="module_operate_success":u[0].success="module_operate_failure",u[0].msg=t.msg,s.info(r.instant(t.msg))),l.setLog(a,u,c)},function(){i.unlock()})},e.cancel=function(){n.close()},e.showDetail=function(n){e.rfDetail=!0,e.rfEdit=!1,e.currentAP=n},e.oldAP={},e.showEdit=function(n){e.rfDetail=!1,e.rfEdit=!0,e.currentAP=angular.copy(n),e.oldAP=angular.copy(n),e.select2gChannelScope(n.country),e.select5gChannelScope(n.country)}}]),angular.module("module.wireless.others",[]).controller("OthersViewController",["$scope","$modal","authentifiedRequest","batchSyncConfig","InterService",function(e,n,t,a,i){e.InterService=i,e.backgroupScanningParams={backgroupScanning:!1,scanInterval:5,foreignChannelDuration:20},e.bandSteeringParams={bandSteering:!1},e.awareParams={aware:!1},e.igmpSnoopingParams={snoopingSwitch:!1,mulitowuicastSwitch:!1,hostLifeAgeingTime:90},e.ARPProxySnooping={proxySwitch:!1},e.sliderParams={scanIntervalOptions:[5,6,7,8,9,10],foreignChannelOptions:[20,30,40,50,60],agingTimeOptions:[60,90,120,150,180]},e.setBackgroupSlider=function(){var n=e.backgroupScanningParams.scanInterval-5,t=e.backgroupScanningParams.foreignChannelDuration/10-2;$("#scan-interval-slider").slider("value",n),$("#foreign-channel-slider").slider("value",t),1==e.backgroupScanningParams.backgroupScanning?($("#scan-interval-slider").slider("enable"),$("#foreign-channel-slider").slider("enable")):($("#scan-interval-slider").slider("disable"),$("#foreign-channel-slider").slider("disable"))},e.setIGMPAgingTimgSlider=function(){var n=e.igmpSnoopingParams.hostLifeAgeingTime/30-2;$("#aging-time-slider").slider("value",n),1==e.igmpSnoopingParams.snoopingSwitch?$("#aging-time-slider").slider("enable"):$("#aging-time-slider").slider("disable")},e.igmpSnoopingQuery=function(){t.get("/network/igmpSnooping/confParams",null,function(n){null!=n&&n.success&&(e.igmpSnoopingParams=n.result,e.setIGMPAgingTimgSlider())},function(){})},e.ARPProxySnoopingQuery=function(){t.get("/network/arpProxy/confParams",null,function(n){null!=n&&n.success&&(e.ARPProxySnooping=n.result)},function(){})},e.toggleManager.otherInit=function(){e.BackgroundScanningQuery(),e.BandSteeringQuery(),e.AwareWirelessQuery(),e.igmpSnoopingQuery(),e.ARPProxySnoopingQuery()},e.BackgroundScanningQuery=function(){var n={};t.get("/backgroupScanning",n,function(n,t){200==t&&null!=n&&n.success&&(e.backgroupScanningParams=n.result,e.setBackgroupSlider())},function(){})},e.configBackgroupScanningSwtich=function(){var n,t=JSON.stringify(e.backgroupScanningParams);n=e.backgroupScanningParams.backgroupScanning?"other_wireless_edit_backgroupScanningSwitch_1":"other_wireless_edit_backgroupScanningSwitch_2",a.request("put","/backgroupScanningSwitch",null,t,function(){e.BackgroundScanningQuery()},null,n)},e.configScanInterval=function(){var n=JSON.stringify(e.backgroupScanningParams),t="other_wireless_edit_scanInterval",i=e.backgroupScanningParams.scanInterval;a.request("put","/scanInterval",null,n,function(){e.BackgroundScanningQuery()},null,t,null,i)};var l=e.backgroupScanningParams.scanInterval-5;$("#scan-interval-slider").slider({min:0,max:e.sliderParams.scanIntervalOptions.length-1,value:l}).slider("pips",{rest:"label",labels:e.sliderParams.scanIntervalOptions}).on("slidestop",function(n,t){$("#scanIntervalValue").text(e.sliderParams.scanIntervalOptions[t.value]),e.backgroupScanningParams.scanInterval=e.sliderParams.scanIntervalOptions[t.value],e.configScanInterval()}),e.configForeignChannelDuration=function(){var n=JSON.stringify(e.backgroupScanningParams),t="other_wireless_edit_foreignChannelDuration",i=e.backgroupScanningParams.foreignChannelDuration;a.request("put","/foreignChannelDuration",null,n,function(){e.BackgroundScanningQuery()},null,t,null,i)};var s=e.backgroupScanningParams.foreignChannelDuration/10-2;$("#foreign-channel-slider").slider({min:0,max:e.sliderParams.foreignChannelOptions.length-1,value:s}).slider("pips",{rest:"label",labels:e.sliderParams.foreignChannelOptions}).on("slidestop",function(n,t){$("#foreignChannelValue").text(e.sliderParams.foreignChannelOptions[t.value]),e.backgroupScanningParams.foreignChannelDuration=e.sliderParams.foreignChannelOptions[t.value],e.configForeignChannelDuration()}),e.BandSteeringQuery=function(){var n={};t.get("/bandSteering",n,function(n,t){200==t&&null!=n&&n.success&&(e.bandSteeringParams=n.result)},function(){})},e.configBandSteering=function(){var n,t=JSON.stringify(e.bandSteeringParams);n=e.bandSteeringParams.bandSteering?"other_wireless_edit_bandSteering_1":"other_wireless_edit_bandSteering_2",a.request("put","/bandSteering",null,t,function(){e.BandSteeringQuery()},null,n)},e.AwareWirelessQuery=function(){var n={};t.get("/aware",n,function(n,t){200==t&&null!=n&&n.success&&(e.awareParams=n.result)},function(){})},e.configAware=function(){var n,t=JSON.stringify(e.awareParams);n=e.awareParams.aware?"other_wireless_edit_aware_1":"other_wireless_edit_aware_2",a.request("put","/aware",null,t,function(){e.AwareWirelessQuery()},null,n)},e.igmpSnoopingParamChange=function(n){var t={igmpOption:n,igmpOptionValue:0},i="";switch(n){case"switch":e.igmpSnoopingParams.snoopingSwitch?(t.igmpOptionValue=1,i="other_log_igmpSnoopingSwitch_open"):(e.igmpSnoopingParams.mulitowuicastSwitch=!1,i="other_log_igmpSnoopingSwitch_close");break;case"multounicast":e.igmpSnoopingParams.mulitowuicastSwitch?(t.igmpOptionValue=1,i="other_log_MulticastToUnicastSwitch_open"):i="other_log_MulticastToUnicastSwitch_close";break;case"hostlifeinterval":t.igmpOptionValue=Number(e.igmpSnoopingParams.hostLifeAgeingTime),i="other_log_igmpSnoopingAgingTime_config"}a.request("put","/network/igmpSnooping/confParams",null,t,function(){e.igmpSnoopingQuery()},null,i)};var r=e.igmpSnoopingParams.hostLifeAgeingTime/30-2;$("#aging-time-slider").slider({min:0,max:e.sliderParams.agingTimeOptions.length-1,value:r}).slider("pips",{rest:"label",labels:e.sliderParams.agingTimeOptions}).on("slidestop",function(n,t){$("#age_value").text(e.sliderParams.agingTimeOptions[t.value]),e.igmpSnoopingParams.hostLifeAgeingTime=e.sliderParams.agingTimeOptions[t.value],e.igmpSnoopingParamChange("hostlifeinterval")}),e.ARPProxySnoopingChange=function(){var n={proxySwitch:0},t="other_log_proxySwitch_close";e.ARPProxySnooping.proxySwitch&&(n.proxySwitch=1,t="other_log_proxySwitch_open"),a.request("put","/network/arpProxy/confParams",null,n,function(){e.ARPProxySnoopingQuery()},null,t)}}]),angular.module("module.terminal.authentication",[]).controller("TerminalAuthViewController",["$scope","singleModal","authentifiedRequest","InterService","batchSyncConfig",function(e,n,t,a,i){e.InterService=a,e.aps=a.getCanConfigAps(),e.$watch("InterService",function(n,t){n!==t&&(e.aps=a.getCanConfigAps())},!0),e.Auth={type:"device"},e.deviceType=[],e.osType=[],e.xFunction=function(){return function(e){return e.key}},e.yFunction=function(){return function(e){return e.y}},e.toggleManager.getauthinfo=function(){e.deviceType=[],e.osType=[],i.getAll("/authclientinfo",null,function(n){var t=0;for(e.tempdev=[{key:"iPhone",y:0},{key:"iPad",y:0},{key:"Mobile",y:0},{key:"PC",y:0},{key:"Mac PC",y:0},{key:"unknown",y:0}],e.tempos=[{key:"IOS",y:0},{key:"Android",y:0},{key:"BlackBerry",y:0},{key:"Mac OS",y:0},{key:"Windows ME",y:0},{key:"Windows Server",y:0},{key:"Windows Vista",y:0},{key:"Windows XP",y:0},{key:"Windows 7",y:0},{key:"Windows 8",y:0},{key:"Windows 10",y:0},{key:"Linux",y:0},{key:"unknown",y:0}],t=0;t<n.length;t++)for(var a=0;a<n[t].length;a++)6>a?"devUnknown"==n[t][a].key?e.tempdev[5].y+=n[t][a].y:e.tempdev[a].key==n[t][a].key&&(e.tempdev[a].y+=n[t][a].y):e.tempos[a-6].key==n[t][a].key&&(e.tempos[a-6].y+=n[t][a].y);for(t=0;t<e.tempdev.length;t++)if(e.tempdev[t].y){e.deviceType=e.tempdev;break}for(t=0;t<e.tempos.length;t++)if(e.tempos[t].y){e.osType=e.tempos;break}})},e.toggleManager.AuthViewInit=function(){},e.openAuthenticationViewPageInit=function(){n.open({templateUrl:"terminal/authentication/authentication-conf.html",controller:"TerminalAuthConfController",size:"lg",backdrop:!0},function(n){e.toggleManager.getauthinfo()},function(n){e.toggleManager.AuthViewInit()})},"GuestOperator"==window.localStorage.username&&(window.localStorage.isFromLogin++,e.openAuthenticationViewPageInit())}]),angular.module("module.terminal.authentication").controller("TerminalAuthConfController",["$scope","$modalInstance","$translate","authentifiedRequest","InterService","batchSyncConfig","FileUploader","toastr","hanCrypto","$http",function(e,n,t,a,i,l,s,r,o,c){function u(){a.get("/captive/getSwitch",null,function(n){null!=n&&n.success&&("1"==n.result?(e.portalInfo["switch"]=!0,e.isFormat=!1,e.checkbox_checked=!1,e.checkButton=!1):(e.portalInfo["switch"]=!1,e.isFormat=!0,e.checkbox_checked=!1,e.checkButton=!1))},function(){})}function p(){a.get("/captive/getUrl",null,function(n){null!=n&&n.success&&(e.portalInfo.url=n.result)},function(){})}e.skin=i.skin,e.InterService=i,e.aps=i.getCanConfigAps();var d=i.getProtocol()+"://",m=":"+i.getPort();e.userNameInfo=window.localStorage.username,e.$watch("InterService",function(n,t){n!==t&&(e.aps=i.getCanConfigAps())},!0),e.authenticationParams={CaptiveStatus:!1,CaptiveType:0,CaptiveTime:""},e.Authconf={type:"account"},e.CurrentWLANLists=["test","haplet","test2"],e.customized_portal=!1,e.add_local_auth_user=!1,e.add_access_code=!1,e.batch_import=!1,e.batch_code=!1,e.localuser_detail=!1,e.edit_local_auth_user=!1,e.modifybefore={},e.isGetTime=!0,e.localUserList=[],e.localUserListTemp={UserName:"",Password:"",PasswordConfirm:"","FirstName ":"",
LastName:"",Mail:"",Phone:"",Company:"",StartingDate:"",EndingDate:""},e.accessCodeList=[],e.accessCodeTemp={access_code:""},e.tftpInfo={FTFPStatus:"",TFTPIp:"",TFTPCycle:"",TFTPIpManu:""},e.tftpCycle=[{name:"1h",value:"1"},{name:"2h",value:"2"},{name:"4h",value:"4"}],e.cycleLevel=e.tftpCycle[0],e.echoCycleLevels=function(n){1==n?e.cycleLevel=e.tftpCycle[0]:2==n?e.cycleLevel=e.tftpCycle[1]:4==n&&(e.cycleLevel=e.tftpCycle[2])},e.getcaptiveportalinfo=function(){a.get("/getauthswitch",null,function(n,t){200==t&&null!=n&&n.success&&(e.authenticationParams=n.result,e.isGetTime=!1,0==e.authenticationParams.CaptiveType?e.Authconf.type="account":1==e.authenticationParams.CaptiveType?e.Authconf.type="accesscode":2==e.authenticationParams.CaptiveType&&(e.Authconf.type="terms"))},function(){})},e.setPortalSwitch=function(){var n="access_captiveportal_switch",t=JSON.stringify(e.authenticationParams.CaptiveStatus);l.request("put","/setportalswitch",null,t,function(){e.getcaptiveportalinfo()},null,n)},e.setPortalType=function(n){var t="access_captiveportal_type",a=JSON.stringify(n);l.request("put","/setportaltype",null,a,function(){e.getcaptiveportalinfo()},null,t)},e.getLocalUser=function(){var n={};a.get("/userlist",n,function(n,t){if(200==t&&null!=n&&n.success&&(e.localUserList=n.result,null!=e.localUserList))for(var a=0;a<e.localUserList.length;a++)e.localUserList[a].Password=o.decoder(e.localUserList[a].Password)},function(){})},e.userFilterDuplicateObject=function(e,n){var t=!1,a=n;return $.each(e,function(e,n){return n.UserName==a.UserName?(t=!0,!1):void 0}),t},e.Add_Localauth_User=function(n){var a=$("#add_start_date_value").val(),i=$("#add_end_date_value").val(),s={};e.localUserListTemp.StartingDate=a,e.localUserListTemp.EndingDate=i,null==e.localUserListTemp.FirstName?e.localUserListTemp.FirstName="#":e.localUserListTemp.FirstName.indexOf(" ")>0&&(e.localUserListTemp.FirstName=e.localUserListTemp.FirstName.replace(/ /g,"?")),null==e.localUserListTemp.LastName?e.localUserListTemp.LastName="#":e.localUserListTemp.LastName.indexOf(" ")>0&&(e.localUserListTemp.LastName=e.localUserListTemp.LastName.replace(/ /g,"?")),null==e.localUserListTemp.Company?e.localUserListTemp.Company="#":e.localUserListTemp.Company.indexOf(" ")>0&&(e.localUserListTemp.Company=e.localUserListTemp.Company.replace(/ /g,"?")),angular.copy(n,s);var c="access_addauthuser_2";if(null!=e.localUserList){var u=e.userFilterDuplicateObject(e.localUserList,s);if(1==u)return void r.info(t.instant("access_addauthuser_1"),"");if(""==s.StartingDate||""==s.EndingDate)return void r.info(t.instant("access_addauthuser_5"),"");if(e.authenticationParams.CaptiveTime>s.StartingDate&&s.StartingDate>s.EndingDate)return void r.info(t.instant("access_addauthuser_5"),"")}s.Password=o.encoder(s.Password);var p=JSON.stringify(s);l.request("put","/adduser",null,p,function(){e.getLocalUser()},null,c),$("form[name='add_localauth_user']")[0].reset(),e.Cancel()},e.Edit_localauth_user=function(n){var a=$("#edit_start_value").val(),i=$("#edit_end_value").val(),s=t.instant("authModifyLocalUser"),c=[],u=e.modifybefore;if(null==e.localUserListTemp.FirstName?e.localUserListTemp.FirstName="#":e.localUserListTemp.FirstName.indexOf(" ")>0&&(e.localUserListTemp.FirstName=e.localUserListTemp.FirstName.replace(/ /g,"?")),null==e.localUserListTemp.LastName?e.localUserListTemp.LastName="#":e.localUserListTemp.LastName.indexOf(" ")>0&&(e.localUserListTemp.LastName=e.localUserListTemp.LastName.replace(/ /g,"?")),null==e.localUserListTemp.Company?e.localUserListTemp.Company="#":e.localUserListTemp.Company.indexOf(" ")>0&&(e.localUserListTemp.Company=e.localUserListTemp.Company.replace(/ /g,"?")),n.StartingDate=a,n.EndingDate=i,""==n.StartingDate||""==n.EndingDate)return void r.info(t.instant("access_addauthuser_5"),"");if(e.authenticationParams.CaptiveTime>n.StartingDate&&n.StartingDate>n.EndingDate)return void r.info(t.instant("access_addauthuser_5"),"");u.Password=o.encoder(u.Password),n.Password=o.encoder(n.Password),c.push(u),c.push(n);var p=JSON.stringify(c);l.request("put","/modifyuser",null,p,function(){e.getLocalUser()},null,s),$("form[name='edit_localauth_user']")[0].reset(),e.Cancel()},e.usernum=0;var f=e.user=new s({removeAfterUpload:!1,headers:{Authorization:"sessionName "+window.localStorage.sessionId}});e.clearuser=function(){f.clearQueue()},f.onAfterAddingFile=function(n){var a=/[\S|\s]+.csv$/,i=a.test(n.file.name.toLowerCase());i||(e.clearuser(),r.info(t.instant("access_file_format_csv"),""))},f.onCompleteItem=function(n,a,i,l){if(e.usernum++,e.usernum<e.aps.length)e.importuser(f.queue[0]);else{e.usernum=0,e.getLocalUser();var s=t.instant("access_addauthuser_3")+a.total+" "+t.instant("access_addauthuser_4")+a.successTotal+"!";r.info(s,"")}},e.importuser=function(n){null!=e.aps&&(e.filename=n,f.queue[0].url=d+e.aps[e.usernum].ip+m+"/importuser/"+n.file.name,f.queue[0].upload())},e.downloadcsv=function(n){var a=t.instant("downAccountFile"),i=[{ip:e.aps[0].ip,success:!1,msg:""}];bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:t.instant("access_download_account_file"),callback:function(e){e&&c({method:"get",url:"/downloadcsv",headers:{Authorization:"sessionName "+window.localStorage.sessionId}}).success(function(e,n,t){var a="application/octet-stream",i=!1;t=t();var l=t["content-disposition"],s=new Array;s=l.split("=");var r=s[1],o=t["content-type"]||a;try{var c=new Blob([e],{type:o});if(navigator.msSaveBlob)navigator.msSaveBlob(c,r);else{var u=navigator.webkitSaveBlob||navigator.mozSaveBlob||navigator.saveBlob;if(void 0===u)throw"Not supported";u(c,r),i=!0}}catch(p){}if(!i){var d=window.URL||window.webkitURL||window.mozURL||window.msURL;if(d){var m=document.createElement("a");if("download"in m)try{var c=new Blob([e],{type:o}),f=d.createObjectURL(c);m.setAttribute("href",f),m.setAttribute("download",r);var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),m.dispatchEvent(g),i=!0}catch(p){}if(!i)try{var c=new Blob([e],{type:a}),f=d.createObjectURL(c);window.location=f,i=!0}catch(p){}}}i||window.open(httpPath,"_blank","")}).error(function(e,n){i[0].success=!1,i[0].msg=t.instant("failedServer"),operationLog.setLog(a,i),r.warning(t.instant("access_communicate_error"))})}})},e.Delete_LocalUser=function(n){var a="access_delauthuser_1",i=t.instant("access_delauthuser_2")+n.UserName+"?";bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:i,callback:function(t){if(t){n.Password=o.encoder(n.Password);var i=n;l.request("put","/deleteuser",null,i,function(){e.getLocalUser()},null,a)}}})},e.getAccessCode=function(){var n={};a.get("/getaccesscode",n,function(n,t){if(200==t&&null!=n&&n.success&&(e.accessCodeList=n.result,null!=e.accessCodeList))for(var a=0;a<e.accessCodeList.length;a++)e.accessCodeList[a].access_code=o.decoder(e.accessCodeList[a].access_code)},function(){})},e.codeFilterDuplicateObject=function(e,n){var t=-1,a=n;return $.each(e,function(e,n){return n.access_code==a.access_code?t=0:void 0}),t},e.Add_AccessCode=function(){var n="access_add_accesscode_1";if(e.accessCodeInfo={},angular.copy(e.accessCodeTemp,e.accessCodeInfo),0!=e.accessCodeList.length){var a=e.codeFilterDuplicateObject(e.accessCodeList,e.accessCodeInfo);if(0==a)return void r.info(t.instant("access_add_accesscode_2"),"")}e.accessCodeInfo.access_code=o.encoder(e.accessCodeInfo.access_code);var i=JSON.stringify(e.accessCodeInfo.access_code);l.request("put","/addaccesscode",null,i,function(){e.getAccessCode()},null,n),e.Cancel()},e.codenum=0;var g=e.code=new s({removeAfterUpload:!1,headers:{Authorization:"sessionName "+window.localStorage.sessionId}});e.clearcode=function(){g.clearQueue()},g.onAfterAddingFile=function(n){var a=/[\S|\s]+.csv$/,i=a.test(n.file.name.toLowerCase());i||(e.clearcode(),r.info(t.instant("access_file_format_csv"),""))},g.onCompleteItem=function(n,a,i,l){if(e.codenum++,e.codenum<e.aps.length)e.importcode(g.queue[0]);else{e.codenum=0,e.getAccessCode();var s=t.instant("access_addauthuser_3")+a.total+" "+t.instant("access_addauthuser_4")+a.successTotal+"!";r.info(s,"")}},e.importcode=function(n){null!=e.aps&&(e.filename=n,g.queue[0].url=d+e.aps[e.codenum].ip+m+"/importcode/"+n.file.name,g.queue[0].upload())},e.downloadcodecsv=function(n){var a=t.instant("downAccessCodeFile"),i=[{ip:e.aps[0].ip,success:!1,msg:""}];bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:t.instant("downAccessCodeFile_2"),callback:function(e){e&&c({method:"get",url:"/downloadcodecsv",headers:{Authorization:"sessionName "+window.localStorage.sessionId}}).success(function(e,n,a){var i="application/octet-stream",l=!1;a=a();var s=a["content-disposition"],r=new Array;r=s.split("=");var o=r[1],c=a["content-type"]||i;try{console.log(t.instant("trySaveBlob"));var u=new Blob([e],{type:c});if(navigator.msSaveBlob)navigator.msSaveBlob(u,o);else{var p=navigator.webkitSaveBlob||navigator.mozSaveBlob||navigator.saveBlob;if(void 0===p)throw t.instant("notSupport");p(u,o),console.log(t.instant("saveBlobSucceed")),l=!0}}catch(d){console.log(t.instant("saveBlobFail")),console.log(d)}if(!l){var m=window.URL||window.webkitURL||window.mozURL||window.msURL;if(m){var f=document.createElement("a");if("download"in f)try{console.log(t.instant("tryDownLink"));var u=new Blob([e],{type:c}),g=m.createObjectURL(u);f.setAttribute("href",g),f.setAttribute("download",o);var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),f.dispatchEvent(h),console.log(t.instant("downloadLinkMethod")),l=!0}catch(d){console.log(t.instant("downloadLinkMethodWith")),console.log(d)}if(!l)try{console.log(t.instant("tryDownloadWindow"));var u=new Blob([e],{type:i}),g=m.createObjectURL(u);window.location=g,console.log(t.instant("downloadLinkMethodWindow")),l=!0}catch(d){console.log(t.instant("downloadLinkMethodWindowFail")),console.log(d)}}}l||(console.log(t.instant("noMethodWorked")),window.open(httpPath,"_blank",""))}).error(function(e,n){console.log(t.instant("requestFailed")+n),i[0].success=!1,i[0].msg=t.instant("failedServer"),operationLog.setLog(a,i),r.warning(t.instant("failedServer"))})}})},e.DelAccessCode=function(n){var a="access_del_accesscode_1",i=t.instant("access_del_accesscode_2")+n+"?";bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:i,callback:function(t){t&&(n=o.encoder(n),l.request("delete","/deleteaccesscode/"+n,null,null,function(){e.getAccessCode(),e.accessCodeTemp={access_code:""}},null,a))}})},e.restoredefault=function(){bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:t.instant("access_restore_portal_1"),callback:function(e){if(e){var n="access_restore_portal_2";l.request("put","/restoredefault",null,null,function(){},null,n)}}})},e.filename={},e.logonum=0,e.bgnum=0,e.licnum=0;var h=e.logo=new s({removeAfterUpload:!1,headers:{Authorization:"sessionName "+window.localStorage.sessionId}});e.clearlogo=function(){h.clearQueue()},h.onAfterAddingFile=function(n){var a=/[\S|\s]+.(png|jpg)/,i=a.test(n.file.name.toLowerCase());i||(e.clearlogo(),r.info(t.instant("access_file_format_png"),""));var l=n.file.size/1024;return l>20?(e.clearlogo(),void r.warning(t.instant("access_logo_toobig"),"")):void 0},h.onCompleteAll=function(){e.logonum++,e.logonum<e.aps.length?e.uploadlogo(h.queue[0]):e.logonum=0},e.uploadlogo=function(n){null!=e.aps&&(e.filename=n,h.queue[0].url=d+e.aps[e.logonum].ip+m+"/uploadlogo/"+n.file.name,h.queue[0].upload())};var _=e.main=new s({removeAfterUpload:!1,headers:{Authorization:"sessionName "+window.localStorage.sessionId}});e.clearmain=function(){_.clearQueue()},_.onAfterAddingFile=function(n){var a=/[\S|\s]+.(png|jpg)$/,i=a.test(n.file.name.toLowerCase());i||(e.clearmain(),r.info(t.instant("access_file_format_png"),""));var l=n.file.size/1024;return l>200?(e.clearmain(),void r.warning(t.instant("access_background_toobig"),"")):void 0},_.onCompleteAll=function(){e.bgnum++,e.bgnum<e.aps.length?e.uploadmain(_.queue[0]):e.bgnum=0},e.uploadmain=function(n){null!=e.aps&&(e.filename=n,_.queue[0].url=d+e.aps[e.bgnum].ip+m+"/uploadmain/"+n.file.name,_.queue[0].upload())};var C=e.license=new s({removeAfterUpload:!1,headers:{Authorization:"sessionName "+window.localStorage.sessionId}});e.clearlicense=function(){C.clearQueue()},C.onAfterAddingFile=function(n){var a=/[\S|\s]+.txt$/,i=a.test(n.file.name);i||(e.clearlicense(),r.info(t.instant("access_file_format_txt"),""));var l=n.file.size/1024;return l>50?(e.clearlicense(),void r.warning(t.instant("access_term_toobig"),"")):void 0},C.onCompleteAll=function(){e.licnum++,e.licnum<e.aps.length?e.uploadlicense(C.queue[0]):e.licnum=0},e.uploadlicense=function(n){null!=e.aps&&(e.filename=n,C.queue[0].url=d+e.aps[e.licnum].ip+m+"/uploadlicense/"+n.file.name,C.queue[0].upload())},e.Cancel=function(){e.customized_portal=!1,e.add_local_auth_user=!1,e.localuser_detail=!1,e.edit_local_auth_user=!1,e.localuser_detail=!1,e.add_access_code=!1,e.batch_import=!1,e.batch_code=!1},e.ShowAddLocalUser=function(){e.Cancel(),e.localUserListTemp={},$("form[name='add_localauth_user']")[0].reset(),this.add_localauth_user.$setPristine(),e.add_local_auth_user=!0;var n=e.authenticationParams.CaptiveTime;n=n.replace(/\./g,"/");var t=n;$("#add_startdatepicker").datetimepicker({format:"YYYY.MM.DD",useCurrent:!1,ignoreReadonly:!0,minDate:t}).on("dp.change",function(e){$("#add_enddatepicker").data("DateTimePicker").minDate(e.date)}),$("#add_enddatepicker").datetimepicker({format:"YYYY.MM.DD",useCurrent:!1,ignoreReadonly:!0,minDate:t}).on("dp.change",function(e){$("#add_startdatepicker").data("DateTimePicker").maxDate(e.date)})},e.ShowLocalUserDetail=function(n){e.Cancel(),e.localuser_detail=!0,e.localUserListTemp=angular.copy(n),"#"==e.localUserListTemp.FirstName?e.localUserListTemp.FirstName=null:e.localUserListTemp.FirstName.indexOf("?")>0&&(e.localUserListTemp.FirstName=e.localUserListTemp.FirstName.replace(/\?/g," ")),"#"==e.localUserListTemp.LastName?e.localUserListTemp.LastName=null:e.localUserListTemp.LastName.indexOf("?")>0&&(e.localUserListTemp.LastName=e.localUserListTemp.LastName.replace(/\?/g," ")),"#"==e.localUserListTemp.Company?e.localUserListTemp.Company=null:e.localUserListTemp.Company.indexOf("?")>0&&(e.localUserListTemp.Company=e.localUserListTemp.Company.replace(/\?/g," "))},e.Show_Edit_Localauth_User=function(n){var t,a,i,l;e.localUserListTemp=angular.copy(n),"#"==e.localUserListTemp.FirstName?e.localUserListTemp.FirstName=null:e.localUserListTemp.FirstName.indexOf("?")>0&&(e.localUserListTemp.FirstName=e.localUserListTemp.FirstName.replace(/\?/g," ")),"#"==e.localUserListTemp.LastName?e.localUserListTemp.LastName=null:e.localUserListTemp.LastName.indexOf("?")>0&&(e.localUserListTemp.LastName=e.localUserListTemp.LastName.replace(/\?/g," ")),"#"==e.localUserListTemp.Company?e.localUserListTemp.Company=null:e.localUserListTemp.Company.indexOf("?")>0&&(e.localUserListTemp.Company=e.localUserListTemp.Company.replace(/\?/g," ")),t=e.authenticationParams.CaptiveTime,a=t.replace(/\./g,"/"),i=n.StartingDate,i=i.replace(/\./g,"/"),l=a>i?i:a,$("#edit_start_date").datetimepicker({format:"YYYY.MM.DD",useCurrent:!1,ignoreReadonly:!0,minDate:l}).on("dp.change",function(e){var n=$("#edit_start_value").val(),t=n.replace(/\./g,"/");t>a?$("#edit_end_date").data("DateTimePicker").minDate(e.date):$("#edit_end_date").data("DateTimePicker").minDate(a)}),$("#edit_start_date").data("DateTimePicker").minDate(l),$("#edit_end_date").datetimepicker({format:"YYYY.MM.DD",useCurrent:!1,ignoreReadonly:!0,minDate:a}).on("dp.change",function(e){$("#edit_start_date").data("DateTimePicker").maxDate(e.date)}),e.Cancel(),e.edit_local_auth_user=!0,e.localuser_param_error=!1,e.mailError=!1,angular.copy(n,e.modifybefore),e.localUserListTemp.PasswordConfirm=e.localUserListTemp.Password,$("#edit_start_date").data("DateTimePicker").date(e.localUserListTemp.StartingDate),$("#edit_end_date").data("DateTimePicker").date(e.localUserListTemp.EndingDate)},e.ShowCustomizedPortal=function(){e.Cancel(),e.customized_portal=!0},e.ShowAddWhite=function(){$("form[name='add_whitelist']")[0].reset(),e.customized_portal=!1,e.add_local_auth_user=!1,e.add_access_code=!1,e.batch_import=!1,e.batch_code=!1,e.localuser_detail=!1},e.ShowAddMACAccount=function(){$("form[name='add_local_mac']")[0].reset(),e.customized_portal=!1,e.add_local_auth_user=!1,e.add_access_code=!1,e.batch_import=!1,e.batch_code=!1,e.localuser_detail=!1},e.ShowAddAccessCode=function(){e.Cancel(),e.add_access_code=!0},e.ShowBatchImport=function(){e.Cancel(),e.batch_import=!0,e.batch_code=!1},e.ShowCodeImport=function(){e.customized_portal=!1,e.add_local_auth_user=!1,e.add_access_code=!1,e.batch_import=!1,e.batch_code=!0},e.getTftpInfo=function(){a.get("/getTftpInfo",null,function(n,t){200==t&&null!=n&&n.success&&(e.tftpInfo=n.result,e.echoCycleLevels(e.tftpInfo.TFTPCycle))},function(){})},e.setTftpSwitch=function(){var n="access_tftp_switch",t=JSON.stringify(e.tftpInfo.FTFPStatus);l.request("put","/settftpswitch",null,t,function(){},null,n)},e.changeCycleLevel=function(){"1"==this.cycleLevel.value?e.tftpInfo.TFTPCycle="1":"2"==this.cycleLevel.value?e.tftpInfo.TFTPCycle="2":"4"==this.cycleLevel.value&&(e.tftpInfo.TFTPCycle="4")},e.saveTftpInfo=function(){var n="access_save_tftp_conf",t=JSON.stringify(e.tftpInfo);l.request("put","/savetftpinfo",null,t,function(){},null,n)},e.uploadTftpNow=function(){var n="access_tftp_upload_now";e.tftpInfoTemp=e.tftpInfo,e.tftpInfoTemp.TFTPCycle=0;var t=JSON.stringify(e.tftpInfoTemp);l.request("put","/uploadtftpinfo",null,t,function(){},null,n)},e.currentLine=0,e.getCurrentClientDetail=function(n){e.localUserListTemp=n},e.close=function(){n.close()},e.localuser_param_error=!1,e.mailError=!1,e.checkMail=function(n){if(null!=n&&""!=n){var t=n.length;t>64?(e.localuser_param_error=!0,e.mailError=!0):(e.localuser_param_error=!1,e.mailError=!1)}else e.localuser_param_error=!1,e.mailError=!1},e.getcaptiveportalinfo(),e.getLocalUser(),e.getAccessCode(),e.getTftpInfo(),e.currentUser=window.localStorage.username,e.logoutToLoginPage=function(){a.post("/authentication/logout",null,null,function(e){window.location.href="/static/login.html"})},e.portalInfo={"switch":!1,url:""};var v={enable:!0,url:""};u(),p(),e.setPortalUrlSwitch=function(){l.request("put","/captive/setSwitch",null,v,function(e){null!=e&&e.success},null,null)},e.setPortalUrl=function(){l.request("put","/captive/setUrl",null,v,function(e){null!=e&&e.success},null,null)},e.setPortalCaptive=function(){e.portalInfo["switch"]?(v.enable=e.portalInfo["switch"],v.url=e.portalInfo.url):(v.enable=e.portalInfo["switch"],v.url=""),e.setPortalUrlSwitch(),e.setPortalUrl()},e.configStatus=function(){e.portalInfo["switch"]?e.isFormat=!1:(e.isFormat=!0,e.checkButton=!1)},e.changeFormat=function(){var n=e.portalInfo.url,t="http://*",a=new RegExp(t);a.test(n)?(e.checkbox_checked=!1,e.checkButton=!1):(console.info("not fromat"),e.checkbox_checked=!0,e.checkButton=!0)}}]),angular.module("module.terminal.access",[]).controller("TerminalAccessController",["$scope","$translate","singleModal","authentifiedRequest","InterService","batchSyncConfig","FileUploader","toastr","hanCrypto",function(e,n,t,a,i,l,s,r,o){e.skin=i.skin,e.InterService=i,e.aps=i.getCanConfigAps();i.getProtocol()+"://",":"+i.getPort();e.$watch("InterService",function(n,t){n!==t&&(e.aps=i.getCanConfigAps())},!0),e.BlackList=[],e.BlackListTemp={Begin_MAC:"",End_MAC:""},e.WhiteList=[],e.WhiteListTemp={Begin_MAC:"",End_MAC:""},e.WallList=[],e.WallListTemp={Begin_IP:"",End_IP:""},e.mac_compare=function(n,t,a){var i=n.length;if((17==i||1>=a)&&n.toUpperCase()==t.Begin_MAC.toUpperCase())return!0;if(35==i||2>=a)if(e.arr=n.split("-"),""!=t.End_MAC){if(t.Begin_MAC<=e.arr[0]&&t.End_MAC>=e.arr[0])return!0;if(t.Begin_MAC>=e.arr[0]&&t.End_MAC<=e.arr[1])return!0;if(t.Begin_MAC<=e.arr[1]&&t.End_MAC>=e.arr[1])return!0}else if(t.Begin_MAC>=e.arr[0]&&t.Begin_MAC<=e.arr[1])return!0;if(8==i||3>=a){var l=t.Begin_MAC.substr(0,8);if(n.toUpperCase()==l.toUpperCase())return!0}return!1},e.maclistFilterDuplicateObject=function(n,t){var a=!1,i=t,l="",s=0;if(""==i.End_MAC)s=8==i.Begin_MAC.length?3:1,l=i.Begin_MAC;else{s=2;var r=i.Begin_MAC.substr(0,8),o=i.End_MAC.substr(0,8);if(r!=o||i.Begin_MAC>i.End_MAC)return!0;l=i.Begin_MAC+"-"+i.End_MAC}return $.each(n,function(n,t){var l=e.mac_compare(t.MAC,i,s);return 1==l?a=!0:void 0}),a},e.toggleManager.getBlackList=function(){var n={};a.get("/getblacklist",n,function(n,t){200==t&&null!=n&&n.success&&(e.BlackList=n.result)},function(){})},e.Add_Blacklist=function(){if(null!=e.BlackList){if(e.BlackList.length>=256)return void r.info(n.instant("client_kick_user_1"),"");var t=e.maclistFilterDuplicateObject(e.BlackList,e.BlackListTemp);if(1==t)return void r.info(n.instant("access_add_blacklist_1"),"")}var a="access_add_blacklist_2",i=JSON.stringify(e.BlackListTemp);l.request("put","/addBlacklist",null,i,function(){e.toggleManager.getBlackList()},null,a),e.BlackListTemp.Begin_MAC="",$("form[name='add_black_mac']")[0].reset(),this.add_black_mac.$setPristine(),e.Cancel()},e.Del_Blacklist=function(t){var a="access_del_blacklist_1",i=n.instant("access_del_blacklist_2")+t+"?";bootbox.confirm({buttons:{cancel:{label:n.instant("Cancel")},confirm:{label:n.instant("OK")}},message:i,callback:function(n){n&&l.request("delete","/delBlacklist/"+t,null,null,function(){e.toggleManager.getBlackList()},null,a)}})},e.toggleManager.getWhiteList=function(){var n={};a.get("/getwhitelist",n,function(n,t){200==t&&null!=n&&n.success&&(e.WhiteList=n.result)},function(){})},e.Add_Whitelist=function(){var t="access_add_whitelist_1";if(null!=e.WhiteList){8==e.WhiteListTemp.Begin_MAC.length&&(e.WhiteListTemp.End_MAC="");var a=e.maclistFilterDuplicateObject(e.WhiteList,e.WhiteListTemp);if(1==a)return void r.info(n.instant("access_add_whitelist_2"),"")}var i=JSON.stringify(e.WhiteListTemp);l.request("put","/addwhitelist",null,i,function(){e.toggleManager.getWhiteList()},null,t),e.WhiteListTemp.Begin_MAC="",e.WhiteListTemp.End_MAC="",$("form[name='add_local_mac']")[0].reset(),this.add_local_mac.$setPristine(),e.Cancel()},e.Del_Whitelist=function(t){var a="access_del_whitelist_1",i=n.instant("access_del_whitelist_2")+t+"?";bootbox.confirm({buttons:{cancel:{label:n.instant("Cancel")},confirm:{label:n.instant("OK")}},message:i,callback:function(n){if(n){var i="/delwhitelist/"+t;l.request("delete",i,null,null,function(){e.toggleManager.getWhiteList()},null,a)}}})},e.ip2int=function(e){var n=0;return e=e.split("."),n=256*Number(e[0])*256*256+256*Number(e[1])*256+256*Number(e[2])+Number(e[3]),n>>>=0},e.ipaddr_compare=function(n){var t=!1;if(""==n.End_IP)return t;if(n.End_IP==n.Begin_IP)return t;var a=e.ip2int(n.Begin_IP),i=e.ip2int(n.End_IP);return a>i?t=!0:t},e.ip_range_compare=function(n,t,a){var i=0,l=0,s=0,r=0,o=0,c=!1;if(n.indexOf("-")>0&&(i=1,e.added=n.split("-")),1>=a)if(0==i){if(r=e.ip2int(n),l=e.ip2int(t.Begin_IP),r==l)return c=!0}else if(r=e.ip2int(e.added[0]),o=e.ip2int(e.added[1]),l=e.ip2int(t.Begin_IP),l>=r&&o>=l)return c=!0;if(1==i&&2>=a)if(r=e.ip2int(e.added[0]),o=e.ip2int(e.added[1]),l=e.ip2int(t.Begin_IP),s=e.ip2int(t.End_IP),0==s){if(l>=r&&o>=l)return c=!0}else{if(r>=l&&s>=r)return c=!0;if(l>=r&&o>=s)return c=!0;if(o>=l&&s>=o)return c=!0}return c},e.iplistFilterDuplicateObject=function(n,t){var a=!1,i=t,l="",s=0;return""==i.End_IP?(s=1,l=i.Begin_IP):(s=2,l=i.Begin_IP+"-"+i.End_IP),$.each(n,function(n,t){var l=e.ip_range_compare(t.Domain,i,s);return 1==l?a=!0:void 0}),a},e.toggleManager.getWallList=function(){a.get("/getwalllist",null,function(n,t){200==t&&null!=n&&n.success&&(e.WallList=n.result)},function(){})},e.Add_Walllist=function(){var t="access_walled_garden_4";if(null!=e.WallList){if(e.WallList.length>=128)return void r.info(n.instant("access_walled_garden_1"),"");var a=e.ipaddr_compare(e.WallListTemp);if(1==a)return void r.info(n.instant("access_walled_garden_2"),"");var a=e.iplistFilterDuplicateObject(e.WallList,e.WallListTemp);if(1==a)return void r.info(n.instant("access_walled_garden_3"),"")}var i=JSON.stringify(e.WallListTemp);l.request("put","/addwalllist",null,i,function(){e.toggleManager.getWallList(),e.WallListTemp.End_IP=""},null,t),e.WallListTemp.Begin_IP="",e.WallListTemp.End_IP="",$("form[name='add_whitelist']")[0].reset(),this.add_whitelist.$setPristine(),e.Cancel()},e.Del_Walllist=function(t){var a="access_del_walled_garden_1",i=n.instant("access_del_walled_garden_2")+t.Domain+"?";bootbox.confirm({buttons:{cancel:{label:n.instant("Cancel")},confirm:{label:n.instant("OK")}},message:i,callback:function(n){n&&l.request("delete","/delwalllist/"+t.Domain,null,null,function(){e.toggleManager.getWallList()},null,a)}})},e.Cancel=function(){},e.CheckStartingMac=function(){if(null!=e.WhiteListTemp.Begin_MAC||""!=e.WhiteListTemp.Begin_MAC){var n=e.WhiteListTemp.Begin_MAC.length;8==n&&(e.WhiteListTemp.End_MAC="")}}}]),angular.module("module.terminal.acl",[]).controller("TerminalAclViewController",["$scope","$http","singleModal","authentifiedRequest",function(e,n,t,a){e.aclList=[],e.toggleManager.aclGetRule=function(){var n={};e.aclList=[],a.get("/aclrule",n,function(n,t){200==t&&null!=n&&n.success&&(e.aclList=n.result)},function(){})},e.openAclViewPageInit=function(){t.open({templateUrl:"terminal/acl/acl-conf.html",controller:"TerminalAclConfController",size:"lg",backdrop:!0},function(n){e.toggleManager.aclGetRule()},function(n){e.toggleManager.aclGetRule()})}}]),angular.module("module.terminal.acl").controller("TerminalAclConfController",["$scope","$http","$modalInstance","$translate","authentifiedRequest","InterService","batchSyncConfig","toastr",function(e,n,t,a,i,l,s,r){e.skin=l.skin,e.InterService=l,e.ACLDetailGroupList=[],e.defaultACLAction="accept",e.aclDetail=!1,e.aclEdit=!1,e.aclAdd=!1,e.isAddACL=!1,e.isEditACL=!1,e.ACLIPProtocal=["ALL","TCP","UDP","ICMP"],e.ACLTarget=["ACCEPT","REJECT"],e.ACLDetailTemp={src_ip:"",src_port:"",dest_ip:"",dest_port:"",src_ip_flag:!1,src_port_flag:!1,dest_ip_flag:!1,dest_port_flag:!1,proto:"",target:""},e.ACLDetailCopy={},e.ShowEditACL=function(n){e.aclDetail=!1,e.aclEdit=!0,e.aclAdd=!1,e.oldAclDemo=angular.copy(n),e.ACLDetailTemp=angular.copy(n),e.ACLDetailCopy=angular.copy(e.ACLDetailTemp),e.anycheck(e.ACLDetailTemp)},e.ShowAclDetail=function(n){e.aclDetail=!0,e.aclEdit=!1,e.aclAdd=!1,e.ACLDetailTemp=n},e.ShowAddACL=function(){e.ACLDetailTemp={},$("form[name='addacl']")[0].reset(),this.addacl.$setPristine(),e.ACLDetailTemp.src_ip_flag=!1,e.ACLDetailTemp.src_port_flag=!1,e.ACLDetailTemp.dest_ip_flag=!1,e.ACLDetailTemp.dest_port_flag=!1,e.ACLDetailTemp.proto="ALL",e.ACLDetailTemp.target="ACCEPT",e.aclAdd=!0,e.aclDetail=!1,e.aclEdit=!1},e.aclGetDetailRule=function(){var n={},t=0;null!=e.ACLDetailGroupList&&(t=e.ACLDetailGroupList.length),i.get("/aclrule",n,function(n,a){if(200==a&&null!=n&&n.success)if(e.ACLDetailGroupList=n.result,null!=e.ACLDetailGroupList){if(e.aclDetail=!0,e.aclAdd=!1,e.aclEdit=!1,e.tempindex>0&&e.isEditACL)e.ACLDetailTemp=e.ACLDetailGroupList[e.tempindex];else if(1==e.isAddACL){var i=e.ACLDetailGroupList.length;i>t&&(e.ACLDetailTemp=e.ACLDetailGroupList[i-1])}else 0==e.isEditACL&&0==e.isAddACL&&angular.copy(e.ACLDetailGroupList[0],e.ACLDetailTemp);for(var l=0;l<e.ACLDetailGroupList.length;l++)"Any"==e.ACLDetailGroupList[l].src_ip&&(e.ACLDetailGroupList[l].src_ip_flag=!0),"Any"==e.ACLDetailGroupList[l].src_port&&(e.ACLDetailGroupList[l].src_port_flag=!0),"Any"==e.ACLDetailGroupList[l].dest_ip&&(e.ACLDetailGroupList[l].dest_ip_flag=!0),"Any"==e.ACLDetailGroupList[l].dest_port&&(e.ACLDetailGroupList[l].dest_port_flag=!0)}else e.aclDetail=!1},function(){})},e.getDefaultACLAction=function(){var n={};i.get("/getdefaultACL",n,function(n,t){200==t&&null!=n&&n.success&&(e.defaultACLAction=n.result)},function(){})},e.setDefaultACLAction=function(n){e.defaultACLAction=n;var t="access_set_acl_1",a=JSON.stringify(e.defaultACLAction);s.request("put","/setdefaultACL",null,a,function(){e.getDefaultACLAction()},null,t)},e.DelACL=function(n){var t="access_del_acl_1",i="/deleterule/"+n.rule,l=a.instant("access_del_acl_2");bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:l,callback:function(n){n&&s.request("delete",i,null,null,function(){e.aclGetDetailRule()},null,t)}})},e.filterDuplicateObject=function(e,n){var t=!1,a=!1,i=angular.copy(n);return a=i.hasOwnProperty("src_ip"),0!=a&&""!=i.src_ip||(i.src_ip="Any"),a=i.hasOwnProperty("src_port"),0!=a&&""!=i.src_port||(i.src_port="Any"),a=i.hasOwnProperty("dest_ip"),0!=a&&""!=i.dest_ip||(i.dest_ip="Any"),a=i.hasOwnProperty("dest_port"),0!=a&&""!=i.dest_port||(i.dest_port="Any"),$.each(e,function(e,n){return n.src_ip==i.src_ip&&n.src_port==i.src_port&&n.dest_ip==i.dest_ip&&n.dest_port==i.dest_port&&n.proto==i.proto&&n.target==i.target?(t=!0,!1):void 0}),t},e.AddACL=function(){var n="access_add_acl_1";if(e.isEditACL=!1,e.isAddACL=!0,null!=e.ACLDetailGroupList){if(e.ACLDetailGroupList.length>=128)return void r.info(a.instant("access_add_acl_2"),"");var t=e.filterDuplicateObject(e.ACLDetailGroupList,e.ACLDetailTemp);if(1==t)return void r.info(a.instant("access_add_acl_3"),"")}var i=JSON.stringify(e.ACLDetailTemp);s.request("put","/addfirewall",null,i,function(){e.aclGetDetailRule(),e.ACLDetailTemp={}},null,n)},e.anycheck=function(e){"Any"==e.src_ip?(e.src_ip="",e.src_ip_flag=!0):e.src_ip_flag=!1,"Any"==e.src_port?(e.src_port="",e.src_port_flag=!0):e.src_port_flag=!1,"Any"==e.dest_ip?(e.dest_ip="",e.dest_ip_flag=!0):e.dest_ip_flag=!1,"Any"==e.dest_port?(e.dest_port="",e.dest_port_flag=!0):e.dest_port_flag=!1},e.check_src_ip=function(){1==e.ACLDetailTemp.src_ip_flag?e.ACLDetailTemp.src_ip="":e.ACLDetailTemp.src_ip=e.ACLDetailCopy.src_ip},e.check_src_port=function(){1==e.ACLDetailTemp.src_port_flag?e.ACLDetailTemp.src_port="":e.ACLDetailTemp.src_port=e.ACLDetailCopy.src_port},e.check_dest_ip=function(){1==e.ACLDetailTemp.dest_ip_flag?e.ACLDetailTemp.dest_ip="":e.ACLDetailTemp.dest_ip=e.ACLDetailCopy.dest_ip},e.check_dest_port=function(){1==e.ACLDetailTemp.dest_port_flag?e.ACLDetailTemp.dest_port="":e.ACLDetailTemp.dest_port=e.ACLDetailCopy.dest_port},e.EditACL=function(){var n="access_set_acl_2";e.isAddACL=!1,e.isEditACL=!0;var t=[];if(t.push(e.oldAclDemo),e.filterDuplicateObject(t,e.ACLDetailTemp));else{var i=e.filterDuplicateObject(e.ACLDetailGroupList,e.ACLDetailTemp);if(1==i)return void r.info(a.instant("access_add_acl_3"),"")}var l=JSON.stringify(e.ACLDetailTemp);e.tempindex=$.inArray(e.ACLDetailTemp,e.ACLDetailGroupList),s.request("put","/modifyfirewall",null,l,function(){e.aclGetDetailRule()},null,n)},e.close=function(){t.close()},e.Cancel=function(){e.aclAdd=!1,e.aclDetail=!1,e.aclEdit=!1},e.moveACLlist=function(n,t){var a="access_set_acl_3",i=[];e.anycheck(n),e.anycheck(t),i.push(n),i.push(t);var l=JSON.stringify(i);s.request("put","/moveACLlist",null,l,function(){e.aclGetDetailRule()},null,a)},e.Moveup=function(n){e.temp="",e.temp=e.ACLDetailGroupList[n-1],e.ACLDetailGroupList[n-1]=e.ACLDetailGroupList[n],e.ACLDetailGroupList[n]=e.temp,e.temp="";var t=e.ACLDetailGroupList[n],a=e.ACLDetailGroupList[n-1];e.moveACLlist(t,a)},e.Movedown=function(n){e.temp=e.ACLDetailGroupList[n+1],e.ACLDetailGroupList[n+1]=e.ACLDetailGroupList[n],e.ACLDetailGroupList[n]=e.temp,e.temp="";var t=e.ACLDetailGroupList[n],a=e.ACLDetailGroupList[n+1];e.moveACLlist(t,a)},e.aclGetDetailRule(),e.getDefaultACLAction()}]),angular.module("system",[]).service("ClusterService",["authentifiedRequest",function(e){var n=this;n.ClusterinfoSer={},n.getClusterinfoSer=function(){return n.ClusterinfoSer},n.setClusterinfoSer=function(e){n.ClusterinfoSer=e},n.HttpClusterInfo=function(t){e.get("/getcluster",null,function(e){null!=e&&e.success?(n.ClusterinfoSer=e.result,null!=t&&t()):console.info("haps fail");
},function(){console.info("haps error")})}}]).controller("clusterController",["$scope","singleModal","authentifiedRequest","ClusterService",function(e,n,t,a){e.toggleManager.clusterInit=function(){a.HttpClusterInfo(null)},e.toggleManager.clusterInit(),e.$watch("ClusterService.ClusterinfoSer",function(n,t){console.log(n!==t),n!==t&&(e.clusterInfo=a.getClusterinfoSer())},!0),e.showCluster=function(){n.open({templateUrl:"system/cluster/cluster-config.html",controller:"clusterConfController",size:"lg",backdrop:!0})}}]).filter("userisEnable",[function(){var e=function(e){switch(e){case"0":return"Disabled";case"1":return"Enable "}};return e}]),angular.module("system").controller("syslogContronller",["$scope","InterService","authentifiedRequest","batchSyncConfig","lockScreen","$http","operationLog","toastr","$translate",function(e,n,t,a,i,l,s,r,o){function c(e,n,t){var a="application/octet-stream",i=!1;n=n();var l=n["content-type"]||a;try{var s=new Blob([e],{type:l});if(navigator.msSaveBlob)navigator.msSaveBlob(s,t);else{var r=navigator.webkitSaveBlob||navigator.mozSaveBlob||navigator.saveBlob;if(void 0===r)throw"Not supported";r(s,t),i=!0}}catch(o){}if(!i){var c=window.URL||window.webkitURL||window.mozURL||window.msURL;if(c){var u=document.createElement("a");if("download"in u)try{var s=new Blob([e],{type:l}),p=c.createObjectURL(s);u.setAttribute("href",p),u.setAttribute("download",t);var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),u.dispatchEvent(d),i=!0}catch(o){}if(!i)try{var s=new Blob([e],{type:a}),p=c.createObjectURL(s);window.location=p,i=!0}catch(o){}}}i||window.open(httpPath,"_blank","")}e.InterService=n,e.syslogs=[],e.apInfo=[],e.syslogLevels=[{name:"Emergent",value:"LOG_EMERG"},{name:"Alert",value:"LOG_ALERT"},{name:"Critical",value:"LOG_CRIT"},{name:"Error",value:"LOG_ERR"},{name:"Warning",value:"LOG_WARNING"},{name:"Notice",value:"LOG_NOTICE"},{name:"Info",value:"LOG_INFO"},{name:"Debug/ALL",value:"LOG_DEBUG"}],e.syslogParmas={},e.selectedLevel=e.syslogLevels[3],e.echoSyslogLevels=function(n){"LOG_DEBUG"==n?e.selectedLevel=e.syslogLevels[7]:"LOG_INFO"==n?e.selectedLevel=e.syslogLevels[6]:"LOG_NOTICE"==n?e.selectedLevel=e.syslogLevels[5]:"LOG_WARNING"==n?e.selectedLevel=e.syslogLevels[4]:"LOG_ERR"==n?e.selectedLevel=e.syslogLevels[3]:"LOG_CRIT"==n?e.selectedLevel=e.syslogLevels[2]:"LOG_ALERT"==n?e.selectedLevel=e.syslogLevels[1]:"LOG_EMERG"==n&&(e.selectedLevel=e.syslogLevels[0])},e.toggleManager.syslogInit=function(){e.syslogInfoQuery(),e.syslogServerQuery(),e.apInfoQuery()},e.syslogServerQuery=function(){var n={};t.get("/syslogServerPara",n,function(n,t){200==t&&null!=n&&n.success&&(e.syslogParmas=n.result,e.echoSyslogLevels(e.syslogParmas.level))},function(){})},e.apInfoQuery=function(){e.apInfo=n.getCanConfigAps(),e.selectedAp=e.apInfo[0]},e.syslogInfoQuery=function(){var a={};e.syslogs=[];for(var i=n.getCanConfigAps(),l=0;l<i.length;l++){var s=i[l].ip,r=n.getProtocol()+"://"+s+":"+n.getPort()+"/syslog";t.get(r,a,function(n,t){200==t&&null!=n&&n.success&&(0==e.syslogs.length?e.syslogs=angular.copy(n.result):e.syslogs=e.syslogs.concat(n.result))},function(){})}},e.saveServerLevel=function(){e.syslogParmas.level=e.selectedLevel.value;var n=JSON.stringify(e.syslogParmas),t="syslog_edit_level",i=e.syslogParmas.level;a.request("put","/syslogServerLevel",null,n,function(){e.syslogServerQuery()},null,t,null,i)},e.configLogRemote=function(){var n,t=JSON.stringify(e.syslogParmas);n=e.syslogParmas.logRemoteSwitch?"syslog_edit_remoteSwitch_1":"syslog_edit_remoteSwitch_2",a.request("put","/logRemoteSwitch",null,t,function(){e.syslogServerQuery()},null,n)},e.saveServerIp=function(){var n=JSON.stringify(e.syslogParmas),t="syslog_edit_serverIp",i=e.syslogParmas.ip;a.request("put","/syslogServerIp",null,n,function(){e.syslogServerQuery()},null,t,null,i)},e.downloadSyslog=function(){i.lock();var t=e.selectedAp.ip,a=n.getProtocol()+"://"+t+":"+n.getPort()+"/downloadSyslog1",u=n.getProtocol()+"://"+t+":"+n.getPort()+"/downloadSyslog2",p=n.getProtocol()+"://"+t+":"+n.getPort()+"/downloadSyslog3",d="kes_syslog",m="kes_history_syslog.log",f="kes_history_traps.log",g="syslog_down",h=e.selectedAp.apname,_=[{ip:t,success:"module_operate_failure",msg:""}];l({method:"put",url:a,headers:{Authorization:"sessionName "+window.localStorage.sessionId}}).success(function(e,n,t){i.unlock(),null==e||""==e?(_[0].success="module_operate_failure",_[0].msg="log_backendServer_error"):("undefined"==typeof e.success?(c(e,t,d),_[0].success="module_operate_success",r.info(o.instant("syslog_down_success_1"),"")):(_[0].success="module_operate_failure",r.info(o.instant(e.msg),"")),_[0].msg=e.msg),s.setLog(g,_,h)}).error(function(){i.unlock(),_[0].success="module_operate_failure",_[0].msg="log_backendServer_error",s.setLog(g,_,h),r.warning(o.instant("log_backendServer_error"),"")}),l({method:"put",url:u,headers:{Authorization:"sessionName "+window.localStorage.sessionId}}).success(function(e,n,t){i.unlock(),null==e||""==e?(_[0].success="module_operate_failure",_[0].msg="log_backendServer_error"):("undefined"==typeof e.success?(c(e,t,m),_[0].success="module_operate_success",r.info(o.instant("syslog_down_success_2"),"")):(_[0].success="module_operate_failure",r.info(o.instant(e.msg),"")),_[0].msg=e.msg),s.setLog(g,_,h)}).error(function(){i.unlock(),_[0].success="module_operate_failure",_[0].msg="log_backendServer_error",s.setLog(g,_,h),r.warning(o.instant("log_backendServer_error"),"")}),l({method:"put",url:p,headers:{Authorization:"sessionName "+window.localStorage.sessionId}}).success(function(e,n,t){i.unlock(),null==e||""==e?(_[0].success="module_operate_failure",_[0].msg="log_backendServer_error"):("undefined"==typeof e.success?(c(e,t,f),_[0].success="module_operate_success",r.info(o.instant("syslog_down_success_3"),"")):(_[0].success="module_operate_failure",r.info(o.instant(e.msg),"")),_[0].msg=e.msg),s.setLog(g,_,h)}).error(function(){i.unlock(),_[0].success="module_operate_failure",_[0].msg="log_backendServer_error",s.setLog(g,_,h),r.warning(o.instant("log_backendServer_error"),"")})}}]),angular.module("system").controller("NTPContronller",["$scope","$translate","authentifiedRequest","batchSyncConfig","toastr","ntpTimeZoneConstant","ntpDateTimeConstant","$cookieStore",function(e,n,t,a,i,l,s,r){function o(){t.get("/other/city",null,function(n){if(null!=n&&n.success){e.cityCode.city=n.city;for(var t=0;t<e.datimeArray.length;t++){var a=e.datimeArray[t].name.split("@")[0];a==n.city&&(""!=e.datimeArray[t].value?e.daylightSwitch.enable=!1:e.daylightSwitch.enable=!0)}}}),t.get("/network/ntpClient/getTimezone",null,function(n){if(null!=n&&n.success){var t=n.timezone;t.indexOf(",")>0?(console.info("open switch"),e.daylightSwitch["switch"]=!0):(console.info("close switch"),e.daylightSwitch["switch"]=!1)}})}e.timeZoneArray=l.utc,e.datimeArray=s.edt,e.userName=window.localStorage.username,e.ntpConfig={dateTime:"",timeZone:"",ntpServerList:[],city:""},e.apDateTimeConfig={selectTimeZone:"",dateTime:"",showPickerFlag:!1,showTimezoneSelectFlag:!1,modifyFlag:!1},e.NTP_ServerIP_Temp="",e.cityCode={city:"",dst:""},e.daylightSwitch={"switch":!1,enable:!1},e.configStatus=function(){var n;if(e.daylightSwitch["switch"])for(var t=0;t<e.datimeArray.length;t++){var i=e.datimeArray[t].name.split("@")[0];if(n=e.datimeArray[t].name.split("@")[1],i==e.cityCode.city){n+=e.datimeArray[t].value;break}}else for(var t=0;t<e.datimeArray.length;t++){var i=e.datimeArray[t].name.split("@")[0];if(i==e.cityCode.city){n=e.datimeArray[t].name.split("@")[1];break}}var l={timezone:"",city:""};l.timezone=n,a.request("put","/network/ntpClient/setNtpTimezoneDaylight",null,l,function(){o()},null,null)},o();var c=$("#ntpDatetime");e.dynamicTime=function(){e.currentDatetime.setSeconds(e.currentDatetime.getSeconds()+1);var n,t=e.currentDatetime.toTimeString().indexOf("GMT");n=e.currentDatetime.toDateString()+"  "+e.currentDatetime.toTimeString().substr(0,t-1),"zh"==r.get("lang")&&(n=e.currentDatetime.toLocaleDateString()+" "+e.currentDatetime.toLocaleTimeString()),c.text(n)},e.time,e.ntpParamQuery=function(){t.get("/network/ntpClient/confParams",null,function(n){if(null!=n&&n.success){e.ntpConfig=n.result,e.setSelectTimeZone(e.ntpConfig.city);var t=new Date(Date.parse(e.ntpConfig.dateTime.replace(/-/g,"/")));e.currentDatetime=new Date(t),e.time&&clearInterval(e.time),e.dynamicTime(),e.time=setInterval(e.dynamicTime,1e3),e.apDateTimeConfig.modifyFlag=!0}},function(){})},e.setSelectTimeZone=function(n){if(null==n||""==n)return"";for(var t=e.timeZoneArray,a=0,i=t.length;i>a;a++)if(-1!=t[a].indexOf(n+"@")){e.apDateTimeConfig.selectTimeZone=t[a],e.ntpConfig.timeZone=t[a];break}},e.toggleManager.ntpInit=function(){e.ntpParamQuery()},e.toggleManager.ntpDestory=function(){e.time&&(clearInterval(e.time),e.time=null),e.ntpConfig={dateTime:"",timeZone:"",ntpServerList:[],city:""},e.apDateTimeConfig={selectTimeZone:"",dateTime:"",showPickerFlag:!1,showTimezoneSelectFlag:!1,modifyFlag:!1},c.text("")},e.SyncNTPServerIPList=function(){var n={ntpServerList:[]};n.ntpServerList=e.ntpConfig.ntpServerList;var t="ntp_log_adjustOrder";a.request("put","/network/ntpClient/ntpserver",null,n,function(){e.ntpParamQuery()},null,t)},e.removeNtpserver=function(t){if(1==e.ntpConfig.ntpServerList.length)return void i.warning(n.instant("ntpNotLess"));var l="ntp_log_removeServer",s=n.instant("delNtpServer")+t+"?";bootbox.confirm({buttons:{cancel:{label:n.instant("Cancel")},confirm:{label:n.instant("OK")}},message:s,callback:function(n){n&&a.request("delete","/network/ntpClient/ntpserver/"+t,null,null,function(){e.ntpParamQuery()},null,l)}})},e.AddNTPServerIP=function(){for(var t=e.ntpConfig.ntpServerList,l=!1,s=0;s<t.length;s++)if(t[s]==e.NTP_ServerIP_Temp){l=!0,i.warning(n.instant("notAllowedRepetitionNtp"));break}if(!l){var r="ntp_log_addServer",o={ntpserver:e.NTP_ServerIP_Temp};a.request("post","/network/ntpClient/ntpserver",null,o,function(){e.ntpParamQuery()},null,r),e.NTP_ServerIP_Temp=""}},e.Moveup=function(n){e.temp="",e.temp=e.ntpConfig.ntpServerList[n-1],e.ntpConfig.ntpServerList[n-1]=e.ntpConfig.ntpServerList[n],e.ntpConfig.ntpServerList[n]=e.temp,e.temp="",e.SyncNTPServerIPList()},e.Movedown=function(n){e.temp=e.ntpConfig.ntpServerList[n+1],e.ntpConfig.ntpServerList[n+1]=e.ntpConfig.ntpServerList[n],e.ntpConfig.ntpServerList[n]=e.temp,e.temp="",e.SyncNTPServerIPList()},e.showApDatetimePicker=function(n){e.apDateTimeConfig.showPickerFlag=n,n&&$("#apdatetimepicker").data("DateTimePicker").date(e.currentDatetime)},e.showTimezoneSelect=function(n){e.apDateTimeConfig.showTimezoneSelectFlag=n},e.modifyDatetime=function(){var t=e.apDateTimeConfig.dateTime,i={datetime:t},l="ntp_log_modifyApDatetime",s=n.instant("updateApDatetime");bootbox.confirm({buttons:{cancel:{label:n.instant("Cancel")},confirm:{label:n.instant("OK")}},message:s,callback:function(n){n&&a.request("put","/network/ntpClient/datetime",null,i,function(){e.ntpParamQuery(),e.showApDatetimePicker(!1)},null,l)}})},e.modifyTimezone=function(){var t=e.apDateTimeConfig.selectTimeZone;if(null!=t&&""!=t){for(var i=t.split("@"),l=i[0],s=i[1],r=0;r<e.datimeArray.length;r++){var c=e.datimeArray[r].name.split("@")[0];if(l==c){s+=e.datimeArray[r].value;break}}var u={timezone:s,city:l},p="ntp_log_modifyApTimezone",d=n.instant("updateApTimezone");bootbox.confirm({buttons:{cancel:{label:n.instant("Cancel")},confirm:{label:n.instant("OK")}},message:d,callback:function(n){n&&a.request("put","/network/ntpClient/timezone",null,u,function(){e.ntpParamQuery(),e.showTimezoneSelect(!1),o()},null,p)}})}},$("#apdatetimepicker").datetimepicker({format:"YYYY-MM-DD HH:mm:ss",useCurrent:!1}),$("#apdatetimepicker").on("dp.change",function(n){e.apDateTimeConfig.dateTime=n.date.format("YYYY-MM-DD HH:mm:ss")})}]).filter("ntpSwitchFilter",[function(){var e=function(e){switch(e){case!0:return"Open";case!1:return"Close"}};return e}]),angular.module("system").controller("clusterConfController",["$scope","$modal","$modalInstance","$translate","authentifiedRequest","InterService","ClusterService","batchSyncConfig","lockScreen","operationLog",function(e,n,t,a,i,l,s,r,o,c){function u(){o.lock(),s.HttpClusterInfo(function(){p()})}function p(){e.clusterinfo=s.getClusterinfoSer(),e.cluster_conf.cluster_id=parseInt(e.clusterinfo.cluster_id),e.cluster_conf.cluster_name=e.clusterinfo.cluster_name,e.cluster_conf.cluster_location=e.clusterinfo.cluster_location,e.cluster_conf.cluster_vip=e.clusterinfo.cluster_vip,e.cluster_conf.cluster_netmask=e.clusterinfo.cluster_netmask,e.accountInfo.viewerstatus=e.clusterinfo.Viewer,e.accountInfo.gueststatus=e.clusterinfo.GuestOperator,o.unlock()}e.skin=l.skin,e.InterService=l,e.accountInfo={admin:"",viewerstatus:"0",view:"",gueststatus:"0",guest:""},e.subInfo={admin:"",viewerstatus:"0",view:"",gueststatus:"0",guest:""},e.accountconfirm={adminconfirm:"",viewconfirm:"",guestconfirm:""},e.cluster_conf={cluster_id:0,cluster_name:"",cluster_location:"",cluster_vip:"",cluster_netmask:""},u(),e.exchange=function(n){100==n?(e.accountInfo.view="",e.accountconfirm.viewconfirm=""):200==n&&(e.accountInfo.guest="",e.accountconfirm.guestconfirm="")},e.saveGroupID=function(){var n="modify_cluster_id";bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("modify_cluster_id_confirm"),callback:function(t){t?(r.request("put","/editclusterid",null,e.cluster_conf,function(){u()},null,n),i.post("/authentication/logout",null,null,function(e){window.location.href="/static/login.html"})):e.cluster_conf.cluster_id=parseInt(e.clusterinfo.cluster_id)}}),e.cancel()},e.Clusterinfo=function(){var n=l.getPVCinfo(),t="";if(null==n||""==n)return void toastr.warning(a.instant("cannot_get_pvc_info"));t=l.getProtocol()+"://"+n+":"+l.getPort()+"/editvip";var s="modify_cluster_baseinfo_log_name";r.request("put","/editclusterinfo",null,e.cluster_conf,function(){u()},null,s);var o="modify_cluster_vip",p=[{ip:"PVC",success:"module_oprate_failure",msg:""}];i.put(t,null,e.cluster_conf,function(e){null!=e&&e.success?(p[0].success="module_operate_success",p[0].msg="ap_log_success"):(p[0].success="module_oprate_failure",p[0].msg="ap_log_error_1",toastr.warning(a.instant("modify_cluster_vip_failed"))),c.setLog(o,p)},function(){p[0].success="module_oprate_failure",p[0].msg="failedServer",c.setLog(o,p),toastr.warning(a.instant("failedServer"))}),e.cancel()},e.Accountinfo=function(){e.accountInfo.admin.length>0&&(e.subInfo.admin=hex_md5(e.accountInfo.admin).toLowerCase()),e.accountInfo.view.length>0&&(e.subInfo.view=hex_md5(e.accountInfo.view).toLowerCase()),e.accountInfo.guest.length>0&&(e.subInfo.guest=hex_md5(e.accountInfo.guest).toLowerCase()),e.subInfo.viewerstatus=e.accountInfo.viewerstatus,e.subInfo.gueststatus=e.accountInfo.gueststatus;var n="modify_user_info_log_name";r.request("put","/editpasswd",null,e.subInfo,function(){e.accountInfo={admin:"",viewerstatus:"0",view:"",gueststatus:"0",guest:""},e.accountconfirm={adminconfirm:"",viewconfirm:"",guestconfirm:""},u(),e.cancel()},null,n),e.accountInfo.admin.length>0&&(console.info("-----------------------"),i.post("/authentication/logout",null,null,function(e){window.location.href="/static/login.html"}))},e.cancel=function(){t.close()}}]),angular.module("common",[]).controller("aboutContronller",["$scope","$modalInstance","authentifiedRequest","InterService",function(e,n,t,a){e.skin=a.skin,e.aboutInfo={name:"",softVersion:"",website:"",legal:"",countryCode:""},e.cancel=function(){n.dismiss("cancel")},e.query=function(){t.get("/other/systemInfo",null,function(n){if(n.success){var t=n.result;e.aboutInfo.name=t.HanletName,e.aboutInfo.softVersion=t.SoftwareVer,e.aboutInfo.website=t.Website,e.aboutInfo.legal=t.Legal,e.aboutInfo.countryCode=t.countryCode}},function(){})},e.query()}]),angular.module("common").controller("toolsContronller",["$scope","$modalInstance","$translate","$modal","InterService","authentifiedRequest","toastr","batchSyncConfig",function(e,n,t,a,i,l,s,r){function o(){l.get("/other/pmdSwitch",null,function(n){null!=n&&n.success&&("1"==n.result?e.pmdInformation.pmdSwitch=!0:e.pmdInformation.pmdSwitch=!1)},function(){})}function c(){l.get("/other/pmdIp",null,function(n){null!=n&&n.success&&(e.pmdInformation.tftpServer=n.result)},function(){})}e.skin=i.skin,e.InterService=i,e.showsysinfo_flag=!1,e.other_command_flag=!0,e.tools=[{id:0,name:"-"+t.instant("Select Command")+"-"},{id:1,name:"show system health"},{id:2,name:"show WIFI info"},{id:4,name:"show history syslog info"},{id:8,name:"traceroute"},{id:9,name:"ping"},{id:10,name:"show history reset reason"}],e.operation={},e.operation.selectApIp={},e.aps=[],e.requestParams={command:0,hostname:""},e.showHostname=!1,e.operation.result="",e.initFuc=function(){e.aps=i.getCanConfigAps();for(var n=0;n<e.aps.length;n++)1==e.aps[n].role&&(e.operation.selectApIp=e.aps[n])},e.initFuc(),e.changeTool=function(){var n=e.requestParams.command;return 8==n||9==n?void(e.showHostname=!0):(e.showHostname=!1,void(e.requestParams.hostname=""))},e.exec=function(){if(""==e.operation.selectApIp.ip)return void s.warning(t.instant("pleaseSelectAp"));if(0==e.requestParams.command)return void s.warning(t.instant("pleaseSelectTool"));var n=e.requestParams.command;if((8==n||9==n)&&""==e.requestParams.hostname)return void s.warning(t.instant("hostnameNotAllowEmpty"));e.operation.result="";var a=i.getProtocol()+"://",r=":"+i.getPort(),o=a+e.operation.selectApIp.ip+r+"/other/tools",c="30000";l.request("post",o,null,e.requestParams,c,function(n){if(null!=n&&n.success)if(e.operation.result=n.result,e.showsysinfo={free:[],df:[]},e.sysinfo_result={lineOne:"",lineTwo:"",lineThree:"",lineFour:"",lineFive:"",lineSix:""},1==e.requestParams.command){e.showsysinfo_flag=!0,e.other_command_flag=!1;for(var a=e.operation.result.split("\r\n"),i=0;i<a.length;i++)if(4>i){var l=a[i].replace(/[ ]+/g,"#"),s=l.split("#");""==s[0]||"Mem:"==s[0]?(e.sysinfo_result={},e.sysinfo_result.lineOne=s[0],e.sysinfo_result.lineTwo=s[1],e.sysinfo_result.lineThree=s[2],e.sysinfo_result.lineFour=s[3],e.sysinfo_result.lineFive=s[4],e.sysinfo_result.lineSix=s[5],e.showsysinfo.free.push(e.sysinfo_result),e.sysinfo_result={}):"-/+"==s[0]?(e.sysinfo_result={},s[0]=s[0]+" "+s[1],e.sysinfo_result.lineOne=s[0],e.sysinfo_result.lineTwo=s[2],e.sysinfo_result.lineThree=s[3],e.sysinfo_result.lineFour=" ",e.sysinfo_result.lineFive=" ",e.sysinfo_result.lineSix=" ",e.showsysinfo.free.push(e.sysinfo_result),e.sysinfo_result={}):"Swap:"==s[0]&&(e.sysinfo_result={},e.sysinfo_result.lineOne=s[0],e.sysinfo_result.lineTwo=s[1],e.sysinfo_result.lineThree=s[2],e.sysinfo_result.lineFour=s[3],e.sysinfo_result.lineFive=" ",e.sysinfo_result.lineSix=" ",e.showsysinfo.free.push(e.sysinfo_result),e.sysinfo_result={})}else{var r=a[i].replace(/[ ]+/g,"#"),o=r.split("#");"Mounted"==o[5]&&(o[5]="Mounted on"),e.sysinfo_result.lineOne=o[0],e.sysinfo_result.lineTwo=o[1],e.sysinfo_result.lineThree=o[2],e.sysinfo_result.lineFour=o[3],e.sysinfo_result.lineFive=o[4],e.sysinfo_result.lineSix=o[5],e.showsysinfo.df.push(e.sysinfo_result),e.sysinfo_result={}}}else e.showsysinfo_flag=!1,e.other_command_flag=!0;else{var c=t.instant("Operate")+" "+t.instant("module_operate_failure");e.operation.result=c}},function(){var n=t.instant("Operate")+" "+t.instant("module_operate_failure");e.operation.result=n})},e.cancel=function(){n.dismiss("cancel")},e.userName=window.localStorage.username,e.pmdInformation={pmdSwitch:!0,tftpServer:""};var u={enable:!0,pmdIp:""};o(),c(),e.configStatus=function(){console.info(e.pmdInformation.pmdSwitch),u.enable=e.pmdInformation.pmdSwitch,r.request("put","/other/setPmdSwitch",null,u,function(e){null!=e&&e.success},null,null)},e.savePmd=function(){console.info(e.pmdInformation.tftpServer),u.pmdIp=e.pmdInformation.tftpServer,r.request("put","/other/setPmdIp",null,u,function(e){null!=e&&e.success},null,null)}}]),angular.module("common").controller("pmdContronller",["$scope","$modalInstance","$translate","$modal","InterService","authentifiedRequest","toastr","batchSyncConfig",function(e,n,t,a,i,l,s,r){function o(){l.get("/other/pmdSwitch",null,function(n){null!=n&&n.success&&("1"==n.result?e.pmdInformation.pmdSwitch=!0:e.pmdInformation.pmdSwitch=!1)},function(){})}function c(){l.get("/other/pmdIp",null,function(n){null!=n&&n.success&&(e.pmdInformation.tftpServer=n.result)},function(){})}e.skin=i.skin,e.InterService=i,e.userName=window.localStorage.username,e.pmdInformation={pmdSwitch:!0,tftpServer:""};var u={enable:!0,pmdIp:""};o(),c(),e.configStatus=function(){console.info(e.pmdInformation.pmdSwitch),u.enable=e.pmdInformation.pmdSwitch,r.request("put","/other/setPmdSwitch",null,u,function(e){null!=e&&e.success},null,null)},e.savePmd=function(){console.info(e.pmdInformation.tftpServer),u.pmdIp=e.pmdInformation.tftpServer,r.request("put","/other/setPmdIp",null,u,function(e){null!=e&&e.success},null,null)},e.cancel=function(){n.dismiss("cancel")}}]),angular.module("common").controller("helpContronller",["$modalInstance",function(e){$scope.cancel=function(){e.dismiss("cancel")}}]),angular.module("wlan",[]).filter("wlanEnableFilter",[function(){var e=function(e){switch(e){case!0:return"On";case!1:return"Off"}};return e}]).controller("wlanController",["$scope","singleModal","authentifiedRequest","batchSyncConfig","clientService","monitorService","hanCrypto","$translate",function(e,n,t,a,i,l,s,r){e.wlans={},e.urlEscape=function(e){return e=e.replace(/\+/g,"%2B"),e=e.replace(/\//g,"%2F"),e=e.replace(/\?/g,"%3F"),e=e.replace(/%/g,"%25"),e=e.replace(/#/g,"%23"),e=e.replace(/&/g,"%26"),e=e.replace(/=/g,"%3D"),e=e.replace(/\\/g,"%5C"),e=e.replace(/\./g,"%2E"),e=e.replace(/:/g,"%3A")},e.titleWidth="",e.wlanManagement.query=function(){var n={};t.get("/wlans",n,function(n,t){if(200==t&&null!=n&&n.success){for(var a=0;a<n.result.wlanList.length;a++)n.result.wlanList[a].key=s.decoder(n.result.wlanList[a].key),n.result.wlanList[a].authSecret=s.decoder(n.result.wlanList[a].authSecret),n.result.wlanList[a].acctSecret=s.decoder(n.result.wlanList[a].acctSecret);e.wlanInfo=n.result,e.wlans=e.wlanInfo.wlanList;for(var a=0;a<e.wlans.length;a++)e.wlanClients=i.getWlanClient(e.wlans[a].ssid),null!=e.wlanClients?e.wlans[a].clients=e.wlanClients.length:e.wlans[a].clients=0;e.wlans.length>5?e.titleWidth="padding-right:17px;":e.titleWidth=""}},function(){})},e.wlanManagement.query(),e.modal=null,e.newWlan=function(){n.open({templateUrl:"wlan/wlan-conf.html",controller:"wlanConfContronller",size:"md",backdrop:!0,resolve:{wlans:function(){return e.wlans}}},function(){e.wlanManagement.query()},function(){e.wlanManagement.query()})},e.showWlanList=function(){n.open({templateUrl:"wlan/wlan-list.html",controller:"listContronller",size:"lg",backdrop:!0,resolve:{wlans:function(){return e.wlans}}},function(n){e.wlanManagement.query()},function(n){e.wlanManagement.query()})},e.configStatus=function(n){n.key=s.encoder(n.key),n.authSecret=s.encoder(n.authSecret),n.acctSecret=s.encoder(n.acctSecret);var t,i=JSON.stringify(n);t=n.enable?"wlan_edit_status_1":"wlan_edit_status_2";var l=n.ssid;a.request("put","/wlanStatus/"+e.urlEscape(n.ssid),null,i,function(){e.wlanManagement.query()},null,t,null,l)},e.showMonitorData=function(n){var t=r.instant("ClusterSSID")+n.ssid;l.changeObser("wlan",n.ssid,t),e.clientManagement.changeClient("wlan",n.ssid)}}]).directive("hover",["InterService",function(e){return{restrict:"A",link:function(n,t,a){t.bind("mouseover",function(n){"1"==t.attr("mnuelevel")?e.skin.isBlue?t.css("background-color","#608ebd"):e.skin.isPurple&&t.css("background-color","#9482a5"):"2"==t.attr("mnuelevel")?e.skin.isBlue?t.css("background-color","#c4dff1"):e.skin.isPurple&&t.css("background-color","#ddcfe0"):"0"==t.attr("mnuelevel")&&(e.skin.isBlue?t.css("background-color","#608ebd"):e.skin.isPurple&&t.css("background-color","#9482a5"))}),t.bind("mouseleave",function(){"0"!=t.attr("mnuelevel")?t.removeAttr("style"):t.attr("style","padding:0px;")})}}}]),angular.module("wlan").filter("enableFilter",[function(){var e=function(e){switch(e){case!0:return"Yes";case!1:return"No"}};return e}]).filter("wlanStatusFilter",["$translate",function(e){var n=function(n){switch(n){case!0:return e.instant("Enable");case!1:return e.instant("Disable")}};return n}]).controller("listContronller",["$scope","$modalInstance","$translate","InterService","authentifiedRequest","batchSyncConfig","toastr","wlans","hanCrypto","$timeout",function(e,n,t,a,i,l,s,r,o,c){function u(n,t){switch(t){case 1:e.isFormat_1=!n;break;case 2:e.isFormat_2=!n;break;case 3:e.isFormat_3=!n;break;case 4:e.isFormat_4=!n}}function p(n,t){switch(t){case 1:e.isEightFormat_1=!n;break;case 2:e.isEightFormat_2=!n;break;case 3:e.isEightFormat_3=!n;break;case 4:e.isEightFormat_4=!n}}function d(n,t){switch(t){case 1:e.isDownFormat_1=!n;break;case 2:e.isDownFormat_2=!n;break;case 3:e.isDownFormat_3=!n;break;case 4:e.isDownFormat_4=!n}}function m(n,t){switch(t){case 1:e.isDownEightFormat_1=!n;break;case 2:e.isDownEightFormat_2=!n;break;case 3:e.isDownEightFormat_3=!n;break;case 4:e.isDownEightFormat_4=!n}}e.skin=a.skin,e.isPersonal=!1,e.isEnterprise=!1,e.isCapital=!1,e.isCaptivePortal=!1,e.isDetailPersonal=!1,e.isDetailEnterprise=!1,e.ST={editSecurity:{id:"",name:"",units:[]}},e.Encryption={editEncryption:{id:"",name:"",value:""}},e.InterService=a,e.FORMAT={formatSelected:{id:"",name:""}},e.disabledSelect=!1,e.wlanList=r,e.band={twoG:!0,fiveG:!0},e.isTwoG=!0,e.countryCode=a.getCountryCode(),"CS"==e.countryCode&&(e.band={twoG:!1,fiveG:!0},e.isTwoG=!1),e.securityTypeArray=[{id:"00",name:"Open",units:[]},{id:"01",name:"Personal",units:[{id:"0109",name:"Both(wpa &wpa2)",value:"psk-mixed+tkip+aes"},{id:"0107",name:"wpa2-personal",value:"psk2+aes"}]},{id:"02",name:"Enterprise",units:[{id:"0209",name:"Both(wpa &wpa2)",value:"wpa-mixed+tkip+aes"},{id:"0207",name:"wpa2-enterprise",value:"wpa2+aes"}]}],e.passphraseFormatArray=[{id:"1",name:"8-63 chars"},{id:"2",name:"64 Hexadecimal chars"}],e.createSecurity=e.securityTypeArray[1],e.createEncryption=e.createSecurity.units[0],e.selectedAT=e.securityTypeArray[0],e.formatSelected=e.passphraseFormatArray[0],e.redisSwitch={isSwitch:!1},e.isRedisShow=!1,e.redisChange=function(n){n?(e.isRedisShow=!0,console.info("this is  "+n)):(e.isRedisShow=!1,console.info("this is  "+n))},e.initDivShow=function(){e.isCreate=!1,e.isEdit=!1,e.isDetail=!1,e.isWmm=!1,e.isWmmEdit=!1},e.initDivShow(),e.fprmatMsg={flag:0,msg:""},e.selecFormat=function(){"1"==this.formatSelected.id?(e.fprmatMsg.flag=1,e.fprmatMsg.msg=t.instant("enter8-63Chars")):"2"==this.formatSelected.id&&(e.fprmatMsg.flag=2,e.fprmatMsg.msg=t.instant("enter64Chars"))},e.uplink={dscpBg:"",dscpBe:"",dscpVideo:"",dscpVoice:"",eightBg:"",eightBe:"",eightVideo:"",eightVoice:""},e.downlink={dscpBg:"",dscpBe:"",dscpVideo:"",dscpVoice:"",eightBg:"",eightBe:"",eightVideo:"",eightVoice:""},e.wmmd={dscpSwitch:!1,dot1pSwitch:!1},e.urlEscape=function(e){return e=e.replace(/\+/g,"%2B"),e=e.replace(/\//g,"%2F"),e=e.replace(/\?/g,"%3F"),e=e.replace(/%/g,"%25"),e=e.replace(/#/g,"%23"),e=e.replace(/&/g,"%26"),e=e.replace(/=/g,"%3D"),e=e.replace(/\\/g,"%5C"),e=e.replace(/\./g,"%2E"),e=e.replace(/:/g,"%3A")},e.query=function(n){var t={};i.get("/wlans",t,function(t,a){if(200==a&&null!=t&&t.success){for(var i=0;i<t.result.wlanList.length;i++)t.result.wlanList[i].key=o.decoder(t.result.wlanList[i].key),t.result.wlanList[i].authSecret=o.decoder(t.result.wlanList[i].authSecret),t.result.wlanList[i].acctSecret=o.decoder(t.result.wlanList[i].acctSecret);if(e.wlanList=t.result.wlanList,""!=n)for(var i=0;i<e.wlanList.length;i++)if(n==e.wlanList[i].ssid){e.currentWlan=e.wlanList[i];break}}},function(){})},e.cancel=function(){n.close()},e.newWlan={authPort:1812,acctPort:1813},e.showCreate=function(){e.newWlan.maxClients=64,e.newWlan.probeThreshold=0,e.newWlan.hidden="No",e.newWlan.enable="Yes",e.newWlan.captivePortal="No",e.newWlan.vlanId=0,e.newWlan.upstreamLimit=0,e.newWlan.downstreamLimit=0,e.isPersonal=!0,e.isEnterprise=!1,e.isDetailPersonal=!1,e.isDetailEnterprise=!1,e.isCreate=!0,e.isEdit=!1,e.isDetail=!1,e.isWmm=!1,e.isWmmEdit=!1,e.isCapital=!1,e.redisSwitch.isSwitch=!0,this.createSecurity=e.securityTypeArray[1],this.createEncryption=this.createSecurity.units[0]},e.changeSecurityType=function(){"00"==this.createSecurity.id?(e.isPersonal=!1,e.isEnterprise=!1,e.isCapital=!0):"01"==this.createSecurity.id?(e.isPersonal=!0,e.isEnterprise=!1,e.isCapital=!1,this.createEncryption=this.createSecurity.units[0]):"02"==this.createSecurity.id&&(e.isPersonal=!1,e.isEnterprise=!0,e.isCapital=!1,e.isRedisShow=!1,e.redisSwitch.isSwitch=!1,this.createEncryption=this.createSecurity.units[0])},e.isWlanExist=function(e,n){for(var t=0;t<n.length;t++)if(e==n[t].ssid)return!0;return!1},e.createWlan=function(){if(e.isWlanExist(e.newWlan.ssid,e.wlanList))s.info(t.instant("wlanAlreadyExist1")+e.newWlan.ssid+t.instant("wlanAlreadyExist2"),"");else{if(e.band.twoG&&e.band.fiveG)e.newWlan.band="2G,5G";else if(e.band.twoG)e.newWlan.band="2G";else{if(!e.band.fiveG)return void s.info(t.instant("pleaseSelectedBand"),"");e.newWlan.band="5G"}e.newWlan.securityType=this.createSecurity.name,e.securityTypeArray[0].name!==e.newWlan.securityType&&(e.newWlan.encryption=this.createEncryption.value),e.redisSwitch.isSwitch||(e.newWlan.acctServer="",e.newWlan.acctPort="",e.newWlan.acctSecret="");var n=angular.copy(e.newWlan);n.key=o.encoder(n.key),n.keyConfirm=o.encoder(n.keyConfirm),n.authSecret=o.encoder(n.authSecret),n.acctSecret=o.encoder(n.acctSecret);var a=JSON.stringify(n),i="wlan_add_1",r=e.newWlan.ssid;l.request("post","/advanceWlan",null,a,function(){e.newWlan={},e.band.twoG=!0,e.band.fiveG=!0,e.initDivShow(),e.isDetail=!0,c(function(){e.query(n.ssid)},2e3)},null,i,null,r)}},e.oldssid="",e.oldWlan={},e.showEdit=function(n){e.oldssid=n.ssid,"open"==n.securityType?(this.ST.editSecurity=e.securityTypeArray[0],e.isDetailPersonal=!1,e.isDetailEnterprise=!1,e.isCapital=!0):"personal"==n.securityType?(e.isCapital=!1,this.ST.editSecurity=e.securityTypeArray[1],e.isDetailPersonal=!0,e.isDetailEnterprise=!1,n.keyConfirm=n.key,"psk-mixed+tkip+aes"==n.encryption?this.Encryption.editEncryption=this.ST.editSecurity.units[0]:"psk2+aes"==n.encryption&&(this.Encryption.editEncryption=this.ST.editSecurity.units[1])):"enterprise"==n.securityType&&(e.isCapital=!1,e.isDetailPersonal=!1,e.isDetailEnterprise=!0,this.ST.editSecurity=e.securityTypeArray[2],"wpa-mixed+tkip+aes"==n.encryption?this.Encryption.editEncryption=this.ST.editSecurity.units[0]:"wpa2+aes"==n.encryption&&(this.Encryption.editEncryption=this.ST.editSecurity.units[1]),null!=n.acctServer&&""!=n.acctServer?(e.redisSwitch.isSwitch=!0,e.isRedisShow=!0):(e.redisSwitch.isSwitch=!1,e.isRedisShow=!1)),console.info(n.key),64==n.key.length?this.FORMAT.formatSelected=e.passphraseFormatArray[1]:this.FORMAT.formatSelected=e.passphraseFormatArray[0],console.info(this.FORMAT.formatSelected),e.currentWlan=angular.copy(n),e.oldWlan=angular.copy(n),e.isCreate=!1,e.isEdit=!0,e.isDetail=!1,e.isWmm=!1,e.isWmmEdit=!1},e.changeSecurity=function(){e.ST.editSecurity=this.ST.editSecurity,"00"==this.ST.editSecurity.id?(e.isDetailPersonal=!1,e.isDetailEnterprise=!1,e.isCapital=!0,e.currentWlan.authPort="",e.currentWlan.acctPort=""):"01"==this.ST.editSecurity.id?(e.isDetailPersonal=!0,e.isDetailEnterprise=!1,e.isCapital=!1,this.Encryption.editEncryption=this.ST.editSecurity.units[0],e.currentWlan.authPort="",e.currentWlan.acctPort=""):"02"==this.ST.editSecurity.id&&(e.isDetailPersonal=!1,e.isDetailEnterprise=!0,e.isCapital=!1,e.isRedisShow=!1,e.redisSwitch.isSwitch=!1,this.Encryption.editEncryption=this.ST.editSecurity.units[0],e.currentWlan.authPort=1812,e.currentWlan.acctPort=1813)},e.newCurrentWlan={},e.editWlan=function(){if(e.oldWlan.ssid!=e.currentWlan.ssid&&e.isWlanExist(e.currentWlan.ssid,e.wlanList))return void s.info(t.instant("wlanAlreadyExist1")+e.currentWlan.ssid+t.instant("wlanAlreadyExist2"),"");e.band.twoG&&e.band.fiveG?e.currentWlan.band="2G,5G":e.band.twoG?e.currentWlan.band="2G":e.currentWlan.band="5G",
e.currentWlan.securityType=this.ST.editSecurity.name,e.securityTypeArray[0].name!==e.currentWlan.securityType&&(e.currentWlan.encryption=this.Encryption.editEncryption.value),e.oldWlan.ssid!=e.currentWlan.ssid&&(e.newCurrentWlan.ssid=e.currentWlan.ssid),e.oldWlan.enable!=e.currentWlan.enable&&(e.newCurrentWlan.enable=e.currentWlan.enable),e.oldWlan.hidden!=e.currentWlan.hidden&&(e.newCurrentWlan.hidden=e.currentWlan.hidden),e.oldWlan.maxClients!=e.currentWlan.maxClients&&(e.newCurrentWlan.maxClients=e.currentWlan.maxClients),e.oldWlan.probeThreshold!=e.currentWlan.probeThreshold&&(e.newCurrentWlan.probeThreshold=e.currentWlan.probeThreshold),e.oldWlan.vlanId!=e.currentWlan.vlanId&&(e.newCurrentWlan.vlanId=e.currentWlan.vlanId),e.oldWlan.upstreamLimit!=e.currentWlan.upstreamLimit&&(e.newCurrentWlan.upstreamLimit=e.currentWlan.upstreamLimit),e.oldWlan.downstreamLimit!=e.currentWlan.downstreamLimit&&(e.newCurrentWlan.downstreamLimit=e.currentWlan.downstreamLimit),e.oldWlan.securityType.toUpperCase()!=e.currentWlan.securityType.toUpperCase()&&(e.newCurrentWlan.securityType=e.currentWlan.securityType),e.oldWlan.encryption!=e.currentWlan.encryption&&(e.newCurrentWlan.encryption=e.currentWlan.encryption),"Open"==e.currentWlan.securityType?(e.newCurrentWlan.key="",e.newCurrentWlan.authServer="",e.newCurrentWlan.authPort="",e.newCurrentWlan.authSecret="",e.newCurrentWlan.acctServer="",e.newCurrentWlan.acctPort="",e.newCurrentWlan.acctSecret="",e.oldWlan.captivePortal!=e.currentWlan.captivePortal&&(e.newCurrentWlan.captivePortal=e.currentWlan.captivePortal),e.oldWlan.fast&&(e.newCurrentWlan.fast=0),e.oldWlan.okc&&(e.newCurrentWlan.okc=0)):"Personal"==e.currentWlan.securityType?(e.oldWlan.key!=e.currentWlan.key&&(e.newCurrentWlan.key=o.encoder(e.currentWlan.key)),e.oldWlan.fast!=e.currentWlan.fast&&(e.newCurrentWlan.fast=e.currentWlan.fast),"Yes"==e.oldWlan.captivePortal&&(e.newCurrentWlan.captivePortal="No"),e.newCurrentWlan.authServer="",e.newCurrentWlan.authPort="",e.newCurrentWlan.authSecret="",e.newCurrentWlan.acctServer="",e.newCurrentWlan.acctPort="",e.newCurrentWlan.acctSecret="",e.newCurrentWlan.keyConfirm=o.encoder(e.currentWlan.keyConfirm)):"Enterprise"==e.currentWlan.securityType&&(e.newCurrentWlan.key="",e.oldWlan.authServer!=e.currentWlan.authServer&&(e.newCurrentWlan.authServer=e.currentWlan.authServer),""==e.oldWlan.authPort&&(e.newCurrentWlan.authPort=1812),e.oldWlan.authPort!=e.currentWlan.authPort&&(e.newCurrentWlan.authPort=e.currentWlan.authPort),e.oldWlan.authSecret!=e.currentWlan.authSecret&&(e.newCurrentWlan.authSecret=o.encoder(e.currentWlan.authSecret)),e.oldWlan.acctServer!=e.currentWlan.acctServer&&(e.newCurrentWlan.acctServer=e.currentWlan.acctServer),e.oldWlan.acctSecret!=e.currentWlan.acctSecret&&(e.newCurrentWlan.acctSecret=o.encoder(e.currentWlan.acctSecret)),"Yes"==e.oldWlan.captivePortal&&(e.newCurrentWlan.captivePortal="No"),e.oldWlan.fast!=e.currentWlan.fast&&(e.currentWlan.fast?e.newCurrentWlan.fast=1:e.newCurrentWlan.fast=0),e.oldWlan.okc!=e.currentWlan.okc&&(e.currentWlan.okc?e.newCurrentWlan.okc=1:e.newCurrentWlan.okc=0),e.redisSwitch.isSwitch?e.newCurrentWlan.acctPort=e.currentWlan.acctPort:(e.newCurrentWlan.acctServer="",e.newCurrentWlan.acctPort="",e.newCurrentWlan.acctSecret=""));var n=JSON.stringify(e.newCurrentWlan),a="wlan_edit",i=e.oldssid;l.request("put","/wlan/"+e.urlEscape(e.oldssid),null,n,function(){e.initDivShow(),e.isDetail=!0,c(function(){e.query(e.newCurrentWlan.ssid),e.newCurrentWlan={}},2e3)},null,a,null,i)},e.viewWlan={},e.username=window.localStorage.username,e.isDetailRedius=!1,e.showDetail=function(n){e.viewWlan=angular.copy(n),"open"==e.viewWlan.securityType?(e.isPersonInfo=!1,e.isEnterpriseInfo=!1,e.isCaptivePortal=!0):"personal"==e.viewWlan.securityType?(e.viewWlan.key="**************","psk-mixed+tkip+aes"==n.encryption?e.viewWlan.encryption=e.securityTypeArray[1].units[0].name:"psk2+aes"==n.encryption&&(e.viewWlan.encryption=e.securityTypeArray[1].units[1].name),e.isPersonInfo=!0,e.isEnterpriseInfo=!1,e.isCaptivePortal=!1):"enterprise"==e.viewWlan.securityType&&(e.viewWlan.authSecret="**************",null==e.viewWlan.acctServer||""==e.viewWlan.acctServer?e.isDetailRedius=!1:(e.isDetailRedius=!0,e.viewWlan.acctSecret="**************"),"wpa-mixed+tkip+aes"==n.encryption?e.viewWlan.encryption=e.securityTypeArray[2].units[0].name:"wpa2+aes"==n.encryption&&(e.viewWlan.encryption=e.securityTypeArray[2].units[1].name),e.isPersonInfo=!1,e.isEnterpriseInfo=!0,e.isCaptivePortal=!1),e.viewWlan.fast?e.viewWlan.fast="Open":e.viewWlan.fast="Close",e.viewWlan.okc?e.viewWlan.okc="Open":e.viewWlan.okc="Close",e.isCreate=!1,e.isEdit=!1,e.isDetail=!0,e.isWmm=!1,e.isWmmEdit=!1},e.deleteWlan=function(n){var a="wlan_delete",i=n,s=t.instant("delWlan")+n+" ?";bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:s,callback:function(t){t&&l.request("delete","/wlan/"+e.urlEscape(n),null,null,function(){c(function(){e.query("")},2e3)},null,a,null,i)}})},e.queryWmmParam=function(n){i.get("/wlan/"+n+"/wmm/confParams",null,function(n){if(null!=n&&n.success){var t=n.result;e.uplink.dscpBg=t.bk_to_dscp,e.uplink.dscpBe=t.be_to_dscp,e.uplink.dscpVideo=t.vi_to_dscp,e.uplink.dscpVoice=t.vo_to_dscp,e.uplink.eightBg=t.bk_to_dot1p,e.uplink.eightBe=t.be_to_dot1p,e.uplink.eightVideo=t.vi_to_dot1p,e.uplink.eightVoice=t.vo_to_dot1p,e.downlink.dscpBg=t.dscp_to_bk,e.downlink.dscpBe=t.dscp_to_be,e.downlink.dscpVideo=t.dscp_to_vi,e.downlink.dscpVoice=t.dscp_to_vo,e.downlink.eightBg=t.dot1p_to_bk,e.downlink.eightBe=t.dot1p_to_be,e.downlink.eightVideo=t.dot1p_to_vi,e.downlink.eightVoice=t.dot1p_to_vo,e.wmmd.dscpSwitch=t.dscp_enable,e.wmmd.dot1pSwitch=t.dot1p_enable}},function(){})},e.showWmm=function(n){e.uplink={dscpBg:"",dscpBe:"",dscpVideo:"",dscpVoice:"",eightBg:"",eightBe:"",eightVideo:"",eightVoice:""},e.downlink={dscpBg:"",dscpBe:"",dscpVideo:"",dscpVoice:"",eightBg:"",eightBe:"",eightVideo:"",eightVoice:""},e.wmmd.dscpSwitch=!1,e.wmmd.dot1pSwitch=!1,e.wmmSsid=e.urlEscape(n),e.isCreate=!1,e.isEdit=!1,e.isDetail=!1,e.isWmm=!0,e.isWmmEdit=!1,e.queryWmmParam(e.wmmSsid)},e.showEditWmm=function(){e.isWmm=!1,e.isWmmEdit=!0},e.cancelWmm=function(){e.queryWmmParam(e.wmmSsid),e.isWmm=!0,e.isWmmEdit=!1},e.wmmswitchchange=function(n){var t=e.wmmSsid,a={switchType:n,switchValue:0},i="wmm_log_close";"dscp_enable"==n&&e.wmmd.dscpSwitch?(a.switchValue=1,i="wmm_log_open"):"dot1p_enable"==n&&e.wmmd.dot1pSwitch&&(a.switchValue=1,i="wmm_log_open"),i+="dscp_enable"==n?"_dscpswitch":"_dot1pwitch",l.request("put","/wlan/"+t+"/wmmSwitch",null,a,function(){e.isWmmEdit=!1,e.isWmm=!0,e.queryWmmParam(t)},null,i)},e.validFlag=!1,e.saveWmmInfo=function(){var n=e.wmmSsid,t={bk_to_dscp:"",be_to_dscp:"",vi_to_dscp:"",vo_to_dscp:"",bk_to_dot1p:"",be_to_dot1p:"",vi_to_dot1p:"",vo_to_dot1p:"",dscp_to_bk:"",dscp_to_be:"",dscp_to_vi:"",dscp_to_vo:"",dot1p_to_bk:"",dot1p_to_be:"",dot1p_to_vi:"",dot1p_to_vo:""};t.bk_to_dscp=e.uplink.dscpBg,t.be_to_dscp=e.uplink.dscpBe,t.vi_to_dscp=e.uplink.dscpVideo,t.vo_to_dscp=e.uplink.dscpVoice,t.bk_to_dot1p=e.uplink.eightBg,t.be_to_dot1p=e.uplink.eightBe,t.vi_to_dot1p=e.uplink.eightVideo,t.vo_to_dot1p=e.uplink.eightVoice,t.dscp_to_bk=e.downlink.dscpBg,t.dscp_to_be=e.downlink.dscpBe,t.dscp_to_vi=e.downlink.dscpVideo,t.dscp_to_vo=e.downlink.dscpVoice,t.dot1p_to_bk=e.downlink.eightBg,t.dot1p_to_be=e.downlink.eightBe,t.dot1p_to_vi=e.downlink.eightVideo,t.dot1p_to_vo=e.downlink.eightVoice;var a="wmm_log_params_modify";l.request("put","/wlan/"+n+"/wmm/confParams",null,t,function(){e.isWmmEdit=!1,e.isWmm=!0,e.queryWmmParam(n)},null,a)},e.uplinkdscp=function(n,a){var i=/^\d+$/g;i.test(n)?0>n||n>63?(e.validFlag=!0,e.uplinkdscp_info=t.instant("enterMustBe63"),u(!1,a)):(e.validFlag=!1,u(!0,a)):(e.validFlag=!0,e.uplinkdscp_info=t.instant("enterNotMatch"),u(!1,a))},e.uplinkEight=function(n,a){var i=/^\d+$/g;i.test(n)?0>n||n>7?(e.validFlag=!0,e.uplinkeight_info=t.instant("enterMustBe7"),p(!1,a)):(e.validFlag=!1,p(!0,a)):(e.validFlag=!0,e.uplinkeight_info=t.instant("enterNotMatch"),p(!1,a))},e.downlink_msgInfo="",e.downlink_eight_msgInfo="",e.downlinkdscp=function(n,a){var i=/^\d+(,\d+)*$/g;if(i.test(n)){var l=n.split(",");if(l.length>8||0==l.length)e.validFlag=!0,e.downlink_msgInfo=t.instant("enterMostEight"),d(!1,a);else{e.downlink_msgInfo=t.instant("enterMustBe63");for(var s=0;s<l.length;s++){var r=parseInt(l[s]);r>63||0>r?(e.validFlag=!0,d(!1,a)):(e.validFlag=!1,d(!0,a))}}}else e.validFlag=!0,e.downlink_msgInfo=t.instant("enterNotMatch"),d(!1,a)},e.downlinkEight=function(n,a){var i=/^\d+(,\d+)*$/g;if(i.test(n)){var l=n.split(",");if(l.length>8||0==l.length)e.downlink_eight_msgInfo=t.instant("enterMostEight"),e.validFlag=!0,m(!1,a);else{e.downlink_eight_msgInfo=t.instant("enterMustBe7");for(var s=0;s<l.length;s++){var r=parseInt(l[s]);r>7||0>r?(e.validFlag=!0,m(!1,a)):(e.validFlag=!1,m(!0,a))}}}else e.downlink_eight_msgInfo=t.instant("enterNotMatch"),e.validFlag=!0,m(!1,a)},e.wmmReset=function(){e.uplink={dscpBg:"10",dscpBe:"0",dscpVideo:"40",dscpVoice:"46",eightBg:"1",eightBe:"0",eightVideo:"4",eightVoice:"6"},e.downlink={dscpBg:"2,10",dscpBe:"0,18",dscpVideo:"26,34,40",dscpVoice:"46,48,56",eightBg:"1,2",eightBe:"0,3",eightVideo:"4,5",eightVoice:"6,7"},e.saveWmmInfo()},e.codeDetailStart=!1,e.codeDetailEnd="",e.isDetailFormat=!1,e.isDetailTrue=!0,e.changeWlanName=function(n){if(null!=n&&""!=n){var a=n.substring(0,1);"*"==a||"."==a||"\\"==a?(e.codeDetailStart=!0,e.codeDetailEnd=t.instant("canNotBegin"),e.isDetailFormat=!0,e.isDetailTrue=!0):(e.codeDetailStart=!1,e.isDetailFormat=!1,e.isDetailTrue=!1);var i=n.substring(n.length-1,n.length);e.codeDetailStart||"\\"!=i||(e.codeDetailEnd=t.instant("canNotEnd"),e.isDetailFormat=!0,e.isDetailTrue=!0);var l=/\s+/,s=l.test(n);console.log(s),s&&(e.codeDetailStart=!0,e.codeDetailEnd=t.instant("canNotBlanks"),e.isDetailFormat=!0,e.isDetailTrue=!0)}else e.isDetailFormat=!1,e.isDetailTrue=!0},e.codeEditStart=!1,e.codeEditEnd="",e.isEditFormat=!1,e.isEditTrue=!1,e.changeEditSSID=function(n){if(null!=n&&""!=n){var a=n.substring(0,1);"*"==a||"."==a||"\\"==a?(e.codeEditStart=!0,e.codeEditEnd=t.instant("canNotBegin"),e.isEditFormat=!0,e.isEditTrue=!0):(e.codeEditStart=!1,e.isEditFormat=!1,e.isEditTrue=!1);var i=n.substring(n.length-1,n.length);e.codeEditStart||"\\"!=i||(e.codeEditEnd=t.instant("canNotEnd"),e.isEditFormat=!0,e.isEditTrue=!0);var l=/\s+/,s=l.test(n);console.log(s),s&&(e.codeEditStart=!0,e.codeEditEnd=t.instant("canNotBlanks"),e.isEditFormat=!0,e.isEditTrue=!0)}else e.isEditFormat=!1,e.isEditTrue=!0},e.selecFormat=function(){e.formatSelected=this.formatSelected}}]),angular.module("wlan").controller("wlanConfContronller",["$scope","$modalInstance","$translate","InterService","batchSyncConfig","toastr","hanCrypto","wlans",function(e,n,t,a,i,l,s,r){function o(a){if(e.isWlanExist(e.wlanInfo.ssid,e.wlanList))l.info(t.instant("wlanAlreadyExist1")+e.wlanInfo.ssid+t.instant("wlanAlreadyExist2"),"");else{var r;if(a){var o="/advanceWlan";r="wlan_add_1"}else{var o="/wlan";r="wlan_add_2"}var c=e.wlanInfo.ssid,u=angular.copy(e.wlanInfo);u.key=s.encoder(u.key),u.keyConfirm=s.encoder(u.keyConfirm),u.authSecret=s.encoder(u.authSecret),u.acctSecret=s.encoder(u.acctSecret);var p=JSON.stringify(u);i.request("post",o,null,p,function(){n.close()},null,r,null,c)}}e.skin=a.skin,e.wlanList=r,e.wlanInfo={maxClients:64,probeThreshold:0,hidden:"No",enable:"Yes",captivePortal:"No",vlanId:0,upstreamLimit:0,downstreamLimit:0,securityType:"",encryption:"",authPort:1812,acctPort:1813},e.isWlan=!0,e.isAdvanceWlan=!1,e.isPersonal=!0,e.isEnterprise=!1,e.isCapital=!1,e.InterService=a,e.disabledSecurity=!1,e.disabledEncryption=!1,e.securityTypeArray=[{id:"00",name:"Open",units:[]},{id:"01",name:"Personal",units:[{id:"0109",name:"Both(wpa &wpa2)",value:"psk-mixed+tkip+aes"},{id:"0107",name:"wpa2-personal",value:"psk2+aes"}]},{id:"02",name:"Enterprise",units:[{id:"0209",name:"Both(wpa &wpa2)",value:"wpa-mixed+tkip+aes"},{id:"0207",name:"wpa2-enterprise",value:"wpa2+aes"}]}],e.passphraseFormatArray=[{id:"1",name:"8-63 chars"},{id:"2",name:"64 Hexadecimal chars"}],e.selectedSecurity=e.securityTypeArray[1],e.selectedEncryption=e.selectedSecurity.units[0],e.formatSelected=e.passphraseFormatArray[0],e.band={twoG:!0,fiveG:!0},e.isTwoG=!0,e.countryCode=a.getCountryCode(),"CS"==e.countryCode&&(e.band={twoG:!1,fiveG:!0},e.isTwoG=!1),e.redisSwitch={isSwitch:!1},e.isRedisShow=!1,e.redisChange=function(n){n?(e.isRedisShow=!0,console.info("this is  "+n)):(e.isRedisShow=!1,console.info("this is  "+n))},e.saveWlanInfo=function(){if(e.band.twoG&&e.band.fiveG)e.wlanInfo.band="2G,5G";else if(e.band.twoG)e.wlanInfo.band="2G";else{if(!e.band.fiveG)return void l.info(t.instant("pleaseSelectedBand"),"");e.wlanInfo.band="5G"}e.wlanInfo.securityType=this.selectedSecurity.name,e.securityTypeArray[0].name!==e.wlanInfo.securityType&&(e.wlanInfo.encryption=this.selectedEncryption.value),e.redisSwitch.isSwitch||(e.wlanInfo.acctServer="",e.wlanInfo.acctPort="",e.wlanInfo.acctSecret=""),o(!1)},e.cancel=function(){n.close()},e.showSimple=function(){e.isWlan=!0,e.isAdvanceWlan=!1},e.showAdvance=function(){e.isWlan=!1,e.isAdvanceWlan=!0},e.changeSecurity=function(){"00"==this.selectedSecurity.id?(e.isPersonal=!1,e.isEnterprise=!1,e.isCapital=!0):"01"==this.selectedSecurity.id?(e.isPersonal=!0,e.isEnterprise=!1,e.isCapital=!1,this.selectedEncryption=this.selectedSecurity.units[0]):"02"==this.selectedSecurity.id&&(e.isPersonal=!1,e.isEnterprise=!0,e.isCapital=!1,e.isRedisShow=!1,e.redisSwitch.isSwitch=!1,this.selectedEncryption=this.selectedSecurity.units[0])},e.saveWlanAdvance=function(){if(e.band.twoG&&e.band.fiveG)e.wlanInfo.band="2G,5G";else if(e.band.twoG)e.wlanInfo.band="2G";else{if(!e.band.fiveG)return void l.info(t.instant("pleaseSelectedBand"),"");e.wlanInfo.band="5G"}e.wlanInfo.securityType=this.selectedSecurity.name,e.securityTypeArray[0].name!==e.wlanInfo.securityType&&(e.wlanInfo.encryption=this.selectedEncryption.value),e.redisSwitch.isSwitch||(e.wlanInfo.acctServer="",e.wlanInfo.acctPort="",e.wlanInfo.acctSecret=""),o(!0)},e.isWlanExist=function(e,n){for(var t=0;t<n.length;t++)if(e==n[t].ssid)return!0;return!1},e.codeStart=!1,e.codeEnd="",e.isFormat=!1,e.isTrue=!1,e.changeSSID=function(n){if(null!=n&&""!=n){var a=n.substring(0,1);"*"==a||"."==a||"\\"==a?(e.codeStart=!0,e.codeEnd=t.instant("canNotBegin"),e.isFormat=!0,e.isTrue=!0):(e.codeStart=!1,e.isFormat=!1,e.isTrue=!1);var i=n.substring(n.length-1,n.length);e.codeStart||"\\"!=i||(e.codeEnd=t.instant("canNotEnd"),e.isFormat=!0,e.isTrue=!0);var l=/\s+/,s=l.test(n);console.log(s),s&&(e.codeStart=!0,e.codeEnd=t.instant("canNotBlanks"),e.isFormat=!0,e.isTrue=!0)}else e.isFormat=!1,e.isTrue=!0},e.codeDetailStart=!1,e.codeDetailEnd="",e.isDetailFormat=!1,e.isDetailTrue=!1,e.changeDetailSSID=function(n){if(null!=n&&""!=n){var a=n.substring(0,1);"*"==a||"."==a||"\\"==a?(e.codeDetailStart=!0,e.codeDetailEnd=t.instant("canNotBegin"),e.isDetailFormat=!0,e.isDetailTrue=!0):(e.codeDetailStart=!1,e.isDetailFormat=!1,e.isDetailTrue=!1);var i=n.substring(n.length-1,n.length);e.codeDetailStart||"\\"!=i||(e.codeDetailEnd=t.instant("canNotEnd"),e.isDetailFormat=!0,e.isDetailTrue=!0)}else e.isDetailFormat=!1,e.isDetailTrue=!0},e.selecFormat=function(){e.formatSelected=this.formatSelected}}]).directive("greenSlider",[function(){var e=function(e,n,t){$slider=jQuery(n);var a=t,i=function(e,n){n[e]&&(n[e]=parseInt(n[e]))};i("min",a),i("max",a),i("step",a),a=jQuery.extend({value:e[a.ngModel],change:function(n,a){if(t.ngModel&&a.value!=e[t.ngModel]){var i=t.ngModel+" = "+a.value;e.$apply(i),t.ngChange&&e.$eval(t.ngChange)}}},a),$slider.slider(a),a.ngModel&&e.$watch(a.ngModel,function(e){e!=$slider.slider("value")&&$slider.slider("value",e)})};return{restrict:"E",replace:!0,transclude:!1,template:"<div />",link:e}}]).filter("securityTypeFilter",[function(){var e=function(e){switch(e){case 10:return"open";case 20:return"WPA-2Personal";case 30:return"WPA-Personal(Both TKIP and AES Encryption)";case 40:return"WPA-Personal(TKIP Encryption only)";case 50:return"WPA-Personal(AES Encryption only)";case 60:return"Static WEP";case 70:return"WPA-2Enterprise";case 80:return"WPA Enterprise"}};return e}]),angular.module("monitor",[]).factory("monitorfactory",["$timeout",function(e){var n=function(e,n,t,a){null!=a&&"undefined"!=a||(a=10),nv.addGraph(function(){for(var i=[],l=0;l<e.length;++l){var s=e[l].values,r=s.length;r>60&&s.shift();for(var o=0;o<s.length;++o)s[o].x=new Date(s[o].x),i.push(s[o].y)}var c=Math.max.apply(null,i);("undefined"==c||a>c)&&(c=a);var u=[0];u.push(c);var p=nv.models.lineChart().x(function(e){return e.x}).y(function(e){return e.y}).color(d3.scale.category10().range()).useInteractiveGuideline(!0);return p.margin({left:75}),p.xAxis.axisLabel(t).tickFormat(function(e){return d3.time.format("%X")(new Date(e))+"    "}),p.yAxis.showMaxMin(!0).tickFormat(function(e){return d3.format(".1")(e)}),p.yDomain(u),p.legend.updateState(!1),d3.select(n).datum(e).transition().duration(500).call(p),nv.utils.windowResize(p.update),p})},t=function(e,n,t){nv.addGraph(function(){var a=nv.models.discreteBarChart().x(function(e){return e.label}).y(function(e){return e.value}).color(d3.scale.category10().range()).tooltips(!1).showValues(!0).valueFormat(d3.format(".1"));a.margin({left:75}),a.xAxis.axisLabel(t).labelOffsetMark(!0),a.yAxis.showMaxMin(!0).tickFormat(function(e){return d3.format(".1")(e)});for(var i=[],l=e[0].values,s=0;s<l.length;++s){var r=l[s].value;i.push(r)}var o=Math.max.apply(null,i);("undefined"==o||10>o)&&(o=10);var c=[0];return c.push(o),a.yDomain(c),d3.select(n).datum(e).transition().duration(500).call(a),nv.utils.windowResize(a.update),a})};return{drowLineChart:n,drowDiscreteBarChart:t}}]).service("monitorService",["$filter","batchSyncConfig","authentifiedRequest","monitorfactory","clientService","$translate",function(e,n,t,a,i,l){vm=this,vm.obser="",vm.ap_ip="",vm.ap_mac="",vm.wlan_mac="",vm.client_mac="",vm.data_throughput=[],vm.data_cpuAndMem=[],vm.data_client=[],vm.data_rouge_apAndClient=[],vm.data_client_speed=[],vm.data_client_signal=[],vm.dataInit=function(){var n=new Date;n.setSeconds(n.getSeconds()-10);var t=e("date")(n,"yyyy/MM/dd HH:mm:ss");vm.data_throughput=[{key:l.instant("MonitorRX"),values:[{x:t,y:0}]},{key:l.instant("MonitorTX"),values:[{x:t,y:0}]}],vm.data_cpuAndMem=[{key:l.instant("Monitorcpu"),values:[{x:t,y:0}]},{key:l.instant("Monitormem"),values:[{x:t,y:0}]}],vm.data_client=[{key:l.instant("MonitorSmallClient"),values:[{x:t,y:0}]}],vm.data_rouge_apAndClient=[{key:l.instant("MonitorRouge"),values:[{x:t,y:0}]},{key:l.instant("MonitorInter"),values:[{x:t,y:0}]}],vm.data_client_speed=[{key:l.instant("MonitorRX"),values:[{x:t,y:0}]},{key:l.instant("MonitorTX"),values:[{x:t,y:0}]}],vm.data_client_signal=[{key:l.instant("MonitorSmallRSSI"),values:[{x:t,y:0}]}],vm.data_client_band=[{key:l.instant("MonitorBarChar"),values:[{label:"2.4GHz",value:0},{label:"5GHz",value:0}]}],vm.data_client_health=[{key:l.instant("MonitorBarChar"),values:[{label:l.instant("MonitorBest"),value:0},{label:l.instant("MonitorGood"),value:0},{label:l.instant("MonitorFair"),value:0}]}]},vm.drowClusterCpuAndMemLineChart=function(t){n.getAll("/monitor/cpuAndMemUsage",null,function(n){var i=n.length;if(0!=i){var s=n,r=e("date")(new Date,"yyyy/MM/dd HH:mm:ss"),o=0,c=0;angular.forEach(s,function(e){o+=parseInt(e.cpu),c+=parseInt(e.mem)}),o=Math.floor(o/i),c=Math.floor(c/i);var u=vm.data_cpuAndMem[0].values,p=new Array;p.x=r,p.y=o,u.push(p);var d=vm.data_cpuAndMem[1].values,m=new Array;m.x=r,m.y=c,d.push(m)}a.drowLineChart(vm.data_cpuAndMem,t,l.instant("MonitorCpu"),null)})},vm.drowSingleApCpuAndMemLineChart=function(n,i){var s=InterService.getProtocol()+"://",r=":"+InterService.getPort(),o=s+n+r+"/monitor/cpuAndMemUsage";t.request("get",o,null,null,15e3,function(n){if(null!=n&&n.success){var t=n.result,s=e("date")(new Date,"yyyy/MM/dd HH:mm:ss"),r=vm.data_cpuAndMem[0].values,o=new Array;o.x=s,o.y=t.cpu,r.push(o);var c=vm.data_cpuAndMem[1].values,u=new Array;u.x=s,u.y=t.mem,c.push(u)}a.drowLineChart(vm.data_cpuAndMem,i,l.instant("MonitorCpu"),null)},function(){})},vm.drowSingleApRogueApLineChart=function(n,i){var s="http://",r=":8080",o=s+n+r+"/monitor/rogueApAndClient";t.request("get",o,null,null,15e3,function(n){if(null!=n&&n.success){var t=n.result,s=e("date")(new Date,"yyyy/MM/dd HH:mm:ss"),r=vm.data_rouge_apAndClient[0].values,o=new Array;o.x=s,o.y=t.rogue_ap_num,r.push(o);var c=vm.data_rouge_apAndClient[1].values,u=new Array;u.x=s,u.y=t.interfering_ap_num,c.push(u)}a.drowLineChart(vm.data_rouge_apAndClient,i,l.instant("MonitorRogueAP"),null)},function(){})},vm.drowThroughputLineChart=function(n,t){var s=i.getClientList(),r=0,o=0,c=function(e){r=(100*r+100*Number(e.UPRATE))/100,o=(100*o+100*Number(e.DOWNRATE))/100};angular.forEach(s,function(e){"cluster"==vm.obser?c(e):"wlan"==vm.obser&&e.WLAN==n?c(e):"ap"==vm.obser&&e.AP==n?c(e):"client"==vm.obser&&e.UserMAC==n&&c(e)});var u=e("date")(new Date,"yyyy/MM/dd HH:mm:ss"),p=vm.data_throughput[0].values,d=new Array;d.x=u,d.y=r.toFixed(2),p.push(d);var m=vm.data_throughput[1].values,f=new Array;f.x=u,f.y=o.toFixed(2),m.push(f),a.drowLineChart(vm.data_throughput,t,l.instant("MonitorThroughout"),1)},vm.drowClientsLineChart=function(n,t){var s=i.getClientList(),r=0;"cluster"==vm.obser?r=s.length:angular.forEach(s,function(e){"wlan"==vm.obser&&e.WLAN==n?r++:"ap"==vm.obser&&e.AP==n&&r++});var o=e("date")(new Date,"yyyy/MM/dd HH:mm:ss"),c=vm.data_client[0].values,u=new Array;u.x=o,u.y=r,c.push(u),a.drowLineChart(vm.data_client,t,l.instant("MonitorClient"),null)},vm.drowSpeedLineChart=function(n,t){var s=i.getClientList(),r=0,o=0;angular.forEach(s,function(e){"client"==vm.obser&&e.UserMAC==n&&(r=Number(e.RXRATE),o=Number(e.TXRATE))});var c=e("date")(new Date,"yyyy/MM/dd HH:mm:ss"),u=vm.data_client_speed[0].values,p=new Array;p.x=c,p.y=r,u.push(p);var d=vm.data_client_speed[1].values,m=new Array;m.x=c,m.y=o,d.push(m),a.drowLineChart(vm.data_client_speed,t,l.instant("MonitorPHY"),null)},vm.drowRSSILineChart=function(n,t){var s=i.getClientList(),r=0;angular.forEach(s,function(e){"client"==vm.obser&&e.UserMAC==n&&(r=e.RSSI)});var o=e("date")(new Date,"yyyy/MM/dd HH:mm:ss"),c=vm.data_client_signal[0].values,u=new Array;u.x=o,u.y=r,c.push(u),a.drowLineChart(vm.data_client_signal,t,l.instant("MonitorRSSI"),null)},vm.drowClientBandBarChart=function(e,n){var t=i.getClientList(),s=0,r=0,o=function(e){"2.4ghz"==e?s+=1:"5ghz"==e&&(r+=1)};angular.forEach(t,function(e){var t=e.FREQ.toLowerCase();("cluster"==vm.obser||"wlan"==vm.obser&&e.WLAN==n||"ap"==vm.obser&&e.AP==n)&&o(t)});var c=vm.data_client_band[0].values,u=c[0];u.value=s;var p=c[1];p.value=r,a.drowDiscreteBarChart(vm.data_client_band,e,l.instant("MonitorClientBand"))},vm.drowClientHealthBarChart=function(e,n){var t=i.getClientList(),s=0,r=0,o=0,c=function(e){-75>e?o+=1:e>-60?s+=1:r+=1};angular.forEach(t,function(e){var t=parseInt(e.RSSI)-95;("cluster"==vm.obser||"wlan"==vm.obser&&e.WLAN==n||"ap"==vm.obser&&e.AP==n)&&c(t)});var u=vm.data_client_health[0].values,p=u[0];p.value=s;var d=u[1];d.value=r;var m=u[2];m.value=o,a.drowDiscreteBarChart(vm.data_client_health,e,l.instant("MonitorClientHealth"))},vm.updateChartview=function(){"wlan"==vm.obser?(vm.drowThroughputLineChart(vm.wlan_ssid,"#cluster_chart5 svg"),vm.drowClientsLineChart(vm.wlan_ssid,"#cluster_chart6 svg"),vm.drowClientBandBarChart("#cluster_chart7 svg",vm.wlan_ssid),vm.drowClientHealthBarChart("#cluster_chart8 svg",vm.wlan_ssid)):"client"==vm.obser?(vm.drowThroughputLineChart(vm.client_mac,"#cluster_chart5 svg"),vm.drowRSSILineChart(vm.client_mac,"#cluster_chart6 svg"),vm.drowSpeedLineChart(vm.client_mac,"#cluster_chart7 svg")):"ap"==vm.obser?(vm.drowThroughputLineChart(vm.ap_mac,"#cluster_chart5 svg"),vm.drowClientsLineChart(vm.ap_mac,"#cluster_chart6 svg"),vm.drowClientBandBarChart("#cluster_chart7 svg",vm.ap_mac),vm.drowClientHealthBarChart("#cluster_chart8 svg",vm.ap_mac)):"cluster"==vm.obser&&(vm.drowThroughputLineChart(null,"#cluster_chart5 svg"),vm.drowClientsLineChart(null,"#cluster_chart6 svg"),vm.drowClientBandBarChart("#cluster_chart7 svg",null),vm.drowClientHealthBarChart("#cluster_chart8 svg",null))},vm.changeObser=function(e,n,t){d3.select("#cluster_chart5 svg").remove(),d3.select("#cluster_chart5").append("svg"),d3.select("#cluster_chart6 svg").remove(),d3.select("#cluster_chart6").append("svg"),d3.select("#cluster_chart7 svg").remove(),d3.select("#cluster_chart7").append("svg"),d3.select("#cluster_chart8 svg").remove(),d3.select("#cluster_chart8").append("svg"),d3.select("#viewer_title").text(t),vm.wlan_ssid="",vm.ap_ip="",vm.ap_mac="",vm.client_mac="",vm.dataInit(),vm.obser=e,"wlan"==vm.obser?vm.wlan_ssid=n:"client"==vm.obser?vm.client_mac=n:"ap"==vm.obser?(vm.ap_ip=n.ip,vm.ap_mac=n.mac):"cluster"==vm.obser,vm.updateChartview()}}]).controller("monitorController",[function(){}]),angular.module("main",["ui.bootstrap","ui.router","pascalprecht.translate","ngCookies","toastr","nvd3ChartDirectives","toggle-switch","angularFileUpload","wlan","module.ap.apinfo","module.wireless.rfManagement","module.wireless.rogueAp","module.wireless.others","system","module.terminal.acl","module.terminal.authentication","module.terminal.access","module.client","common","monitor"]).config(["toastrConfig",function(e){angular.extend(e,{allowHtml:!0,closeButton:!0,closeHtml:"<button>&times;</button>",containerId:"toast-container",extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},messageClass:"toast-message",positionClass:"toast-top-right",preventOpenDuplicates:!1,tapToDismiss:!1,timeOut:6e3,titleClass:"toast-title",toastClass:"toast"})}]).config(["$httpProvider",function(e){e.interceptors.push(function(){return{responseError:function(e){return 403==e.status,e}}})}]).factory("authentifiedRequest",["$http",function(e){var n=function(n,t,a,i,l,s,r){e({method:n,url:t,params:a,data:i,timeout:l,headers:{"Content-Type":"application/json",Authorization:"sessionName "+window.localStorage.sessionId}}).success(s).error(r)};return{get:function(e,t,a,i){n("get",e,t,null,15e3,a,i)},put:function(e,t,a,i,l){n("put",e,t,a,15e3,i,l)},post:function(e,t,a,i,l){n("post",e,t,a,15e3,i,l)},"delete":function(e,t,a,i){n("delete",e,t,data,15e3,a,i)},request:n}}]).factory("task",["$http","$q","authentifiedRequest","InterService",function(e,n,t,a){function i(e,n,t,a,i,l,s,r,o){this.mac=e,this.ip=n,this.method=t,this.uri=a,this.params=i,this.data=l,this.defer=s,this.onCompletelistener=r,this.timeout=o}function l(e,t,a,l,s,r,o,c){var u=new i(e,t,a.toLowerCase(),l,s,r,n.defer(),o,c);return u}return i.prototype.clone=function(){return l(this.mac,this.ip,this.method,this.uri,this.params,this.data,this.onCompletelistener,this.timeout)},i.prototype.execute=function(e){e=e||1;var i=this,l=a.getProtocol()+"://",s=":"+a.getPort(),r=l+i.ip+s+i.uri,o=function(e,n){var t={mac:i.mac,ip:i.ip,success:!1,msg:"",result:[]};null==e||""==e?(t.success=!1,t.msg="log_backendServer_error"):(e.hasOwnProperty("success")&&(t.success=e.success),e.hasOwnProperty("msg")&&(t.msg=e.msg),e.hasOwnProperty("result")&&(t.result=e.result)),i.defer.resolve(t)},c=function(e,n){var t={mac:i.mac,ip:i.ip,success:!1,msg:"log_backendServer_error"};i.defer.reject(t)},u=15e3;return null!=i.timeout&&(u=i.timeout),t.request(i.method,r,i.params,i.data,u,o,c),i.defer.promise.then(function(e){i.onCompletelistener(e)},function(t){return 3>e?(e++,i.clone().execute(e)):(i.onCompletelistener(t),void n.reject(t))})},{create:l}}]).factory("batchSyncConfig",["$translate","$q","lockScreen","task","toastr","InterService","operationLog",function(e,n,t,a,i,l,s){var r=function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=function(n){var t=0,a=0,l=e.instant("log_apNumber_success")+":",s=e.instant("log_apNumber_fault")+":",r="";angular.forEach(n,function(n){n.success?t++:(a++,r=r+"<p>IP:"+n.ip+"&nbsp;"+e.instant("log_RSN")+":"+e.instant(n.msg)+"</p>")}),l="<p>"+l+t+"</p>",s="<p>"+s+a+"</p>"+r;var o=e.instant("log_operateResult")+":";i.info(l+s,o)},c=function(e,n,t){var a=new Array;angular.forEach(n,function(e){var n="module_operate_failure";e.success&&(n="module_operate_success");var t={ip:e.ip,success:n,msg:e.msg};a.push(t)}),s.setLog(e,a,t)};return{request:function(s,r,u,p,d,m,f,g,h){function _(e){C.push(e)}var C=[];t.lock(g);var v=[];v=null==m?l.getCanConfigAps():m;var w=[];if(angular.forEach(v,function(e){var n=a.create(e.mac,e.ip,s,r,u,p,_,g);w.push(n.execute())}),0==w.length){t.unlock();var S=e.instant("log_noRunningAp_fault");return i.error(S),void(null!=d&&d())}n.all(w).then(function(e){t.unlock(),o(C),null!=f&&""!=f&&c(f,C,h),null!=d&&d()})},getAll:function(e,t,i,s){function o(e){e.success&&(r(e.result)?Array.prototype.push.apply(c,e.result):c.push(e.result))}var c=[],u=l.getApListInfo(),p=[];return angular.forEach(u,function(n){if(3==n.state){var i=a.create(n.mac,n.ip,"get",e,t,null,o,s);p.push(i.execute())}}),0==p.length?null!=i?i(c):void 0:void n.all(p).then(function(e){null!=i&&i(c)})},putAll:function(e,i,s,o){function c(e){e.success&&(r(e.result)?Array.prototype.push.apply(u,e.result):u.push(e.result))}var u=[];t.lock(o);var p=l.getApListInfo(),d=[];return angular.forEach(p,function(n){if(3==n.state){var t=a.create(n.mac,n.ip,"put",e,null,i,c,o);d.push(t.execute())}}),0==d.length?null!=s?s(u):void 0:void n.all(d).then(function(e){null!=s&&s(u)})}}}]).factory("lockScreen",["$timeout","$rootScope",function(e,n){var t=null,a=function(a){t&&e.cancel(t),t=e(function(){n.loading=!1},a)},i=function(){a(1e3)},l=function(e){n.loading=!0,a(null==e?15e3:e)};return{lock:l,unlock:i}}]).service("hanCrypto",[function(){var e=this;e.encoder=function(e){return null==e||""==e?e:BASE64.encoder(e)},e.decoder=function(e){if(null==e||""==e)return e;for(var n=BASE64.decoder(e),t="",a=0,i=n.length;i>a;++a)t+=String.fromCharCode(n[a]);return t}}]).factory("operationLog",[function(){var e=new Array,n=function(){return e},t=function(n,t,a){var i=new Date,l={logname:"",loginfo:"",datetime:"",logtemp:""};l.logname=n,l.loginfo=t,l.logtemp=a,l.datetime=i,10==e.length&&e.shift(),e.push(l)},a=function(n){e=new Array};return{getLogs:n,setLog:t,cleanLogs:a}}]).factory("singleModal",["$modal",function(e){var n=this;return n.modal=null,n.draggable=function(){$(".modal-content").draggable({handle:".modal-header",cursor:"move",refreshPositions:!1})},{open:function(t,a,i){return null!=n.modal?null:(n.modal=e.open(t),n.modal.result.then(function(e){n.modal=null,null!=a&&a(e)},function(e){n.modal=null,null!=i&&i(e)}),n.modal.opened.then(function(){setTimeout(n.draggable,3e3)}),n.modal)}}}]).service("InterService",["authentifiedRequest","$cookieStore","clientService","$translate",function(e,n,t,a){var i=this;i.aplistinfo=[],i.countryCode="",i.PVCinfo="",i.countryCodeInfo="",i.port="",i.protocol="",i.getPort=function(){return i.port},i.setPort=function(e){i.port=e},i.getProtocol=function(){return i.protocol},i.setProtocol=function(e){i.protocol=e},i.getCountryCodeInfo=function(){return i.countryCodeInfo},i.setCountryCodeInfo=function(e){i.countryCodeInfo=e},i.setCountryCode=function(e){i.countryCode=e},i.getCountryCode=function(){return i.countryCode},i.getPVCinfo=function(e){return i.PVCinfo},i.setPVCinfo=function(e){i.PVCinfo=e},i.getApListInfo=function(){return i.aplistinfo},i.getCanConfigAps=function(){var e=i.aplistinfo,n=[];return angular.forEach(e,function(e){3!=e.state&&2!=e.state||n.push(e)}),n},i.setApListInfo=function(e){i.aplistinfo=e},i.skin={isPurple:!1,isBlue:!0,imageUrl:"assets/images/blue.png",isSelectSkin:!1},i.getSkin=function(){null==n.get("skin")||"blue"==n.get("skin")?(i.skin.isPurple=!1,i.skin.isBlue=!0,i.skin.imageUrl="assets/images/blue.png"):"purple"==n.get("skin")&&(i.skin.isPurple=!0,i.skin.isBlue=!1,i.skin.imageUrl="assets/images/purple.png")},i.changeSelectedBlueToPurple=function(){var e=$("#system_title_bg");
e.hasClass("unfoldedlv1menublue")&&(e.removeClass("unfoldedlv1menublue").addClass("unfoldedlv1menupurple"),$("#sys_left_iconbg").removeClass("selected_icon_blue").addClass("selected_icon_purple"),$("#sys_right_iconbg").removeClass("selected_icon_blue").addClass("selected_icon_purple"));var n=$("#wireless_title_bg");n.hasClass("unfoldedlv1menublue")&&(n.removeClass("unfoldedlv1menublue").addClass("unfoldedlv1menupurple"),$("#wire_left_iconbg").removeClass("selected_icon_blue").addClass("selected_icon_purple"),$("#wire_right_iconbg").removeClass("selected_icon_blue").addClass("selected_icon_purple"));var t=$("#access_title_bg");t.hasClass("unfoldedlv1menublue")&&(t.removeClass("unfoldedlv1menublue").addClass("unfoldedlv1menupurple"),$("#acc_left_iconbg").removeClass("selected_icon_blue").addClass("selected_icon_purple"),$("#acc_right_iconbg").removeClass("selected_icon_blue").addClass("selected_icon_purple"))},i.changeSelectedPurpleToBlue=function(){var e=$("#system_title_bg");e.hasClass("unfoldedlv1menupurple")&&(e.removeClass("unfoldedlv1menupurple").addClass("unfoldedlv1menublue"),$("#sys_left_iconbg").removeClass("selected_icon_purple").addClass("selected_icon_blue"),$("#sys_right_iconbg").removeClass("selected_icon_purple").addClass("selected_icon_blue"));var n=$("#wireless_title_bg");n.hasClass("unfoldedlv1menupurple")&&(n.removeClass("unfoldedlv1menupurple").addClass("unfoldedlv1menublue"),$("#wire_left_iconbg").removeClass("selected_icon_purple").addClass("selected_icon_blue"),$("#wire_right_iconbg").removeClass("selected_icon_purple").addClass("selected_icon_blue"));var t=$("#access_title_bg");t.hasClass("unfoldedlv1menupurple")&&(t.removeClass("unfoldedlv1menupurple").addClass("unfoldedlv1menublue"),$("#acc_left_iconbg").removeClass("selected_icon_purple").addClass("selected_icon_blue"),$("#acc_right_iconbg").removeClass("selected_icon_purple").addClass("selected_icon_blue"))},i.setSkin=function(e){"purple"==e?(n.put("skin","purple"),i.skin.isSelectSkin=!1,i.skin.isPurple=!0,i.skin.isBlue=!1,i.skin.imageUrl="assets/images/purple.png",i.changeSelectedBlueToPurple()):"blue"==e&&(n.put("skin","blue"),i.skin.isSelectSkin=!1,i.skin.isPurple=!1,i.skin.isBlue=!0,i.skin.imageUrl="assets/images/blue.png",i.changeSelectedPurpleToBlue())},i.pattern={passwordInfo:"/^[^`=\"']{4,16}$/",ldu4To16:"/^[\\w]{4,16}$/",ldu1to10:"/^[\\w]{1,10}$/",ldu1to20:"/^[\\w]{1,20}$/",ldu1to25:"/^[\\w]{1,25}$/",ldu1to30:"/^[\\w]{1,30}$/",ldu1to32:"/^[\\w]{1,32}$/",ldu1to32Demo:"/^[^`=\"']{1,32}$/",ldu8to63:"/^[\\w]{8,63}$/",ldu8to63Demo:"/^[^`=\"']{8,63}$/",GroupName:"/^[\\w-]{1,25}$/",normalMAC:"/^([0-9a-fA-F]{2}:){5}([0-9a-fA-F]{2})$/",AuthMAC:"/^[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}(:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2})?$/",WhitelistMAC:"/^[0-9a-fA-F]{2}(:[0-9a-fA-F]{2}){0,5}$/",Hex64char:"/^[a-fA-F\\d]{64}$/",Hex64charDemo:"/^[a-fA-F\\d]{64}$/",IP:"/^(([1-9])|([1-9]\\d)|(1\\d\\d)|(2[0-4]\\d)|(25[0-5]))(\\.(\\d|([1-9]\\d)|1\\d\\d|2[0-4]\\d|25[0-5])){3}$/",IPMask:"/^(([1-9])|([1-9]\\d)|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d|([1-9]\\d)|1\\d\\d|2[0-4]\\d|25[0-5])){3}(/([1-9]|[1-2][0-9]|3[0-2]))?$/",LetterDigit4To8:"/^[a-zA-Z\\d]{4,8}$/",IPAndDomain:"/^((25[0-5])|(2[0-4]\\d)|(1\\d\\d)|([1-9]\\d)|([1-9]))(\\.((25[0-5])|(2[0-4]\\d)|(1\\d\\d)|([1-9]\\d)|\\d)){3}$|^([a-zA-Z0-9]([a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,6}$/",exceptBlank1To32:"/^[\\x00-\\xff]{1,32}$/",AuthPort:"/^(^[1-9]\\d{0,3}$)|(^[1-5]\\d{4}$)|(^6[0-4][\\d]{3}$)|(^65[0-4][\\d]{2}$)|(^655[0-2][\\d]|6553[0-5]$)$/",GroupID:"/^[1-9]\\d{0,3}$/",VLANID:"/^(^[0-9]$)|(^[1-9]\\d{1,2}$)|(^[1,-3]\\d{3}$)|(^40[0-8]\\d$)|(^409[0-4]$)$/",Stream:"/^(^[0-9]\\d{0,3}$)|(^[1-5]\\d{4}$)|(^6[0-4][\\d]{3}$)|(^65[0-4][\\d]{2}$)|(^655[0-2][\\d]|6553[0-6]$)$/",maxClients:"/^(^[1-9]\\d{0,1}$)|(^1[0,1]\\d$)|(^120$)$/",RSSIThreshold:"/^(^[0-9]$)|(^[1-9]\\d$)|100$/",FirstName:"/^[a-zA-Z-._\\s]{0,35}$/",LastName:"/^[a-zA-Z-._\\s]{0,35}$/",Phone:"/^(?!-)[\\d-]{0,20}$/",Mail:"/^\\w[-\\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+.)+[A-Za-z]{2,14}$/",Company:"/^[a-zA-Z-_.,&\\s]{0,64}$/",APName:"/^[\\w.:-]{1,20}$/"},i.errorTip={validIP:a.instant("validIP"),validIPOrDomain:a.instant("validIPOrDomain"),validMac:a.instant("validMac"),positiveInteger:a.instant("positiveInteger"),passNotSame:a.instant("passNotSame"),Hexchar64:a.instant("Hexchar64"),ldu:a.instant("ldu"),wlanNameTip:a.instant("wlanNameTip"),validFTP:a.instant("validFTP"),Hexchar64Demo:a.instant("Hexchar64Demo"),APName:a.instant("APName")},i.validIP=function(){return a.instant("validIP")},i.validIPOrDomain=function(){return a.instant("validIPOrDomain")},i.validMac=function(){return a.instant("validMac")},i.positiveInteger=function(){return a.instant("positiveInteger")},i.passNotSame=function(){return a.instant("passNotSame")},i.Hexchar64=function(){return a.instant("Hexchar64")},i.ldu=function(){return a.instant("ldu")},i.wlanNameTip=function(){return a.instant("wlanNameTip")},i.validFTP=function(){return a.instant("validFTP")},i.Hexchar64Demo=function(){return a.instant("Hexchar64Demo")},i.APName=function(){return a.instant("APName")},i.lduLengthRangeTip=function(e,n){return a.instant("Please enter")+e+a.instant("To")+n+a.instant("underline")},i.lduLengthRangeTipDemo=function(e,n){return a.instant("Please enter")+e+a.instant("To")+n+a.instant("notContain")},i.valueNotNull=function(e){return a.instant("The")+e+a.instant("notEmpty")},i.numRange=function(e,n,t){return a.instant("The")+e+a.instant("BETWEEN")+n+a.instant("AND")+t},i.valueLengthRange=function(e,n){return a.instant("Pbetween")+e+a.instant("To")+n},i.LetterDigitErrorTip=function(e,n){return a.instant("Please enter")+e+a.instant("To")+n+a.instant("letterDegits")}}]).service("clientService",[function(){var e=this;e.ClientList=[],e.getClientList=function(){return e.ClientList},e.setClientList=function(n){e.ClientList=[],e.ClientList=n},e.getWlanClient=function(n){var t=[];return""==n?e.ClientList:(angular.forEach(e.ClientList,function(e){e.WLAN==n&&t.push(e)}),t)},e.getApClient=function(n){var t=[];return""==n?e.ClientList:(angular.forEach(e.ClientList,function(e){e.AP==n&&t.push(e)}),t)}}]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"/static/data/",suffix:".json"}),e.preferredLanguage("en_US"),e.useCookieStorage()}]).directive("repeat",[function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,a){if(a){var i=n.inheritedData("$formController")[t.repeat],l=function(e){var n=e===i.$viewValue;return a.$setValidity("repeat",n),n?e:void 0};a.$parsers.push(l),a.$formatters.push(l),i.$parsers.push(function(e){return a.$setValidity("repeat",e===a.$viewValue),e})}}}}]).directive("integerport",[function(){return{restrict:"A",link:function(e,n,t){n.bind("paste",function(e){var n=e||window.event;n.charCode?n.preventDefault():n.returnValue=!1}),n.bind("keydown",function(e){var n=e||window.event;13==n.keyCode?n.keyCode=9:13==n.charCode&&(n.charCode=9)}),n.bind("keypress",function(e){var n=e||window.event;n.charCode&&(n.charCode<48||n.charCode>57)&&n.preventDefault(),(n.keyCode<48||n.keyCode>57)&&(n.returnValue=!1)})}}}]),angular.module("main").factory("permissions",[function(){var e=this;return e.permission="Permission_Guest",e.checkPermit=function(n){var t="!"===n[0];t&&(n=n.slice(1).trim());var a=e.permission===n;return!!(t&&!a||!t&&a)},{setPermissions:function(n){"Administrator"==n?e.permission="Permission_Admin":"Viewer"==n?e.permission="Permission_Viewer":"GuestOperator"==n&&(e.permission="Permission_Guest")},hasPermission:function(n){var t=n.split(" "),a=!1;for(i=0;i<t.length;i++)if(e.checkPermit(t[i])){a=!0;break}return a}}}]).directive("operationPermission",["permissions",function(e){return{restrict:"A",link:function(n,t,a){var i=a.operationPermission.trim(),l=e.hasPermission(i);l||t.attr("disabled","true")}}}]).directive("displayPermission",["permissions",function(e){var n=function(e){e&&e.remove&&e.remove()};return{restrict:"A",link:function(t,a,i){var l=i.displayPermission.trim(),s=e.hasPermission(l);s||(angular.forEach(a.children(),function(e){n(e)}),n(a))}}}]),angular.module("main").directive("highLight",[function(){return{restrict:"A",link:function(e,n,t){n.bind("click",function(){n.addClass("highLight"),n.siblings().removeClass("highLight")})}}}]).directive("monitorHighLight",[function(){return{restrict:"A",link:function(e,n,t){n.bind("click",function(){var e=t.monitorHighLight.trim();"ap"==e?(n.addClass("highLight"),n.parent().siblings().children().removeClass("highLight"),$("#wlan_view_table tr").removeClass("highLight"),$("#client_view_table tr").removeClass("highLight")):"wlan"==e?(n.addClass("highLight"),n.siblings().removeClass("highLight"),$("#ap_view_table tr").removeClass("highLight"),$("#client_view_table tr").removeClass("highLight")):"client"==e?(n.addClass("highLight"),n.siblings().removeClass("highLight"),$("#wlan_view_table tr").removeClass("highLight"),$("#ap_view_table tr").removeClass("highLight")):"cluster"==e&&($("#wlan_view_table tr").removeClass("highLight"),$("#ap_view_table tr").removeClass("highLight"),$("#client_view_table tr").removeClass("highLight"))})}}}]),angular.module("main").directive("disableSpace",[function(){return{restrict:"A",link:function(e,n,t){n.bind("keypress",function(){32==event.keyCode&&(event.returnValue=!1)})}}}]),angular.module("main").controller("logoutPromptCtrl",["$scope","$timeout","$modalInstance","authentifiedRequest","flag","$translate",function(e,n,t,a,i,l){e.flag=i,e.timeout;var s,r=15;e.initFunction=function(){3==i?(r=15,s=setInterval(e.changeLogout_15s_text,1e3)):(s=setInterval(e.changeLogout_5s_text,1e3),r=5),e.timeout=n(function(){e.logout()},1e3*r)},e.changeLogout_15s_text=function(){var e=$("#logout-15s");0!=r&&(r-=1);var n=l.instant("SessionTimeOutTips_4")+r+l.instant("SessionTimeOutTips_5");e.text(n)},e.changeLogout_5s_text=function(){var e=$("#logout-5s");0!=r&&(r-=1);var n=l.instant("loginAccountAgain")+r+l.instant("loginSeconds");e.text(n)},e.unlogout=function(){n.cancel(e.timeout),clearInterval(s),a.post("/authentication/unlogout",null,null,function(e){t.dismiss("cancel")})},e.logout=function(){n.cancel(e.timeout),clearInterval(s),window.location.href="/static/login.html"},e.initFunction()}]),angular.module("system").constant("ntpTimeZoneConstant",{utc:["International-Date-Line-West@UTC+12","Coordinated-Universal-Time-11@UTC+11","Aleutian-Islands@UTC+10","Hawaii@UTC+10","Marquesas-Islands@UTC+09:30","Alaska@UTC+09","Coordinated-Universal-Time-09@UTC+09","Pacific-Time@UTC+08","Baja-California@UTC+08","Coordinated-Universal-Time-08@UTC+08","Chihuahua,La-Paz,Mazatlan@UTC+07","Mountain-Time@UTC+07","Arizona@UTC+07","Easter-Island@UTC+06","Guadalajara,Mexico-City,Monterrey@UTC+06","Saskatchewan@UTC+06","Central-Time@UTC+06","Central-America@UTC+06","Bogota,Lima,Quito,Rio-Branco@UTC+05","Eastern-Time@UTC+05","Havana@UTC+05","Haiti@UTC+05","Chetumal@UTC+05","Indiana(East)@UTC+05","Atlantic-Time@UTC+04","Caracas@UTC+04","Cuiaba@UTC+04","Georgetown,La-Paz,Manaus,San-Juan@UTC+04","Santiago@UTC+04","Turks-and-Caicos-Islands@UTC+04","Asuncion@UTC+04","Newfoundland@UTC+03:30","Araguaina@UTC+03","Brasilia@UTC+03","Buenos-Aires@UTC+03","Greenland@UTC+03","Cayenne,Fortaleza@UTC+03","Montevideo@UTC+03","Salvador@UTC+03","Saint-Pierre-and-Miquelon-Islands@UTC+03","Coordinated-Universal-Time-02@UTC+02","Cape-Verde-Is@UTC+01","Azores@UTC+01","Coordinated-Universal-Time@UTC-00","Dublin@UTC-00","Edinburgh,London@UTC-00","Lisbon@UTC-00","Casablanca@UTC-00","Monrovia,Reykjavik@UTC-00","Amsterdam,Berlin,Bern,Rome,Stockholm,Vienna@UTC-01","Belgrade,Bratislava,Budapest,Ljubljana,Prague@UTC-01","Brussels,Copenhagen,Madrid,Paris@UTC-01","Sarajevo,Skopje,Warsaw,Zagreb@UTC-01","Windhoek@UTC-01","West-Central-Africa@UTC-01","Amman@UTC-02","Beirut@UTC-02","Damascus@UTC-02","Tripoli@UTC-02","Harare,Pretoria@UTC-02","Helsinki,Kyiv,Riga,Sofia,Tallinn,Vilnius@UTC-02","Kishinev@UTC-02","Kaliningrad@UTC-02","Gaza,Hebron@UTC-02","Cairo@UTC-02","Athens,Bucharest@UTC-02","Jerusalem@UTC-02","Istanbul@UTC-02","Baghdad@UTC-03","Kuwait,Riyadh@UTC-03","Minsk@UTC-03","Moscow,Saint-Petersburg,Volgograd@UTC-03","Nairobi@UTC-03","Tehran@UTC-03:30","Abu-Dhabi,Muscat@UTC-04","Astrakhan,Ulyanovsk@UTC-04","Yerevan@UTC-04","Baku@UTC-04","Tbilisi@UTC-04","Port-Louis@UTC-04","Izevsk,Samarra@UTC-04","Kabul@UTC-04:30","Ashkhabad,Tashkent@UTC-05","Ekaterinburg@UTC-05","Islamabad,Karachi@UTC-05","Chennai,Kolkata,Mumbai,New-Delhi@UTC-05:30","Sri-Jayawardenepura@UTC-05:30","Kathmandu@UTC-05:45","Astana@UTC-06","Dhaka@UTC-06","Novosibirsk@UTC-06","Yangon@UTC-06:30","Barnaul,Gorno-altaysk@UTC-07","Hovd@UTC-07","Krasnoyarsk@UTC-07","Bangkok,Hanoi,Jakarta@UTC-07","Tomsk@UTC-07","Beijing,Chongqing,HongKong,Urumqi@UTC-08","Kuala-Lumpur,Singapore@UTC-08","Perth@UTC-08","Taipei@UTC-08","Ulaanbaatar@UTC-08","Irkutsk@UTC-08","Pyongyang@UTC-08:30","Eucla@UTC-08:45","Chita@UTC-09","Osaka,Sapporo,Tokyo@UTC-09","Seoul@UTC-09","Yakutsk@UTC-09","Adelaide@UTC-09:30","Darwin@UTC-09:30","Brisbane@UTC-10","Vladivostok@UTC-11","Guam,Port-Moresby@UTC-10","Hobart@UTC-10","Canberra,Melbourne,Sydney@UTC-10","Lord-Howe-Island@UTC-10:30","Bougainville-Island@UTC-11","Magadan@UTC-11","Norfolk-Island@UTC-11","Chokurdakh@UTC-11","Sakhalin@UTC-11","Solomon-Is,New-Caledonia@UTC-11","Anadyr,Petropavlovsk@UTC-12","Auckland,Wellington@UTC-12","Fiji@UTC-12","Coordinated-Universal-Time+12@UTC-12","Chatham-Islands@UTC-12:45","Nukualofa@UTC-13","Samoa@UTC-13","Christmas-Island@UTC-14"]}).constant("ntpDateTimeConstant",{edt:[{name:"International-Date-Line-West@UTC+12",value:"",dst:""},{name:"Coordinated-Universal-Time-11@UTC+11",value:"",dst:""},{name:"Aleutian-Islands@UTC+10",value:"",dst:""},{name:"Hawaii@UTC+10",value:"",dst:""},{name:"Marquesas-Islands@UTC+09:30",value:"",dst:""},{name:"Alaska@UTC+09",value:"AKDT,M3.2.0/2,M11.1.0/2",dst:"AKDT"},{name:"Coordinated-Universal-Time-09@UTC+09",value:"",dst:""},{name:"Pacific-Time@UTC+08",value:"PDT,M3.2.0/2,M11.1.0/2",dst:"PDT "},{name:"Baja-California@UTC+08",value:"MDT,M4.1.0/2,M10.5.0/2",dst:"MDT"},{name:"Coordinated-Universal-Time-08@UTC+08",value:"",dst:""},{name:"Chihuahua,La-Paz,Mazatlan@UTC+07",value:"MDT,M4.1.0/2,M10.5.0/2",dst:"MDT"},{name:"Mountain-Time@UTC+07",value:"MDT,M3.2.0/2,M11.1.0/2",dst:"MDT"},{name:"Arizona@UTC+07",value:"",dst:""},{name:"Easter-Island@UTC+06",value:"",dst:""},{name:"Guadalajara,Mexico-City,Monterrey@UTC+06",value:"CDT,M4.1.0/2,M10.5.0/2",dst:"CDT"},{name:"Saskatchewan@UTC+06",value:"",dst:""},{name:"Central-Time@UTC+06",value:"CDT,M3.2.0/2,M11.1.0/2",dst:"CDT"},{name:"Central-America@UTC+06",value:"",dst:""},{name:"Bogota,Lima,Quito,Rio-Branco@UTC+05",value:"",dst:""},{name:"Eastern-Time@UTC+05",value:"EDT,M3.2.0/2,M11.1.0/2",dst:"EDT"},{name:"Havana@UTC+05",value:"",dst:""},{name:"Haiti@UTC+05",value:"",dst:""},{name:"Chetumal@UTC+05",value:"",dst:""},{name:"Indiana(East)@UTC+05",value:"EDT,M3.2.0/2,M11.1.0/2",dst:"EDT"},{name:"Atlantic-Time@UTC+04",value:"ADT,M3.2.0/2,M11.1.0/2",dst:"ADT"},{name:"Caracas@UTC+04",value:"",dst:""},{name:"Cuiaba@UTC+04",value:"AMST,M10.3.0/0,M2.3.0/0",dst:"AMST"},{name:"Georgetown,La-Paz,Manaus,San-Juan@UTC+04",value:"",dst:""},{name:"Santiago@UTC+04",value:"SAND,M10.2.6/23:59:00,M3.2.6/23:59:00",dst:"SAND"},{name:"Turks-and-Caicos-Islands@UTC+04",value:"",dst:""},{name:"Asuncion@UTC+04",value:"PYST,M10.3.0/0,M3.2.0/0",dst:"PYST"},{name:"Newfoundland@UTC+03:30",value:"NDT,M3.2.0/00:01:00,M11.1.0/00:01:00",dst:"NDT"},{name:"Araguaina@UTC+03",value:"",dst:""},{name:"Brasilia@UTC+03",value:"BRAD,M11.1.0/0,M2.5.0/0",dst:"BRAD"},{name:"Buenos-Aires@UTC+03",value:"ARST,M10.3.0/0,M3.3.0/0",dst:"ARST"},{name:"Greenland@UTC+03",value:"GRED,M3.4.6/22,M10.4.6/23",dst:"GRED"},{name:"Cayenne,Fortaleza@UTC+03",value:"",dst:""},{name:"Montevideo@UTC+03",value:"UYST,M10.1.0/2,M3.2.0/2",dst:"UYST"},{name:"Salvador@UTC+03",value:"BRST,M10.3.0/0,M2.3.0/0",dst:"BRST"},{name:"Saint-Pierre-and-Miquelon-Islands@UTC+03",value:"",dst:""},{name:"Coordinated-Universal-Time-02@UTC+02",value:"",dst:""},{name:"Cape-Verde-Is@UTC+01",value:"",dst:""},{name:"Azores@UTC+01",value:"AZOST,M3.5.0/0,M10.3.0/0",dst:"AZOST"},{name:"Coordinated-Universal-Time@UTC-00",value:"",dst:""},{name:"Dublin@UTC-00",value:"IST,M3.5.0/2,M10.5.0/2",dst:"IST"},{name:"Edinburgh,London@UTC-00",value:"BST,M3.5.0/2,M10.5.0/2",dst:"BST"},{name:"Lisbon@UTC-00",value:"WEST,M3.5.0/2,M10.5.0/2",dst:"WEST"},{name:"Casablanca@UTC-00",value:"",dst:""},{name:"Monrovia,Reykjavik@UTC-00",value:"",dst:""},{name:"Amsterdam,Berlin,Bern,Rome,Stockholm,Vienna@UTC-01",value:"CEST,M3.5.0/0,M10.5.0/3",dst:"CEST"},{name:"Belgrade,Bratislava,Budapest,Ljubljana,Prague@UTC-01",value:"CEST,M3.5.0/0,M10.5.0/3",dst:"CEST"},{name:"Brussels,Copenhagen,Madrid,Paris@UTC-01",value:"CEST,M3.5.0/0,M10.5.0/3",dst:"CEST"},{name:"Sarajevo,Skopje,Warsaw,Zagreb@UTC-01",value:"CEST,M3.5.0/0,M10.5.0/3",dst:"CEST"},{name:"Windhoek@UTC-01",value:"WAST,M9.1.0/0,M4.1.0/3",dst:"WAST"},{name:"West-Central-Africa@UTC-01",value:"",dst:""},{name:"Amman@UTC-02",value:"EEST,M3.5.4/0,M10.5.5/1",dst:"EEST"},{name:"Beirut@UTC-02",value:"EEST,M3.5.0/0,M10.5.0/0",dst:"EEST"},{name:"Damascus@UTC-02",value:"EEST,M3.5.0/0,M10.5.0/0",dst:"EEST"},{name:"Tripoli@UTC-02",value:"",dst:""},{name:"Harare,Pretoria@UTC-02",value:"",dst:""},{name:"Helsinki,Kyiv,Riga,Sofia,Tallinn,Vilnius@UTC-02",value:"EEST,M3.5.0/3,M10.5.0/4",dst:"EEST"},{name:"Kishinev@UTC-02",value:"",dst:""},{name:"Kaliningrad@UTC-02",value:"",dst:""},{name:"Gaza,Hebron@UTC-02",value:"",dst:""},{name:"Cairo@UTC-02",value:"",dst:""},{name:"Athens,Bucharest@UTC-02",value:"EEST,M3.5.0/0,M10.5.0/4",dst:"EEST"},{name:"Jerusalem@UTC-02",value:"IST,M3.5.5/2,M9.4.0/2",dst:"IST"},{name:"Istanbul@UTC-02",value:"EEST,M3.5.0/3,M10.5.0/4",dst:"EEST"},{name:"Baghdad@UTC-03",value:"",dst:""},{name:"Kuwait,Riyadh@UTC-03",value:"",dst:""},{name:"Minsk@UTC-03",value:"",dst:""},{name:"Moscow,Saint-Petersburg,Volgograd@UTC-03",value:"",dst:""},{name:"Nairobi@UTC-03",value:"",dst:""},{name:"Tehran@UTC-03:30",value:"",dst:""},{name:"Abu-Dhabi,Muscat@UTC-04",value:"",dst:""},{name:"Astrakhan,Ulyanovsk@UTC-04",value:"",dst:""},{name:"Yerevan@UTC-04",value:"",dst:""},{name:"Baku@UTC-04",value:"AZST,M3.5.0/4,M10.5.0/5",dst:"AZST"},{name:"Tbilisi@UTC-04",value:"",dst:""},{name:"Port-Louis@UTC-04",value:"",dst:""},{name:"Izevsk,Samarra@UTC-04",value:"",dst:""},{name:"Kabul@UTC-04:30",value:"",dst:""},{name:"Ashkhabad,Tashkent@UTC-05",value:"",dst:""},{name:"Ekaterinburg@UTC-05",value:"",dst:""},{name:"Islamabad,Karachi@UTC-05",value:"",dst:""},{name:"Chennai,Kolkata,Mumbai,New-Delhi@UTC-05:30",value:"",dst:""},{name:"Sri-Jayawardenepura@UTC-05:30",value:"",dst:""},{name:"Kathmandu@UTC-05:45",value:"",dst:""},{name:"Astana@UTC-06",value:"",dst:""},{name:"Dhaka@UTC-06",value:"",dst:""},{name:"Novosibirsk@UTC-06",value:"",dst:""},{name:"Yangon@UTC-06:30",value:"",dst:""},{name:"Barnaul,Gorno-altaysk@UTC-07",value:"",dst:""},{name:"Hovd@UTC-07",value:"",dst:""},{name:"Krasnoyarsk@UTC-07",value:"",dst:""},{name:"Bangkok,Hanoi,Jakarta@UTC-07",value:"",dst:""},{name:"Tomsk@UTC-07",value:""},{name:"Beijing,Chongqing,HongKong,Urumqi@UTC-08",value:"",dst:""},{name:"Kuala-Lumpur,Singapore@UTC-08",value:"",dst:""},{name:"Perth@UTC-08",value:"",dst:""},{name:"Taipei@UTC-08",value:"",dst:""},{name:"Ulaanbaatar@UTC-08",value:"",dst:""},{name:"Irkutsk@UTC-08",value:"",dst:""},{name:"Pyongyang@UTC-08:30",value:"",dst:""},{name:"Eucla@UTC-08:45",value:"",dst:""},{name:"Chita@UTC-09",value:"",dst:""},{name:"Osaka,Sapporo,Tokyo@UTC-09",value:"",dst:""},{name:"Seoul@UTC-09",value:"",dst:""},{name:"Yakutsk@UTC-09",value:"",dst:""},{name:"Adelaide@UTC-09:30",value:"CST,M10.1.0/2,M4.1.0/3",dst:"CST"},{name:"Darwin@UTC-09:30",value:"",dst:""},{name:"Brisbane@UTC-10",value:"",dst:""},{name:"Vladivostok@UTC-11",value:"",dst:""},{name:"Guam,Port-Moresby@UTC-10",value:"",dst:""},{name:"Hobart@UTC-10",value:"EST,M10.1.0/2,M4.1.0/3",dst:"EST"},{name:"Canberra,Melbourne,Sydney@UTC-10",value:"EST,M10.1.0/2,M4.1.0/3",dst:"EST"},{name:"Lord-Howe-Island@UTC-10:30",value:"",dst:""},{name:"Bougainville-Island@UTC-11",value:"",dst:""},{name:"Magadan@UTC-11",value:"",dst:""},{name:"Norfolk-Island@UTC-11",value:"",dst:""},{name:"Chokurdakh@UTC-11",value:"",dst:""},{name:"Sakhalin@UTC-11",value:"",dst:""},{name:"Solomon-Is,New-Caledonia@UTC-11",value:"",dst:""},{name:"Anadyr,Petropavlovsk@UTC-12",value:"",dst:""},{name:"Auckland,Wellington@UTC-12",value:"NZDT,M9.5.0/2,M4.1.0/3",dst:"NZDT"},{name:"Fiji@UTC-12",value:"FJST,M10.3.0/2,M1.4.0/3",dst:"FJST"},{name:"Coordinated-Universal-Time+12@UTC-12",value:"",dst:""},{name:"Chatham-Islands@UTC-12:45",value:"",dst:""},{name:"Nukualofa@UTC-13",value:"",dst:""},{name:"Samoa@UTC-13",value:"WST,M9.5.0/3,M4.1.0/4",dst:"WST"},{name:"Christmas-Island@UTC-14",value:"",dst:""}]}),angular.module("module.client",[]).filter("clientOwnerName",[function(){var e=function(e){return"ap"==e?"AP":"wlan"==e?"WLAN":"cluster"==e?"Group":""};return e}]).controller("ClientController",["$scope","batchSyncConfig","clientService","monitorService","singleModal","$translate",function(e,n,t,a,i,l){e.clientList=[],e.clientNum=0,e.divWidth="",e.flag="cluster",e.clientOwner="",e.currentName="",e.currentMac="",e.clientManagement.changeClient=function(n,a){"ap"==n?(e.flag="ap",a.hasOwnProperty("apname")?(e.clientOwner=a.apname,e.currentMac=a.mac,e.currentName=a.apname):e.clientOwner=a,e.clientList=t.getApClient(e.currentMac)):"wlan"==n?(e.flag="wlan",e.clientOwner=a,e.clientList=t.getWlanClient(a)):(e.flag="cluster",e.clientOwner=a,e.clientList=t.getClientList()),0<e.clientList.length?(e.clientNum=e.clientList.length,4<e.clientNum?e.divWidth="padding-right:17px;":e.divWidth=""):(e.clientNum=0,e.clientList=[],e.divWidth="")},e.clientManagement.query=function(a){n.getAll("/totalclientlist",null,function(n){0<n.length&&t.setClientList(n),e.clientManagement.changeClient(e.flag,e.clientOwner),a()})},e.clientManagement.query(e.clientCallback),e.openClientPageInit=function(){i.open({templateUrl:"client/client-detail.html",controller:"ClientDetailController",size:"lg",backdrop:!0},function(n){e.clientManagement.query(e.clientCallback)},function(n){e.clientManagement.query(e.clientCallback)})},e.showClientMonitor=function(e){var n=l.instant("ClusterClient")+e.UserMAC;a.changeObser("client",e.UserMAC,n)}}]),angular.module("module.client").controller("ClientDetailController",["$scope","$modalInstance","$translate","authentifiedRequest","InterService","batchSyncConfig","clientService","toastr",function(e,n,t,a,i,l,s,r){e.skin=i.skin,e.clientDetailGroupList=[],e.allClientGroupList=e.clientDetailGroupList,e.currentDetailTemp={Name:"",IP:"",UserMAC:"",WLAN:"",AP:"",APName:"",APInfo:"",Auth:"",FREQ:"",OnlineTime:"",SessionTime:"",RSSI:0,MODE:"",RXRATE:0,TXRATE:0,UPRATE:0,DOWNRATE:0,InputFlow:0,OutputFlow:0,TerminalType:"",FingerPrint:""},e.isShowDetails=!0,e.searchVisible=!1,e.search={target:""},e.showSearch=function(){e.searchVisible=!e.searchVisible},e.getCurrentClientDetail=function(n){e.currentDetailTemp=n},e.deleteuser=function(n){for(var t=e.clientDetailGroupList.length,a=0;t>a;a++)if(e.clientDetailGroupList[a].UserMAC==n.UserMAC){e.clientDetailGroupList.splice(a,1);break}},e.BlackList=[],e.getBlackList=function(){var n={};a.get("/getblacklist",n,function(n,t){200==t&&null!=n&&n.success&&(e.BlackList=n.result)},function(){})},e.getBlackList(),e.mac_compare=function(n,t,a){var i=n.length;if(console.log(n+t.Begin_MAC),(17==i||1>=a)&&n==t.Begin_MAC)return!0;if(35==i||2>=a)if(e.arr=n.split("-"),""!=t.End_MAC){if(t.Begin_MAC<=e.arr[0]&&t.End_MAC>=e.arr[0])return!0;if(t.Begin_MAC>=e.arr[0]&&t.End_MAC<=e.arr[1])return!0;if(t.Begin_MAC<=e.arr[1]&&t.End_MAC>=e.arr[1])return!0}else if(t.Begin_MAC>=e.arr[1]&&t.Begin_MAC<=e.arr[1])return!0;if(8==i||3>=a){var l=t.Begin_MAC.substr(0,8);if(n==l)return!0}return!1},e.maclistFilterDuplicateObject=function(n,t){var a=!1,i=t,l="",s=0;if(""==i.End_MAC)s=8==i.Begin_MAC.length?3:1,l=i.Begin_MAC;else{s=2;var r=i.Begin_MAC.substr(0,8),o=i.End_MAC.substr(0,8);if(r!=o||i.Begin_MAC>i.End_MAC)return!0;l=i.Begin_MAC+"-"+i.End_MAC}return $.each(n,function(n,t){var l=e.mac_compare(t.MAC,i,s);return 1==l?a=!0:void 0}),a},e.kickuser=function(n){var a=t.instant("kickOutUser1")+n.UserMAC+t.instant("kickOutUser2");bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:a,callback:function(a){if(a){if(e.BlackList.length>=256)r.info(t.instant("client_kick_user_1"),"");else{e.BlackListTemp={Begin_MAC:n.UserMAC,End_MAC:""};var i=e.maclistFilterDuplicateObject(e.BlackList,e.BlackListTemp);if(1!=i){var s="access_add_blacklist_3",o=JSON.stringify(e.BlackListTemp);return void l.request("put","/addBlacklist",null,o,function(){e.deleteuser(n),e.currentDetailTemp=e.clientDetailGroupList[0],e.currentDetailTemp||(e.isShowDetails=!1);var t=JSON.stringify(n);l.request("put","/kickuser",null,t,function(){},null,"client_kick_user_2")},null,s)}r.info(t.instant("access_add_blacklist_1"),"")}e.deleteuser(n),e.currentDetailTemp=e.clientDetailGroupList[0],e.currentDetailTemp||(e.isShowDetails=!1);var c=JSON.stringify(n);l.request("put","/kickuser",null,c,function(){},null,"client_kick_user_2")}}})},e.kickoffuser=function(n){var a=t.instant("kickOffUser")+n.UserMAC+" ?";bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:a,callback:function(t){if(t){e.deleteuser(n),e.currentDetailTemp=e.clientDetailGroupList[0],e.currentDetailTemp||(e.isShowDetails=!1);var a=JSON.stringify(n);l.request("put","/kickuser",null,a,function(){},null,"client_kick_user_2")}}})},e.selectRow=function(e){var n,t,a;n?(n.bgColor=a,a=e.bgColor,e.bgColor="#FFE9B3"):(a=e.bgColor,e.bgColor="#FFE9B3"),n=e,t=e.id},e.ok=function(){n.close()},e.cancel=function(){n.close()},e.init=function(){e.clientDetailGroupList=[],e.clientService=s,e.clientDetailGroupList=e.clientService.getClientList();for(var n=0;n<e.clientDetailGroupList.length;n++){var t=e.clientDetailGroupList[n].FingerPrint;t.indexOf("\\")>0&&(t=t.replace("\\"," "),e.clientDetailGroupList[n].FingerPrint=t)}e.allClientGroupList=e.clientDetailGroupList,e.currentDetailTemp=e.clientDetailGroupList[0],e.currentDetailTemp||(e.isShowDetails=!1)},e.searchClient=function(){if(e.newClientGroupList=[],e.search.target){for(var n,t,a,i=e.allClientGroupList.length,l=0;i>l;l++)n=!e.allClientGroupList[l].IP.indexOf(e.search.target),t=!e.allClientGroupList[l].UserMAC.toUpperCase().indexOf(e.search.target.toUpperCase()),a=!e.allClientGroupList[l].Name.toUpperCase().indexOf(e.search.target.toUpperCase()),(n||a||t)&&e.newClientGroupList.push(e.allClientGroupList[l]);e.clientDetailGroupList=e.newClientGroupList}else e.clientDetailGroupList=e.allClientGroupList},e.init()}]),angular.module("module.ap.apinfo",[]).service("APService",["authentifiedRequest","batchSyncConfig","InterService","clientService",function(e,n,t,a){var i=this;i.HttpGetApListInfo=function(n){var i=t.getPVCinfo(),l="";l=null==i||""==i?"/haps":t.getProtocol()+"://"+i+":"+t.getPort()+"/haps",e.get(l,null,function(e){if(null!=e&&e.success&&null!=e.result){for(var i=e.result.length;i>0;i--){0==e.result[i-1].state&&(e.result[i-1].state="1");var l=a.getApClient(e.result[i-1].mac);null!=l?e.result[i-1].clients=l.length:e.result[i-1].clients=0,e.result[i-1].hasOwnProperty("name")&&""!=e.result[i-1].name&&null!=e.result[i-1].name?e.result[i-1].apname=e.result[i-1].name:e.result[i-1].apname=e.result[i-1].mac,e.result[i-1].hasOwnProperty("version")||(e.result[i-1].version=" ")}t.setApListInfo(e.result),null!=n&&n()}},function(){})},i.HttpGetPvcInfo=function(){var n="/pvcinfo";e.get(n,null,function(e){null!=e&&e.success&&null!=e.result&&""!=e.result&&t.setPVCinfo(e.result)},function(){})}}]).controller("APController",["$scope","$rootScope","$translate","InterService","authentifiedRequest","clientService","monitorService","lockScreen","singleModal","operationLog","APService","toastr",function(e,n,t,a,i,l,s,r,o,c,u,p){function d(){e.aps.length>7?e.apsWidth="padding-right:17px":e.apsWidth=""}function m(){for(var n=0,a=0,i=0,l=0;l<e.aps.length;l++)switch(e.aps[l].state){case"1":a++;for(var s=!1,r=e.aps[l].mac,o=0;o<e.aps.length;o++)l!=o&&e.aps[l].ip==e.aps[o].ip&&(r=r+", "+e.aps[o].mac,s=!0);if(s){var c=t.instant("duplicate_ip_tip1")+r+t.instant("duplicate_ip_tip2")+e.aps[l].ip;p.warning(c,"")}break;case"2":case"3":n++;break;case"4":i++}for(var l=0;l<e.aps.length-1;l++)if(1==e.aps[l].state){var s=!1,r="";r=e.aps[l].mac;for(var o=0;o<e.aps.length;o++)l!=o&&e.aps[l].ip==e.aps[o].ip&&(r=r+","+e.aps[o].mac,s=!0);if(s){var c=t.instant("duplicate_ip_tip")+e.aps[l].ip;p.warning(c,"")}}e.apInfo={working:n,lost:i,joining:a},d()}e.InterService=a;var f=a.getProtocol()+"://",g=":"+a.getPort();e.apInfo={working:"0",lost:"0",joining:"0"},e.aps=a.getApListInfo(),m(),e.apsWidth="",d(),e.modal=null,e.openApinfo=function(){var n=o.open({templateUrl:"ap/aplist.html",controller:"APinfoController",size:"lg",backdrop:!0});n.result.then(function(n){u.HttpGetApListInfo(function(){e.aps=a.getApListInfo(),m()})},function(n){u.HttpGetApListInfo(function(){e.aps=a.getApListInfo(),m()})})},e.acceptAp=function(n){var a={mac:n.mac},l=e.aps.length-e.apInfo.joining;16>l?bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:t.instant("joingAp"),callback:function(e){if(e){r.lock();var n="ap_access_group_name",l=[{ip:"PVC",success:"module_operate_failure",msg:""}];i.put("/toauth",null,a,function(e){null!=e&&e.success?(p.info(t.instant("successfullyAp"),""),u.HttpGetApListInfo(null),l[0].success="module_operate_success",l[0].msg="ap_log_success",r.unlock()):(p.info(t.instant("failedAp"),""),l[0].success="module_operate_failure",l[0].msg="ap_log_error_1",r.unlock()),c.setLog(n,l)},function(){p.info(t.instant("failedServer"),""),l[0].success="module_operate_failure",l[0].msg="failedServer",c.setLog(n,l),r.unlock()})}}}):p.warning(t.instant("apgroupFull"),"")},e.ShowLedOperate=function(e){if(e.ledshow=!e.ledshow,e.ledshow){var n=f+e.ip+g+"/ledstatus";i.get(n,null,function(n){if(null!=n&&n.success)switch(n.result){case 0:e.operate={open:!1,off:!0,blink:!1};break;case 1:e.operate={open:!0,off:!1,blink:!1};break;case 2:e.operate={open:!1,off:!1,blink:!0}}},function(){})}},e.LedOperate=function(e,n){var a={type:n},l="";switch(n){case 100:l=t.instant("locateAp");break;case 101:l=t.instant("restoreAp");break;case 102:l=t.instant("onLedAp");break;case 103:l=t.instant("offLedAp")}var s=f+e.ip+g+"/ledControl";bootbox.confirm({buttons:{cancel:{label:t.instant("Cancel")},confirm:{label:t.instant("OK")}},message:l,callback:function(l){if(l){r.lock();var o="set_led_status_log_name",u=[{ip:e.ip,success:"module_operate_failure",msg:""}];i.put(s,null,a,function(a){if(null!=a&&a.success){switch(n){case 100:e.operate={open:!1,off:!1,blink:!0};break;case 101:e.operate={open:!0,off:!1,blink:!1};break;case 102:e.operate={open:!0,off:!1,blink:!1};break;case 103:e.operate={open:!1,off:!0,blink:!1}}u[0].success="module_operate_success",u[0].msg="ap_log_success",r.unlock()}else p.warning(t.instant("setApLedF"),""),u[0].success="module_operate_failure",u[0].msg="ap_log_error_1",r.unlock();c.setLog(o,u)},function(){p.warning(t.instant("failedServer"),""),u[0].success="module_operate_failure",u[0].msg="failedServer",c.setLog(o,u),r.unlock()})}}})},e.$on("to-aplist-child",function(n,t){e.aps=a.getApListInfo(),m()}),e.showApMonitorData=function(n){var a=t.instant("ClusterAP")+n.apname,i=new Array;i.ip=n.ip,i.mac=n.mac,s.changeObser("ap",i,a),e.clientManagement.changeClient("ap",n)}}]).filter("apStatusFilter",[function(){var e=function(e){switch(e){case"1":return"Joining";case"2":return"Initializing";case"3":return"Working";case"4":return"Down"}};return e}]),angular.module("module.ap.apinfo").controller("APinfoController",["$rootScope","$scope","$modalInstance","$translate","authentifiedRequest","InterService","batchSyncConfig","FileUploader","lockScreen","$http","ClusterService","toastr","operationLog","$interval","APService",function(e,n,t,a,i,l,s,r,o,c,u,p,d,m,f){
function g(){n.aplistinfo=l.getApListInfo(),n.aplistdetailinfo.working=l.getCanConfigAps();for(var e=0,t=0,a=0,i=0,s=0;s<n.aplistinfo.length;s++)3==n.aplistinfo[s].role&&1!=n.aplistinfo[s].state?(n.aplistdetailinfo.MEM[t]=n.aplistinfo[s],n.aplistdetailinfo.MEM[t].uploadFaseFlag=100,t++):1==n.aplistinfo[s].role?(n.aplistdetailinfo.PVC[e]=n.aplistinfo[s],n.aplistdetailinfo.PVC[e].uploadFaseFlag=100,n.funDetailInfo(n.aplistinfo[s]),e++):2==n.aplistinfo[s].role&&1!=n.aplistinfo[s].state&&(n.aplistdetailinfo.SVC[a]=n.aplistinfo[s],n.aplistdetailinfo.SVC[a].uploadFaseFlag=100,a++),1==n.aplistinfo[s].state&&(n.aplistdetailinfo.joining[i]=n.aplistinfo[s],i++)}function h(e,t,i){var l="restore_configration_log_name",s=[{ip:e.ip,success:"module_operate_failure",msg:""}];200==i&&1==t.success?(s[0].success="module_operate_success",s[0].msg="ap_log_success",n.uploadflag.mac.toUpperCase()==e.mac.toUpperCase()&&A(),p.info("IP:"+e.ip+"&nbsp;"+a.instant("apRestoreInfo"),"")):(200==i?"100"==t.result?(s[0].success="module_operate_failure",s[0].msg="ap_restore_error_1",p.warning("IP:"+e.ip+"&nbsp;"+a.instant("ap_restore_error_1"),"")):"101"==t.result?(s[0].success="module_operate_failure",s[0].msg="ap_restore_error_2",p.warning("IP:"+e.ip+"&nbsp;"+a.instant("ap_restore_error_2"),"")):"102"==t.result?(s[0].success="module_operate_failure",s[0].msg="ap_restore_error_3",p.warning("IP:"+e.ip+"&nbsp;"+a.instant("ap_restore_error_3"),"")):"103"==t.result?(s[0].success="module_operate_failure",s[0].msg="ap_restore_error_4",p.warning("IP:"+e.ip+"&nbsp;"+a.instant("ap_restore_error_4"),"")):(s[0].success="module_operate_failure",s[0].msg="ap_log_error_1",p.warning("IP:"+e.ip+"&nbsp;"+a.instant("ap_log_error_1"),"")):(s[0].success="module_operate_failure",s[0].msg="failedServer",p.warning("IP:"+e.ip+"&nbsp;"+a.instant("msg_base")+a.instant("failedServer"),"")),n.uploadflag.mac.toUpperCase()==e.mac.toUpperCase()&&o.unlock()),d.setLog(l,s,null)}function _(e){o.lock(42e4);var t=n.aplistdetailinfo.working[n.num].mac.toUpperCase(),a=n.uploadflag.mac.toUpperCase();a==t&&n.uploadflag.connect?(n.uploadflag.num=n.num,n.num=n.num+1,n.num<n.aplistdetailinfo.working.length?(e.url=b+n.aplistdetailinfo.working[n.num].ip+y+"/restorecfg/"+e.file.name,e.upload()):n.restorefile(L.queue[0])):(e.url=b+n.aplistdetailinfo.working[n.num].ip+y+"/restorecfg/"+e.file.name,e.upload())}function C(e,t,i){var l="upgrade_verion_log_name",s=[{ip:e,success:"module_operate_failure",msg:""}];s[0].success=i.flag,s[0].msg=i.msg,i.flag?(n.uploadflag.mac.toUpperCase()==t.toUpperCase()&&(n.uploadflag.byurlflag=!0,A()),p.info("IP:"+e+"&nbsp;"+a.instant(i.msg),"")):p.warning("IP:"+e+"&nbsp;"+a.instant(i.msg),""),d.setLog(l,s,null)}function v(e,t){if(1==e.role)n.aplistdetailinfo.PVC[0].uploadFaseFlag=t;else if(2==e.role){for(var a=0;a<n.aplistdetailinfo.SVC.length;a++)if(e.mac==n.aplistdetailinfo.SVC[a].mac){n.aplistdetailinfo.SVC[a].uploadFaseFlag=t;break}}else if(3==e.role)for(var a=0;a<n.aplistdetailinfo.MEM.length;a++)if(e.mac==n.aplistdetailinfo.MEM[a].mac){n.aplistdetailinfo.MEM[a].uploadFaseFlag=t;break}}function w(e,t,i,l){var s="upgrade_version_http_log_name",r=[{ip:e.ip,success:"module_operate_failure",msg:""}];200==i&&1==t.success?(v(e,102),1==l?n.uploadflag.mac.toUpperCase()==e.mac.toUpperCase()?A():o.unlock():n.uploadflag.mac.toUpperCase()==e.mac.toUpperCase()&&A(),r[0].success="module_operate_success",r[0].msg="ap_log_success",p.info("IP:"+e.ip+"&nbsp;"+a.instant("uploadVersionByUrlS"),"")):(200==i?"100"==t.result?(r[0].success="module_operate_failure",r[0].msg="ap_log_error_3",p.warning("IP:"+e.ip+"&nbsp;"+a.instant("noMemoryOsupgrade"),"")):(r[0].success="module_operate_failure",r[0].msg="ap_log_error_4",p.warning("IP:"+e.ip+"&nbsp;"+a.instant("osupgradeF"),"")):(r[0].success="module_operate_failure",r[0].msg="failedServer",p.warning("IP:"+e.ip+"&nbsp;msg:"+a.instant("failedServer"),"")),1==l?o.unlock():n.uploadflag.mac.toUpperCase()==e.mac.toUpperCase()&&o.unlock(),v(e,101)),d.setLog(s,r,null)}function S(e){o.lock(42e4);var t=n.aplistdetailinfo.working[n.num].mac.toUpperCase(),a=n.uploadflag.mac.toUpperCase();a==t&&n.uploadflag.connect?(n.uploadflag.num=n.num,n.num=n.num+1,n.num<n.aplistdetailinfo.working.length?(e.url=b+n.aplistdetailinfo.working[n.num].ip+y+"/updatefirm/"+e.file.name,e.upload()):n.UpdatetoAll(P.queue[0],2)):(e.url=b+n.aplistdetailinfo.working[n.num].ip+y+"/updatefirm/"+e.file.name,e.upload())}n.skin=l.skin;var b=l.getProtocol()+"://",y=":"+l.getPort();n.aplistinfo={},n.uploadflag={connect:!1,num:0,mac:"",byurlflag:!1},n.select={selectall:!1},n.aplistdetailinfo={PVC:[],SVC:[],MEM:[],working:[],joining:[]},n.flag={isEditApname:!1,isEditip:!1,showdhcp:!0,apinfoshow:!0,upload2one:!0,noeditloc:!0},n.tabflag={detailtab:!0,cfgtab:!1,updatetab:!1,restoretab:!1},n.edit={apNewName:"",mac:"",proto:"",ipaddr:"",netmask:"",gateway:""},n.editloc={aploc:""},n.byurl={url:""},n.currentApInfo={},n.apInfo={},n.InterService=l,n.iSurlorloc="false",n.timer=null,n.roottimer=null,o.lock();var k=function(){null!=n.timer&&m.cancel(n.timer),n.aplistdetailinfo={PVC:[],SVC:[],MEM:[],working:[],joining:[]},f.HttpGetApListInfo(function(){T(),g(),n.clusterInfo=u.getClusterinfoSer(),n.$emit("to-aplist-parent",!0)})},A=function(){n.$emit("modal-to-main","cancelTimer");var e=m(function(){o.lock(6e4),i.get("/checkstate",null,function(e){null!=e&&e.success&&(o.unlock(),window.location.href="login.html")},function(){})},3e4);n.roottimer=e};k();var T=function(){i.get("/getapname",null,function(e){null!=e&&e.success?n.uploadflag.mac=e.result.mac:n.uploadflag.mac=""},function(){n.uploadflag.mac=""})};n.funDetailInfo=function(e){if(n.currentApInfo=e,n.flag.upload2one=!0,n.tabflag={detailtab:!0,cfgtab:!1,updatetab:!1,restoretab:!1},n.flag={isEditApname:!1,isEditip:!1,showdhcp:!0,apinfoshow:!0,upload2one:!0,noeditloc:!0},4==e.state||1==e.state)return n.flag.apinfoshow=!1,void p.warning(a.instant("apinfoShow"));n.apInfo={},n.flag.showdhcp=!0,n.flag.apinfoshow=!0;var t=b+e.ip+y+"/baseinfo";o.lock(),i.get(t,null,function(e){null!=e&&e.success?(n.apInfo=e.result,o.unlock()):(o.unlock(),p.warning(a.instant("getinfoApF")))},function(){o.unlock(),p.warning(a.instant("getinfoApF"))})},n.funcfg=function(e){n.currentApInfo=e,n.flag.upload2one=!0,n.cfgtext={content:""},n.tabflag={detailtab:!1,cfgtab:!0,updatetab:!1,restoretab:!1};var t=b+e.ip+y+"/currentcfg";o.lock(),i.get(t,null,function(e){null!=e&&e.success?(n.cfgtext.content=e.result,o.unlock()):(o.unlock(),p.warning(a.instant("getconfigureApF")))},function(){o.unlock(),p.warning(a.instant("getconfigureApF"))})},n.showRestore=function(){n.flag.upload2one=!0,n.tabflag={detailtab:!1,cfgtab:!1,updatetab:!1,restoretab:!0}},n.funupdate=function(e){n.flag.upload2one=!0,n.currentApInfo=e,n.tabflag={detailtab:!1,cfgtab:!1,updatetab:!0,restoretab:!1}},n.showbashupload=function(){n.flag.upload2one=!1,n.tabflag={detailtab:!1,cfgtab:!1,updatetab:!0,restoretab:!1}},n.reboot=function(e){n.flag.upload2one=!0;var t=b+e.ip+y+"/reboot";bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("rebootAp"),callback:function(l){if(l){var s="reboot_ap_log_name",r=[{ip:e.ip,success:"module_operate_failure",msg:""}];o.lock(6e4),i.put(t,null,null,function(t){null!=t&&t.success?(r[0].success="module_operate_success",r[0].msg="ap_log_success",e.mac.toUpperCase()==n.uploadflag.mac.toUpperCase()?A():o.unlock(),p.warning(a.instant("rebootApS"))):(r[0].success="module_operate_failure",r[0].msg="ap_log_error_1",p.warning(a.instant("rebootApF")),o.unlock()),d.setLog(s,r,null)},function(){r[0].success="module_operate_failure",r[0].msg="failedServer",d.setLog(s,r,null),p.warning(a.instant("failedServer")),o.unlock()})}}})},n.saveOrCancelApName=function(e){if(100==e)n.edit={apNewName:"",mac:"",proto:"",ipaddr:"",netmask:"",gateway:""},n.flag.isEditApname=!n.flag.isEditApname;else if(101==e){var t=b+n.currentApInfo.ip+y+"/chgapname",l={mac:n.currentApInfo.mac,apname:n.edit.apNewName},s="modify_apName_log_name",r=[{ip:n.currentApInfo.ip,success:"module_operate_failure",msg:""}];o.lock(),i.put(t,null,l,function(e){if(null!=e&&e.success){n.apInfo.apName=n.edit.apNewName,n.flag.isEditApname=!n.flag.isEditApname;var t=n.currentApInfo.mac.toUpperCase();if(1==n.currentApInfo.role)n.aplistdetailinfo.PVC[0].apname=n.edit.apNewName;else if(2==n.currentApInfo.role)for(var i=0;i<n.aplistdetailinfo.SVC.length;i++){var l=n.aplistdetailinfo.SVC[i].mac.toUpperCase();if(t==l){n.aplistdetailinfo.SVC[i].apname=n.edit.apNewName;break}}else if(3==n.currentApInfo.role)for(var i=0;i<n.aplistdetailinfo.MEM.length;i++){var l=n.aplistdetailinfo.MEM[i].mac.toUpperCase();if(t==l){n.aplistdetailinfo.MEM[i].apname=n.edit.apNewName;break}}r[0].success="module_operate_success",r[0].msg="ap_log_success",o.unlock()}else o.unlock(),p.warning(a.instant("setNameApF")),r[0].success="module_operate_failure",r[0].msg="ap_log_error_1";d.setLog(s,r,null)},function(){o.unlock(),r[0].success="module_operate_failure",r[0].msg="failedServer",d.setLog(s,r,null),p.warning(a.instant("failedServer"))})}else 102==e&&(n.flag.isEditApname=!n.flag.isEditApname,n.edit.apNewName="")},n.acceptAp=function(){var e={mac:n.currentApInfo.mac},t=n.aplistinfo.length-n.aplistdetailinfo.joining.length;16>t?bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("joingAp"),callback:function(t){if(t){o.lock();var l=b+n.aplistdetailinfo.PVC[0].ip+y+"/toauth",s="ap_access_group_name",r=[{ip:n.currentApInfo.ip,success:"module_operate_failure",msg:""}];i.put(l,null,e,function(e){null!=e&&e.success?(p.info(a.instant("successfullyAp"),""),r[0].success="module_operate_success",r[0].msg="ap_log_success"):(p.warning(a.instant("failedAp"),""),r[0].success="module_operate_failure",r[0].msg="ap_log_error_1"),d.setLog(s,r,null);var t=m(function(){k()},3e3);n.timer=t},function(){r[0].success="module_operate_failure",r[0].msg="failedServer",d.setLog(s,r,null),p.warning(a.instant("failedServer")),o.unlock()})}}}):p.warning(a.instant("apgroupFull"),"")},n.kickOffAp=function(){var e={mac:n.currentApInfo.mac};bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("kickOffAp"),callback:function(t){if(t){o.lock();var l=b+n.aplistdetailinfo.PVC[0].ip+y+"/kickoffap",s="kick_ap_log_name",r=[{ip:n.currentApInfo.ip,success:"module_operate_failure",msg:""}];i.put(l,null,e,function(e){null!=e&&e.success?(p.info(a.instant("kickOffApS"),""),r[0].success="module_operate_success",r[0].msg="ap_log_success"):(r[0].success="module_operate_failure",r[0].msg="ap_log_error_1",p.warning(a.instant("kickOffApF"),"")),d.setLog(s,r,null);var t=m(function(){k()},3e3);n.timer=t},function(){r[0].success="module_operate_failure",r[0].msg="failedServer",d.setLog(s,r,null),p.warning(a.instant("failedServer")),o.unlock()})}}})},n.deleteAp=function(){var e={mac:n.currentApInfo.mac};bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("delAp"),callback:function(t){if(t){o.lock();var l=b+n.aplistdetailinfo.PVC[0].ip+y+"/deleteap",s="delete_ap_log_name",r=[{ip:n.currentApInfo.ip,success:"module_operate_failure",msg:""}];i.put(l,null,e,function(e){null!=e&&e.success?(p.info(a.instant("delApS"),""),r[0].success="module_operate_success",r[0].msg="ap_log_success"):(r[0].success="module_operate_failure",r[0].msg="ap_log_error_1",p.warning(a.instant("delApF"),"")),d.setLog(s,r,null);var t=m(function(){k()},3e3);n.timer=t},function(){r[0].success="module_operate_failure",r[0].msg="failedServer",d.setLog(s,r,null),p.warning(a.instant("failedServer")),o.unlock()})}}})},n.Update2PVC=function(){var e={mac:n.currentApInfo.mac},t=b+n.currentApInfo.ip+y+"/prioritychange";bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("apToPvc"),callback:function(l){if(l){o.lock();var r="update2pvc_log_name",c=[{ip:n.currentApInfo.ip,success:"module_operate_failure",msg:""}],u="update2vc_log_name",m=[{ip:"PVC",success:"module_operate_failure",msg:""}];i.put(t,null,e,function(t){if(null!=t&&t.success){c[0].success="module_operate_success",c[0].msg="ap_log_success";var l=b+n.aplistdetailinfo.PVC[0].ip+y+"/prioritychange";i.put(l,null,e,function(e){if(null!=e&&e.success){p.info(a.instant("changeRoleS"),""),m[0].success="module_operate_success",m[0].msg="ap_log_success";var n="restart_ap_cluster_log_name";s.request("put","/reloadclt",null,null,null,null,n),o.unlock()}else m[0].success="module_operate_failure",m[0].msg="ap_log_error_1",p.warning(a.instant("changeRoleF"),""),o.unlock();d.setLog(u,m,null)},function(){m[0].success="module_operate_failure",m[0].msg="failedServer",d.setLog(u,m,null),p.warning(a.instant("failedServer")),o.unlock()})}else c[0].success="module_operate_failure",c[0].msg="ap_log_error_1",p.warning(a.instant("changeRoleF"),""),o.unlock();d.setLog(r,c,null)},function(){c[0].success="module_operate_failure",c[0].msg="failedServer",d.setLog(r,c,null),p.warning(a.instant("failedServer")),o.unlock()})}}})},n.saveOrCancelApLocation=function(e){if(100==e)n.editloc.aploc="",n.flag.noeditloc=!1;else if(101==e){var t=b+n.currentApInfo.ip+y+"/chgaploc",l={mac:n.currentApInfo.mac,aploc:n.editloc.aploc};o.lock();var s="modify_ap_location_log_name",r=[{ip:n.currentApInfo.ip,success:"module_operate_failure",msg:""}];i.put(t,null,l,function(e){null!=e&&e.success?(n.apInfo.apLoc=n.editloc.aploc,n.flag.noeditloc=!0,r[0].success="module_operate_success",r[0].msg="ap_log_success",o.unlock()):(o.unlock(),r[0].success="module_operate_failure",r[0].msg="ap_log_error_1",p.warning(a.instant("modifyLocationApF"))),d.setLog(s,r,null)},function(){o.unlock(),r[0].success="module_operate_failure",r[0].msg="failedServer",d.setLog(s,r,null),p.warning(a.instant("failedServer"))})}else 102==e&&(n.flag.noeditloc=!0,n.editloc.aploc="")},n.show_ip_edit=function(e){100==e?n.flag.isEditip=!1:101==e&&(n.flag.isEditip=!0)},n.saveDhcpOpration=function(e){if(100==e)n.flag.showdhcp=!1,n.edit={apNewName:"",mac:"",proto:"",ipaddr:"",netmask:"",gateway:""},"STATIC"==n.apInfo.netproto.toUpperCase()?(n.edit.proto="static",n.flag.isEditip=!0):(n.edit.proto="dhcp",n.flag.isEditip=!1);else if(101==e){n.edit.mac=n.currentApInfo.mac;var t=b+n.currentApInfo.ip+y+"/chgnetaddr",l=b+n.currentApInfo.ip+y+"/reload",s=n.edit;o.lock();var r="modify_ap_ip_log_name",c=[{ip:n.currentApInfo.ip,success:"module_operate_failure",msg:""}];i.put(t,null,s,function(e){null!=e&&e.success?(i.get(l,null,function(e){},function(){}),n.flag.showdhcp=!0,o.unlock(),c[0].success="module_operate_success",c[0].msg="ap_log_success",p.info(a.instant("modifyIpApS"),"")):(o.unlock(),p.warning(a.instant("modifyIpApF"),""),c[0].success="module_operate_failure",c[0].msg="ap_log_error_1"),d.setLog(r,c,null)},function(){o.unlock(),c[0].success="module_operate_failure",c[0].msg="failedServer",d.setLog(r,c,null),p.warning(a.instant("failedServer"))})}else 102==e&&(n.flag.showdhcp=!0)},n.clearAllCfg=function(){n.flag.upload2one=!0,bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("clearConfigurationAllAp"),callback:function(e){if(e){var n="clear_configuration_log_name";s.request("put","/clearallcfg",null,null,null,null,n)}}})},n.downloadServerDetailList=function(e){n.flag.upload2one=!0;var t="download_ap_configration_log_name",i=[{ip:"PVC",success:"module_operate_failure",msg:""}];bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("backupConfiguration"),callback:function(e){e&&c({method:"get",url:"/backupcfg",headers:{Authorization:"sessionName "+window.localStorage.sessionId}}).success(function(e,n,l){var s="application/octet-stream",r=!1;l=l();var o=l["content-disposition"],c=new Array;c=o.split("=");var u=c[1],m=l["content-type"]||s;try{var f=new Blob([e],{type:m});if(navigator.msSaveBlob)navigator.msSaveBlob(f,u);else{var g=navigator.webkitSaveBlob||navigator.mozSaveBlob||navigator.saveBlob;if(void 0===g)throw"Not supported";g(f,u),r=!0}}catch(h){console.log(h)}if(!r){var _=window.URL||window.webkitURL||window.mozURL||window.msURL;if(_){var C=document.createElement("a");if("download"in C)try{var f=new Blob([e],{type:m}),v=_.createObjectURL(f);C.setAttribute("href",v),C.setAttribute("download",u);var w=document.createEvent("MouseEvents");w.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),C.dispatchEvent(w),r=!0}catch(h){console.log(h)}if(!r)try{var f=new Blob([e],{type:s}),v=_.createObjectURL(f);window.location=v,r=!0}catch(h){console.log(h)}}}r?(i[0].success="module_operate_success",i[0].msg="ap_log_success"):(i[0].success="module_operate_failure",i[0].msg="ap_log_error_2",p.warning(a.instant("faileddownload"))),d.setLog(t,i,null)}).error(function(e,n){console.log("Request failed with status: "+n),i[0].success="module_operate_failure",i[0].msg="failedServer",d.setLog(t,i,null),p.warning(a.instant("failedServer"))})}})},n.num=0;var L=n.uploader=new r({removeAfterUpload:!1,headers:{Authorization:"sessionName "+window.localStorage.sessionId}});L.onAfterAddingFile=function(e){var t=/^[\w- ()]+\.conf$/,i=t.test(e.file.name.toLowerCase());if(!i)return n.clearItems(),void p.warning(a.instant("fileFormatConf"),"");var l=Math.floor(e.file.size/1024/1024);return l>20?(n.clearItems(),void p.warning(a.instant("file_too_big"),"")):void 0},L.onCompleteItem=function(e,t,a,i){h(n.aplistdetailinfo.working[n.num],t,a),n.num++,n.num<n.aplistdetailinfo.working.length&&n.uploadflag.connect?n.restorefile(L.queue[0]):n.uploadflag.connect?n.restorefile(L.queue[0]):n.num=0},n.restorefile=function(e){n.uploadflag.connect?(n.num<n.aplistdetailinfo.working.length||(n.num=n.uploadflag.num,n.uploadflag.connect=!1),_(e)):bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("restoreConfiguration"),callback:function(t){if(t){if(n.aplistdetailinfo.working.length<1)return void p.warning(a.instant("havingNoApRestore"),"");""==n.uploadflag.mac?(T(),p.warning(a.instant("failedLocateConnAp"))):(n.uploadflag.connect=!0,_(e))}}})},n.clearItems=function(){L.clearQueue()},n.checkAll=function(e){angular.forEach(n.aplistinfo,function(n){3==n.state&&(n.$checked=e)})},n.UpdateByUrl=function(e){var t=n.byurl;100==e?n.aplistdetailinfo.working.length<1?p.warning(a.instant("havingNoApUpgrade"),""):bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("osupgradeVersionAllAp"),callback:function(e){e&&s.putAll("/updatebyurl",t,function(e){for(var t=0;t<e.length;t++){var a=e[t].mac.toUpperCase(),i=!1,l=n.aplistdetailinfo.PVC[0].mac.toUpperCase();if(l==a&&(e[t].flag?(n.aplistdetailinfo.PVC[0].uploadFaseFlag=102,C(n.aplistdetailinfo.PVC[0].ip,n.aplistdetailinfo.PVC[0].mac,e[t])):(n.aplistdetailinfo.PVC[0].uploadFaseFlag=101,C(n.aplistdetailinfo.PVC[0].ip,n.aplistdetailinfo.PVC[0].mac,e[t]),i=!0)),!i)for(var s=0;s<n.aplistdetailinfo.SVC.length;s++){var l=n.aplistdetailinfo.SVC[s].mac.toUpperCase();if(l==a){e[t].flag?(n.aplistdetailinfo.SVC[s].uploadFaseFlag=102,C(n.aplistdetailinfo.SVC[s].ip,n.aplistdetailinfo.SVC[s].mac,e[t])):(n.aplistdetailinfo.SVC[s].uploadFaseFlag=101,C(n.aplistdetailinfo.SVC[s].ip,n.aplistdetailinfo.SVC[s].mac,e[t]),i=!0);break}}if(!i)for(var s=0;s<n.aplistdetailinfo.MEM.length;s++){var l=n.aplistdetailinfo.MEM[s].mac.toUpperCase();if(l==a){e[t].flag?(n.aplistdetailinfo.MEM[s].uploadFaseFlag=102,C(n.aplistdetailinfo.MEM[s].ip,n.aplistdetailinfo.MEM[s].mac,e[t])):(n.aplistdetailinfo.MEM[s].uploadFaseFlag=101,C(n.aplistdetailinfo.MEM[s].ip,n.aplistdetailinfo.MEM[s].mac,e[t]),i=!0);break}}}n.uploadflag.byurlflag||o.unlock(),n.uploadflag.byurlflag=!1},84e4)}}):200==e&&bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("osupgradeVersionAp"),callback:function(e){if(e){var l=b+n.currentApInfo.ip+y+"/updatebyurl",s="upgrade_verion_log_name",r=[{ip:n.currentApInfo.ip,success:"module_operate_failure",msg:""}];if(o.lock(18e4),1==n.currentApInfo.state){var u={};u.username=window.localStorage.username,u.sessionId=window.localStorage.sessionId,u.flag=1,c({method:"post",url:b+n.currentApInfo.ip+y+"/authentication/syncSessionId",data:u,timeout:15e3,headers:{"Content-Type":"application/json"}}).success(function(e){i.request("put",l,null,t,18e4,function(e){null!=e&&e.success?(r[0].success=e.result.flag,r[0].msg=e.result.msg,n.currentApInfo.mac.toUpperCase()==n.uploadflag.mac.toUpperCase()?A():o.unlock(),p.info("IP:"+n.currentApInfo.ip+"&nbsp;"+a.instant(e.result.msg),"")):(r[0].success="module_operate_failure",r[0].msg="ap_log_error_1",o.unlock(),p.warning("IP:"+n.currentApInfo.ip+"&nbsp;"+a.instant("uploadVersionByUrlF"),"")),d.setLog(s,r,null)},function(){o.unlock(),p.warning("IP:"+n.currentApInfo.ip+"&nbsp;msg:"+a.instant("failedServer"),""),r[0].success="module_operate_failure",r[0].msg="failedServer",d.setLog(s,r,null)})})}else i.request("put",l,null,t,18e4,function(e){null!=e&&e.success?(r[0].success=e.result.flag,r[0].msg=e.result.msg,n.currentApInfo.mac.toUpperCase()==n.uploadflag.mac.toUpperCase()?A():o.unlock(),p.info("IP:"+n.currentApInfo.ip+"&nbsp;"+a.instant(e.result.msg),"")):(r[0].success="module_operate_failure",r[0].msg="ap_log_error_1",o.unlock(),p.warning("IP:"+n.currentApInfo.ip+"&nbsp;"+a.instant("uploadVersionByUrlF"),"")),d.setLog(s,r,null)},function(){o.unlock(),p.warning("IP:"+n.currentApInfo.ip+"&nbsp;msg:"+a.instant("failedServer"),""),r[0].success="module_operate_failure",r[0].msg="failedServer",d.setLog(s,r,null)})}}})};var P=n.uploaderfirm=new r({removeAfterUpload:!1,headers:{Authorization:"sessionName "+window.localStorage.sessionId}});n.updatetype=0,n.clearItemsfirm=function(){P.clearQueue()},P.onAfterAddingFile=function(e){var t=/^[\w-\.]+\.bin$/,i=t.test(e.file.name.toLowerCase());if(!i)return n.clearItemsfirm(),void p.warning(a.instant("fileFormatbin"),"");var l=Math.floor(e.file.size/1024/1024);return l>20?(n.clearItemsfirm(),void p.warning(a.instant("file_too_big"),"")):void 0},P.onCompleteItem=function(e,t,a,i){1==n.updatetype?(n.num=0,w(n.currentApInfo,t,a,1)):2==n.updatetype&&(w(n.aplistdetailinfo.working[n.num],t,a,2),n.num++,n.num<n.aplistdetailinfo.working.length&&n.uploadflag.connect?n.UpdatetoAll(P.queue[0],2):n.uploadflag.connect?n.UpdatetoAll(P.queue[0],2):n.num=0)},n.UpdatetoAll=function(e,t){n.updatetype=t,1==t?bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("osupgradeVersionAp"),callback:function(t){if(t)if(""==n.uploadflag.mac)T(),p.warning(a.instant("getinfoApF"));else if(o.lock(42e4),1==n.currentApInfo.state){var i={};i.username=window.localStorage.username,i.sessionId=window.localStorage.sessionId,i.flag=1,c({method:"post",url:b+n.currentApInfo.ip+y+"/authentication/syncSessionId",data:i,timeout:15e3,headers:{"Content-Type":"application/json"}}).success(function(t){e.url=b+n.currentApInfo.ip+y+"/updatefirm/"+e.file.name,e.upload()})}else e.url=b+n.currentApInfo.ip+y+"/updatefirm/"+e.file.name,e.upload()}}):2==t&&(n.uploadflag.connect?(n.num<n.aplistdetailinfo.working.length||(n.num=n.uploadflag.num,n.uploadflag.connect=!1),S(e)):bootbox.confirm({buttons:{cancel:{label:a.instant("Cancel")},confirm:{label:a.instant("OK")}},message:a.instant("osupgradeVersionAllAp"),callback:function(t){if(t){if(n.aplistdetailinfo.working.length<1)return void p.warning(a.instant("havingNoApUpload"),"");""==n.uploadflag.mac?(T(),p.warning(a.instant("getinfoApF"))):(n.uploadflag.connect=!0,S(e))}}}))},n.cancel=function(){t.close("test")}}]).filter("rolechange",[function(){var e=function(e){switch(e){case"3":return"Member";case"1":return"PVC";case"2":return"SVC"}};return e}]).filter("apStatusFilter",[function(){var e=function(e){switch(e){case"1":return"Joining";case"2":return"Initializing";case"3":return"Working";case"4":return"Down"}};return e}]),angular.module("main").filter("switchFilter",["$translate",function(e){var n=function(n){switch(n){case!0:return e.instant("Open");case!1:return e.instant("Close")}};return n}]),angular.module("main").run(["$rootScope","$interval","toastr","InterService","authentifiedRequest","permissions","clientService","$location",function(e,n,t,a,i,l,s,r){$.ajax({async:!1,type:"get",url:"/haps",timeout:15e3,dataType:"json",headers:{Authorization:"sessionName "+window.localStorage.sessionId},error:function(){console.error("inithaps fail")},success:function(e){if(null!=e&&null!=e.result&&e.success){for(var n=!1,t=e.result.length;t>0;t--){e.result[t-1].hasOwnProperty("name")&&""!=e.result[t-1].name&&null!=e.result[t-1].name?e.result[t-1].apname=e.result[t-1].name:e.result[t-1].apname=e.result[t-1].mac,e.result[t-1].hasOwnProperty("version")||(e.result[t-1].version=" "),0==e.result[t-1].state&&(e.result[t-1].state="1");var i=s.getApClient(e.result[t-1].mac);null!=i?e.result[t-1].clients=i.length:e.result[t-1].clients=0,n||1==e.result[t-1].role&&(a.setPVCinfo(e.result[t-1].ip),n=!0)}a.setApListInfo(e.result)}else console.error("inithaps fail")}}),e.loading=!1,l.setPermissions(window.localStorage.username),i.get("/other/countryCode",null,function(e){null!=e&&e.success&&a.setCountryCode(e.countryFlag)}),i.get("/other/systemInfo",null,function(e){if(e.success){var n=e.result;a.setCountryCodeInfo(n.countryCode)}},function(){}),a.setPort(r.port()),a.setProtocol(r.protocol())}]).controller("mainController",["$rootScope","$scope","$translate","singleModal","InterService","$interval","$translate","ClusterService","monitorService","$cookieStore","operationLog","APService","authentifiedRequest","$modal",function(e,n,t,a,i,l,t,s,r,o,c,u,p,d){function m(){null==o.get("lang")||"en"==o.get("lang")?(n.isEnglish=!0,n.isChiness=!1,n.isBoth=!1,n.isDeutsch=!1):"zh"==o.get("lang")?(n.isEnglish=!1,n.isChiness=!0,n.isBoth=!1,n.isDeutsch=!1):"de"==o.get("lang")&&(n.isEnglish=!1,n.isChiness=!1,n.isBoth=!1,n.isDeutsch=!0),null==o.get("cycleName")||"30s"==o.get("cycleName")?(o.put("cycleName","30s"),n.pollingCycleSelected=n.pollingCycles[0]):"60s"==o.get("cycleName")?n.pollingCycleSelected=n.pollingCycles[1]:"120s"==o.get("cycleName")&&(n.pollingCycleSelected=n.pollingCycles[2]),i.getSkin()}function f(){var e=l(function(){$(".pos-rts").hide(1e3),l.cancel(n.logTime)},3e3);n.logTime=e}function g(e){var t=l(function(){n.clientManagement.query(n.clientCallback),u.HttpGetPvcInfo()},1e3*e);C=t,n.prompt=null;var a=l(function(){p.post("/authentication/sessionStatus",null,null,function(e){if(null!=e&&e.success){if(0==e.flag)return;if(null!=n.prompt)return;n.prompt=d.open({templateUrl:"logout-prompt.html",controller:"logoutPromptCtrl",size:"md",backdrop:"static",keyboard:!1,resolve:{flag:function(){return e.flag}}}),n.prompt.result.then(function(e){n.prompt=null},function(e){n.prompt=null})}},function(){})},3e4);v=a}function h(e){var n=e||window.event,t=n.target||n.srcElement,a=t.type||t.getAttribute("type"),i=t.getAttribute("readonly"),l=t.getAttribute("enabled");i=null==i?!1:i,l=null==l?!0:l;var s=!(8!=n.keyCode||"password"!=a&&"text"!=a&&"textarea"!=a&&"number"!=a||1!=i&&1==l),r=8==n.keyCode&&"password"!=a&&"text"!=a&&"textarea"!=a&&"number"!=a;return r?!1:s?!1:void 0}n.isEnglish=!0,n.isChiness=!1,n.isDeutsch=!1,n.isBoth=!1,n.pollingCycleSelected={},n.pollingCycles=[{name:"30s"},{name:"60s"},{name:"120s"}],m(),n.langInterval={},n.setLang=function(e){var a="en_US";switch(e){case 0:a="en_US",o.put("lang","en"),n.isEnglish=!1,n.isChiness=!1,n.isBoth=!0,n.isDeutsch=!1,n.langInterval=l(function(){n.isBoth=!1,n.isEnglish=!0,n.isChiness=!1,n.isDeutsch=!1},3e3,1);break;case 1:a="zh_CH",o.put("lang","zh"),n.isEnglish=!1,n.isChiness=!1,n.isBoth=!0,n.langInterval=l(function(){n.isBoth=!1,n.isEnglish=!1,n.isChiness=!0,n.isDeutsch=!1},3e3,1);break;case 2:a="de_DE",o.put("lang","de"),n.isEnglish=!1,n.isChiness=!1,n.isBoth=!0,n.isDeutsch=!1,n.langInterval=l(function(){n.isBoth=!1,n.isEnglish=!1,n.isChiness=!1,n.isDeutsch=!0},3e3,1);break;case 3:l.cancel(n.langInterval),a="en_US",o.put("lang","en"),n.isEnglish=!0,n.isChiness=!1,n.isBoth=!1,n.isDeutsch=!1;break;case 4:l.cancel(n.langInterval),a="zh_CH",o.put("lang","zh"),n.isEnglish=!1,n.isChiness=!0,n.isBoth=!1,n.isDeutsch=!1;break;case 5:l.cancel(n.langInterval),a="de_DE",o.put("lang","de"),n.isEnglish=!1,n.isChiness=!1,n.isBoth=!1,n.isDeutsch=!0}t.use(a)},n.logs=[],n.logs_temp=[],n.logTime={},n.logClick=function(e){n.logs_temp=angular.copy(c.getLogs()),n.logs=n.logs_temp.reverse(),$(".pos-rts").show(1e3),f()},n.logLeave=function(){l.cancel(n.logTime),$(".pos-rts").hide(1e3)},n.cancelInterval=function(){l.cancel(n.logTime)},n.userName=window.localStorage.username,n.InterService=i,n.ClusterService=s,n.skin=i.skin,n.setSkin=i.setSkin,n.clusterInfo={},n.wlanManagement={},n.clientManagement={},n.skinInterval={},n.showSkinOption=function(){n.skin.isSelectSkin=!0,n.skinInterval=l(function(){n.skin.isSelectSkin=!1},3e3,1)},n.helpTip={isEabled:!1},n.helpButtonTip={title:t.instant("mouseMovedHelpViewInfo")},n.$watch("ClusterService.ClusterinfoSer",function(e,t){e!==t&&(n.clusterInfo=s.getClusterinfoSer(),n.showMonitorData(n.clusterInfo.cluster_name))},!0),n.clientCallback=function(){n.wlanManagement.query(),u.HttpGetApListInfo(function(){n.$broadcast("to-aplist-child",!0)}),r.updateChartview()};var _=parseInt(o.get("cycleName").trim()),C=null,v=null;e.$on("modal-to-main",function(e,n){null!=C&&l.cancel(C),null!=v&&l.cancel(v)}),u.HttpGetApListInfo(function(){n.$broadcast("to-aplist-child",!0)}),g(_),n.pollingChange=function(){l.cancel(C);var e=this.pollingCycleSelected.name;o.put("cycleName",e),_=parseInt(e.replace("s","").trim()),g(_)},n.showMonitorData=function(e){var a=t.instant("ClusterGroup")+e;r.changeObser("cluster",null,a),n.clientManagement.changeClient("cluster",e)},n.showAbout=function(){a.open({templateUrl:"common/about/about.html",controller:"aboutContronller",size:"md",backdrop:!0})},n.showTools=function(){a.open({templateUrl:"common/tools/tools.html",controller:"toolsContronller",size:"lg",backdrop:!0})},n.showPMD=function(){a.open({templateUrl:"common/pmd/pmd.html",controller:"pmdContronller",size:"md",backdrop:!0})},n.showHelp=function(){n.helpTip.isEabled=!n.helpTip.isEabled,1==n.helpTip.isEabled?n.helpButtonTip.title=t.instant("clickDisabledHelp"):n.helpButtonTip.title=t.instant("mouseMoveHelpCheckHelp")},n.getColorClass=function(){1==n.skin.isPurple?(n.menu_class="unfoldedlv1menupurple",n.icon_bg="selected_icon_purple"):(n.menu_class="unfoldedlv1menublue",n.icon_bg="selected_icon_blue")},$("#system_menu").click(function(){n.getColorClass();var e=$("#collapsesystem").hasClass("blackmenu");1==e?($("#collapsesystem").toggleClass("blackmenu",!1),$("#system_icon").attr("src","assets/images/up.png"),$("#collapsewireless").toggleClass("blackmenu",!0),$("#wireless_icon").attr("src","assets/images/down.png"),$("#collapseaccess").toggleClass("blackmenu",!0),$("#access_icon").attr("src","assets/images/down.png"),$("#system_title_bg").addClass(n.menu_class),$("#sys_left_iconbg").addClass(n.icon_bg),$("#sys_right_iconbg").addClass(n.icon_bg),$("#wireless_title_bg").removeClass(n.menu_class),$("#wire_left_iconbg").removeClass(n.icon_bg),$("#wire_right_iconbg").removeClass(n.icon_bg),$("#access_title_bg").removeClass(n.menu_class),$("#acc_left_iconbg").removeClass(n.icon_bg),$("#acc_right_iconbg").removeClass(n.icon_bg)):($("#system_icon").attr("src","assets/images/down.png"),$("#collapsesystem").toggleClass("blackmenu",!0),$("#system_title_bg").removeClass(n.menu_class),$("#sys_left_iconbg").removeClass(n.icon_bg),$("#sys_right_iconbg").removeClass(n.icon_bg))}),$("#wireless_menu").click(function(){n.getColorClass();var e=$("#collapsewireless").hasClass("blackmenu");1==e?($("#collapsewireless").toggleClass("blackmenu",!1),$("#wireless_icon").attr("src","assets/images/up.png"),$("#collapsesystem").toggleClass("blackmenu",!0),
$("#system_icon").attr("src","assets/images/down.png"),$("#collapseaccess").toggleClass("blackmenu",!0),$("#access_icon").attr("src","assets/images/down.png"),$("#system_title_bg").removeClass(n.menu_class),$("#sys_left_iconbg").removeClass(n.icon_bg),$("#sys_right_iconbg").removeClass(n.icon_bg),$("#wireless_title_bg").addClass(n.menu_class),$("#wire_left_iconbg").addClass(n.icon_bg),$("#wire_right_iconbg").addClass(n.icon_bg),$("#access_title_bg").removeClass(n.menu_class),$("#acc_left_iconbg").removeClass(n.icon_bg),$("#acc_right_iconbg").removeClass(n.icon_bg)):($("#wireless_icon").attr("src","assets/images/down.png"),$("#collapsewireless").toggleClass("blackmenu",!0),$("#wireless_title_bg").removeClass(n.menu_class),$("#wire_left_iconbg").removeClass(n.icon_bg),$("#wire_right_iconbg").removeClass(n.icon_bg))}),$("#access_menu").click(function(){n.getColorClass();var e=$("#collapseaccess").hasClass("blackmenu");1==e?($("#collapseaccess").toggleClass("blackmenu",!1),$("#access_icon").attr("src","assets/images/up.png"),$("#collapsesystem").toggleClass("blackmenu",!0),$("#system_icon").attr("src","assets/images/down.png"),$("#collapsewireless").toggleClass("blackmenu",!0),$("#wireless_icon").attr("src","assets/images/down.png"),$("#system_title_bg").removeClass(n.menu_class),$("#sys_left_iconbg").removeClass(n.icon_bg),$("#sys_right_iconbg").removeClass(n.icon_bg),$("#wireless_title_bg").removeClass(n.menu_class),$("#wire_left_iconbg").removeClass(n.icon_bg),$("#wire_right_iconbg").removeClass(n.icon_bg),$("#access_title_bg").addClass(n.menu_class),$("#acc_left_iconbg").addClass(n.icon_bg),$("#acc_right_iconbg").addClass(n.icon_bg)):($("#access_icon").attr("src","assets/images/down.png"),$("#collapseaccess").toggleClass("blackmenu",!0),$("#access_title_bg").removeClass(n.menu_class),$("#acc_left_iconbg").removeClass(n.icon_bg),$("#acc_right_iconbg").removeClass(n.icon_bg))}),n.toggleManager={},$("#collapseOne").on("show.bs.collapse",function(e){"collapseOne"==e.target.id&&(n.toggleManager.ntpInit(),n.toggleManager.syslogInit(),n.toggleManager.clusterInit())}),$("#collapseOne").on("hidden.bs.collapse",function(e){"collapseOne"==e.target.id&&n.toggleManager.ntpDestory()}),$("#collapseTwo").on("show.bs.collapse",function(){n.toggleManager.rfInit(),n.toggleManager.rogueApInit(),n.toggleManager.otherInit()}),$("#collapseFour").on("show.bs.collapse",function(){n.toggleManager.getauthinfo(),n.toggleManager.aclGetRule(),n.toggleManager.getBlackList(),n.toggleManager.getWhiteList(),n.toggleManager.getWallList()}),n.f_logout=function(){p.post("/authentication/logout",null,null,function(e){window.location.href="/static/login.html"})},document.onkeypress=h,document.onkeydown=h}]),$(document).ready(function(){$("#loading").hide(),$("#loaded").show()});